<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="430px" preserveAspectRatio="none" style="width:1520px;height:430px;background:#FFFFFF;" version="1.1" viewBox="0 0 1520 430" width="1520px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="60.6211" style="stroke:#000000;stroke-width:1.5;" width="651.5" x="863" y="317.2832"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="53" x2="53" y1="36.4883" y2="394.9043"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="176" x2="176" y1="36.4883" y2="394.9043"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="368.5" x2="368.5" y1="36.4883" y2="394.9043"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="632" x2="632" y1="36.4883" y2="394.9043"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="800" x2="800" y1="36.4883" y2="394.9043"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="965" x2="965" y1="36.4883" y2="394.9043"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1228.5" x2="1228.5" y1="36.4883" y2="394.9043"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1430.5" x2="1430.5" y1="36.4883" y2="394.9043"/><path d="M10,10 L97,10 C102,10 102,23.2441 102,23.2441 C102,23.2441 102,36.4883 97,36.4883 L10,36.4883 C5,36.4883 5,23.2441 5,23.2441 C5,23.2441 5,10 10,10 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M97,10 C92,10 92,23.2441 92,23.2441 C92,36.4883 97,36.4883 97,36.4883 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="10" y="28.5352">TaskQueue</text><path d="M10,393.9043 L97,393.9043 C102,393.9043 102,407.1484 102,407.1484 C102,407.1484 102,420.3926 97,420.3926 L10,420.3926 C5,420.3926 5,407.1484 5,407.1484 C5,407.1484 5,393.9043 10,393.9043 " fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M97,393.9043 C92,393.9043 92,407.1484 92,407.1484 C92,420.3926 97,420.3926 97,420.3926 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="10" y="412.4395">TaskQueue</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="129" x="112" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="119" y="25.5352">queue_jobs Task</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="129" x="112" y="393.9043"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="115" x="119" y="414.4395">queue_jobs Task</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="186" x="275.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="282.5" y="25.5352">JobSubmitter.queue_jobs</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="186" x="275.5" y="393.9043"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="172" x="282.5" y="414.4395">JobSubmitter.queue_jobs</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="189" x="538" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175" x="545" y="25.5352">JobSubmitter.dereference</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="189" x="538" y="393.9043"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175" x="545" y="414.4395">JobSubmitter.dereference</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="737" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="744" y="25.5352">materialize Task</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="126" x="737" y="393.9043"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="744" y="414.4395">materialize Task</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="184" x="873" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170" x="880" y="25.5352">Tool.handle_input_async</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="184" x="873" y="393.9043"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="170" x="880" y="414.4395">Tool.handle_input_async</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="237" x="1110.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="223" x="1117.5" y="25.5352">expand_meta_parameters_async</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="237" x="1110.5" y="393.9043"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="223" x="1117.5" y="414.4395">expand_meta_parameters_async</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="147" x="1357.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133" x="1364.5" y="25.5352">ToolAction.execute</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="147" x="1357.5" y="393.9043"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133" x="1364.5" y="414.4395">ToolAction.execute</text><polygon fill="#181818" points="164.5,63.7988,174.5,67.7988,164.5,71.7988,168.5,67.7988" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="53.5" x2="170.5" y1="67.7988" y2="67.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="60.5" y="63.0566">&lt;Launch Task&gt;</text><polygon fill="#181818" points="356.5,93.1094,366.5,97.1094,356.5,101.1094,360.5,97.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="176.5" x2="362.5" y1="97.1094" y2="97.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="183.5" y="92.3672">QueueJobs pydantic model</text><polygon fill="#181818" points="620.5,122.4199,630.5,126.4199,620.5,130.4199,624.5,126.4199" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="368.5" x2="626.5" y1="126.4199" y2="126.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="375.5" y="121.6777">RequestInternalToolState</text><polygon fill="#181818" points="379.5,151.7305,369.5,155.7305,379.5,159.7305,375.5,155.7305" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="373.5" x2="631.5" y1="155.7305" y2="155.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="240" x="385.5" y="150.9883">RequestInternalDereferencedToolState</text><polygon fill="#181818" points="788,181.041,798,185.041,788,189.041,792,185.041" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="368.5" x2="794" y1="185.041" y2="185.041"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="375.5" y="180.2988">HDA (with state deferred)</text><polygon fill="#181818" points="379.5,210.3516,369.5,214.3516,379.5,218.3516,375.5,214.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="373.5" x2="799" y1="214.3516" y2="214.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="385.5" y="209.6094">return when state is okay</text><polygon fill="#181818" points="953,239.6621,963,243.6621,953,247.6621,957,243.6621" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="368.5" x2="959" y1="243.6621" y2="243.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="240" x="375.5" y="238.9199">RequestInternalDereferencedToolState</text><polygon fill="#181818" points="1217,268.9727,1227,272.9727,1217,276.9727,1221,272.9727" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="965" x2="1223" y1="272.9727" y2="272.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="240" x="972" y="268.2305">RequestInternalDereferencedToolState</text><polygon fill="#181818" points="976,298.2832,966,302.2832,976,306.2832,972,302.2832" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="970" x2="1228" y1="302.2832" y2="302.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="982" y="297.541">JobInternalToolState[]</text><path d="M863,317.2832 L937,317.2832 L937,324.5938 L927,334.5938 L863,334.5938 L863,317.2832 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="60.6211" style="stroke:#000000;stroke-width:1.5;" width="651.5" x="863" y="317.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="878" y="330.8516">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="173" x="952" y="329.918">[over expanded job tool states]</text><polygon fill="#181818" points="1419,336.5938,1429,340.5938,1419,344.5938,1423,340.5938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="965" x2="1425" y1="340.5938" y2="340.5938"/><polygon fill="#181818" points="976,365.9043,966,369.9043,976,373.9043,972,369.9043" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="970" x2="1430" y1="369.9043" y2="369.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="982" y="365.1621">A Galaxy Job</text><!--MD5=[63fdddff037208bb1e78aa28f3606777]
@startuml

'!include plantuml_options.txt
queue       TaskQueue   as queue
participant     "queue_jobs Task" as task
participant     "JobSubmitter.queue_jobs" as queue_jobs
participant     "JobSubmitter.dereference" as dereference
participant     "materialize Task" as materialize_task
participant     "Tool.handle_input_async" as handle_input
participant     "expand_meta_parameters_async" as expand
participant     "ToolAction.execute" as tool_action

queue -> task : <Launch Task>
task -> queue_jobs : QueueJobs pydantic model
queue_jobs -> dereference : RequestInternalToolState
dereference -> queue_jobs : RequestInternalDereferencedToolState
queue_jobs -> materialize_task : HDA (with state deferred)
materialize_task -> queue_jobs : return when state is okay
queue_jobs -> handle_input : RequestInternalDereferencedToolState
handle_input -> expand : RequestInternalDereferencedToolState
expand -> handle_input : JobInternalToolState[]
loop over expanded job tool states
    handle_input -> tool_action :
    tool_action -> handle_input : A Galaxy Job
end
@enduml

@startuml

queue       TaskQueue   as queue
participant     "queue_jobs Task" as task
participant     "JobSubmitter.queue_jobs" as queue_jobs
participant     "JobSubmitter.dereference" as dereference
participant     "materialize Task" as materialize_task
participant     "Tool.handle_input_async" as handle_input
participant     "expand_meta_parameters_async" as expand
participant     "ToolAction.execute" as tool_action

queue -> task : <Launch Task>
task -> queue_jobs : QueueJobs pydantic model
queue_jobs -> dereference : RequestInternalToolState
dereference -> queue_jobs : RequestInternalDereferencedToolState
queue_jobs -> materialize_task : HDA (with state deferred)
materialize_task -> queue_jobs : return when state is okay
queue_jobs -> handle_input : RequestInternalDereferencedToolState
handle_input -> expand : RequestInternalDereferencedToolState
expand -> handle_input : JobInternalToolState[]
loop over expanded job tool states
    handle_input -> tool_action :
    tool_action -> handle_input : A Galaxy Job
end
@enduml

PlantUML version 1.2022.8(Sun Sep 25 05:00:33 EDT 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>