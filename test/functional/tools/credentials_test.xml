<tool id="credentials_test" name="Credentials Test Tool" version="1.0.0">
    <description>Test tool for validating credential injection</description>
    <requirements>
        <credentials name="test_service" version="1.0">
            <variable name="TEST_USERNAME" inject_as_env="TEST_USERNAME"/>
            <secret name="TEST_PASSWORD" inject_as_env="TEST_PASSWORD"/>
        </credentials>
    </requirements>
    <command><![CDATA[
        echo "Username: \$TEST_USERNAME" > '$output' &&
        echo "Password length: \${#TEST_PASSWORD}" >> '$output'
    ]]></command>
    <inputs>
        <param name="input_text" type="text" value="default" label="Input text"/>
    </inputs>
    <outputs>
        <data name="output" format="txt"/>
    </outputs>
    <tests>
        <test>
            <credentials name="test_service">
                <variable name="TEST_USERNAME" value="test_user"/>
                <secret name="TEST_PASSWORD" value="test_password_123"/>
            </credentials>
            <param name="input_text" value="test_value"/>
            <output name="output">
                <assert_contents>
                    <has_text text="Username: test_user"/>
                    <has_text text="Password length: 17"/>
                </assert_contents>
            </output>
        </test>
        <test>
            <credentials name="test_service">
                <variable name="TEST_USERNAME" value="another_user"/>
                <secret name="TEST_PASSWORD" value="secret"/>
            </credentials>
            <param name="input_text" value="another_test"/>
            <output name="output">
                <assert_contents>
                    <has_text text="Username: another_user"/>
                    <has_text text="Password length: 6"/>
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[
This is a test tool to validate that credentials are properly injected as environment variables during tool execution.

The tool echoes the TEST_USERNAME environment variable and the length of the TEST_PASSWORD to verify they were set.
    ]]></help>
</tool>
