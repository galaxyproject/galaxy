define(["layout/masthead","utils/utils","libs/toastr","mvc/base-mvc","mvc/library/library-model","mvc/library/library-folderlist-view","mvc/library/library-librarylist-view","mvc/library/library-librarytoolbar-view","mvc/library/library-foldertoolbar-view","mvc/library/library-dataset-view","mvc/library/library-library-view","mvc/library/library-folder-view"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=Backbone.Router.extend({initialize:function(){this.routesHit=0,Backbone.history.on("route",function(){this.routesHit++},this),this.bind("route",this.trackPageview)},routes:{"":"libraries","page/:show_page":"libraries_page","library/:library_id/permissions":"library_permissions","folders/:folder_id/permissions":"folder_permissions","folders/:id":"folder_content","folders/:id/page/:show_page":"folder_page","folders/:folder_id/datasets/:dataset_id":"dataset_detail","folders/:folder_id/datasets/:dataset_id/permissions":"dataset_permissions","folders/:folder_id/datasets/:dataset_id/versions/:ldda_id":"dataset_version","folders/:folder_id/download/:format":"download","folders/:folder_id/import/:source":"import_datasets"},back:function(){this.routesHit>1?window.history.back():this.navigate("#",{trigger:!0,replace:!0})},trackPageview:function(){var a=Backbone.history.getFragment();/^\//.test(a)||""==a||(a="/"+a),"undefined"!=typeof ga&&ga("send","pageview",Galaxy.root+"library/list"+a)}}),n=d.SessionStorageModel.extend({defaults:{with_deleted:!1,sort_order:"asc",sort_by:"name",library_page_size:20,folder_page_size:15}}),o=Backbone.View.extend({libraryToolbarView:null,libraryListView:null,library_router:null,libraryView:null,folderToolbarView:null,folderListView:null,datasetView:null,initialize:function(){window.Galaxy.config.ga_code&&(!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create",window.Galaxy.config.ga_code,"auto"),ga("send","pageview")),Galaxy.libraries=this,this.preferences=new n({id:"global-lib-prefs"}),this.library_router=new m,this.library_router.on("route:libraries",function(){Galaxy.libraries.libraryToolbarView&&Galaxy.libraries.libraryToolbarView.$el.unbind("click"),Galaxy.libraries.libraryToolbarView=new h.LibraryToolbarView,Galaxy.libraries.libraryListView=new g.LibraryListView}),this.library_router.on("route:libraries_page",function(a){null===Galaxy.libraries.libraryToolbarView?(Galaxy.libraries.libraryToolbarView=new h.LibraryToolbarView,Galaxy.libraries.libraryListView=new g.LibraryListView({show_page:a})):Galaxy.libraries.libraryListView.render({show_page:a})}),this.library_router.on("route:folder_content",function(a){Galaxy.libraries.folderToolbarView&&Galaxy.libraries.folderToolbarView.$el.unbind("click"),Galaxy.libraries.folderToolbarView=new i.FolderToolbarView({id:a}),Galaxy.libraries.folderListView=new f.FolderListView({id:a})}),this.library_router.on("route:folder_page",function(a,b){null===Galaxy.libraries.folderToolbarView?(Galaxy.libraries.folderToolbarView=new i.FolderToolbarView({id:a}),Galaxy.libraries.folderListView=new f.FolderListView({id:a,show_page:b})):Galaxy.libraries.folderListView.render({id:a,show_page:parseInt(b)})}),this.library_router.on("route:download",function(a,b){0===$("#folder_list_body").find(":checked").length?(c.info("You must select at least one dataset to download"),Galaxy.libraries.library_router.navigate("folders/"+a,{trigger:!0,replace:!0})):(Galaxy.libraries.folderToolbarView.download(a,b),Galaxy.libraries.library_router.navigate("folders/"+a,{trigger:!1,replace:!0}))}),this.library_router.on("route:dataset_detail",function(a,b){Galaxy.libraries.datasetView&&Galaxy.libraries.datasetView.$el.unbind("click"),Galaxy.libraries.datasetView=new j.LibraryDatasetView({id:b,show_version:!1,show_permissions:!1})}),this.library_router.on("route:dataset_version",function(a,b,c){Galaxy.libraries.datasetView&&Galaxy.libraries.datasetView.$el.unbind("click"),Galaxy.libraries.datasetView=new j.LibraryDatasetView({id:b,ldda_id:c,show_version:!0})}),this.library_router.on("route:dataset_permissions",function(a,b){Galaxy.libraries.datasetView&&Galaxy.libraries.datasetView.$el.unbind("click"),Galaxy.libraries.datasetView=new j.LibraryDatasetView({id:b,show_permissions:!0})}),this.library_router.on("route:library_permissions",function(a){Galaxy.libraries.libraryView&&Galaxy.libraries.libraryView.$el.unbind("click"),Galaxy.libraries.libraryView=new k.LibraryView({id:a,show_permissions:!0})}),this.library_router.on("route:folder_permissions",function(a){Galaxy.libraries.folderView&&Galaxy.libraries.folderView.$el.unbind("click"),Galaxy.libraries.folderView=new l.FolderView({id:a,show_permissions:!0})}),this.library_router.on("route:import_datasets",function(a,b){Galaxy.libraries.folderToolbarView&&Galaxy.libraries.folderListView?Galaxy.libraries.folderToolbarView.showImportModal({source:b}):(Galaxy.libraries.folderToolbarView=new i.FolderToolbarView({id:a}),Galaxy.libraries.folderListView=new f.FolderListView({id:a}),Galaxy.libraries.folderToolbarView.showImportModal({source:b}))}),Backbone.history.start({pushState:!1})}});return{GalaxyApp:o}});
//# sourceMappingURL=../maps/galaxy.library.js.map