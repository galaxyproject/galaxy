define("mvc/history/options-menu",["exports","mvc/ui/popup-menu","mvc/history/copy-dialog","mvc/base-mvc","utils/localization","mvc/webhooks","vue","components/DisplayStructured.vue"],function(e,t,a,r,l,o,n,u){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return _.clone(x).filter(function(r){return!(e&&!r.anon)&&(!(!t&&r.purge)&&(r.href&&(r.href=a+r.href,r.target=r.target||"galaxy_main"),r.confirm&&(r.func=function(){confirm(r.confirm)&&(galaxy_main.location=r.href)}),!0))})}Object.defineProperty(e,"__esModule",{value:!0});var d=i(t),c=i(a),f=(i(r),i(l)),y=i(o),h=i(n),m=i(u),x=[{html:(0,f.default)("History Lists"),header:!0},{html:(0,f.default)("Saved Histories"),href:"histories/list",target:"_top"},{html:(0,f.default)("Histories Shared with Me"),href:"histories/list_shared",target:"_top"},{html:(0,f.default)("Current History"),header:!0,anon:!0},{html:(0,f.default)("Create New"),func:function(){Galaxy&&Galaxy.currHistoryPanel&&Galaxy.currHistoryPanel.createNewHistory()}},{html:(0,f.default)("Copy History"),func:function(){(0,c.default)(Galaxy.currHistoryPanel.model).done(function(){Galaxy.currHistoryPanel.loadCurrentHistory()})}},{html:(0,f.default)("Share or Publish"),href:"history/sharing"},{html:(0,f.default)("Show Structure"),anon:!0,func:function(){var e=h.default.extend(m.default),t=document.createElement("div");Galaxy.page.center.display(t),new e({propsData:{id:""}}).$mount(t)}},{html:(0,f.default)("Extract Workflow"),href:"workflow/build_from_current_history"},{html:(0,f.default)("Delete"),anon:!0,func:function(){Galaxy&&Galaxy.currHistoryPanel&&confirm((0,f.default)("Really delete the current history?"))&&Galaxy.currHistoryPanel.model._delete().done(function(){Galaxy.currHistoryPanel.loadCurrentHistory()})}},{html:(0,f.default)("Delete Permanently"),purge:!0,anon:!0,func:function(){Galaxy&&Galaxy.currHistoryPanel&&confirm((0,f.default)("Really delete the current history permanently? This cannot be undone."))&&Galaxy.currHistoryPanel.model.purge().done(function(){Galaxy.currHistoryPanel.loadCurrentHistory()})}},{html:(0,f.default)("Dataset Actions"),header:!0,anon:!0},{html:(0,f.default)("Copy Datasets"),href:"dataset/copy_datasets"},{html:(0,f.default)("Dataset Security"),func:function(){Galaxy&&Galaxy.currHistoryPanel&&Galaxy.router&&Galaxy.router.push("/histories/permissions?id="+Galaxy.currHistoryPanel.model.id)}},{html:(0,f.default)("Resume Paused Jobs"),href:"history/resume_paused_jobs?current=True",anon:!0},{html:(0,f.default)("Collapse Expanded Datasets"),func:function(){Galaxy&&Galaxy.currHistoryPanel&&Galaxy.currHistoryPanel.collapseAll()}},{html:(0,f.default)("Unhide Hidden Datasets"),anon:!0,func:function(){Galaxy&&Galaxy.currHistoryPanel&&confirm((0,f.default)("Really unhide all hidden datasets?"))&&$.post(Galaxy.root+"history/adjust_hidden",{user_action:"unhide"},function(){Galaxy.currHistoryPanel.loadCurrentHistory()})}},{html:(0,f.default)("Delete Hidden Datasets"),anon:!0,func:function(){Galaxy&&Galaxy.currHistoryPanel&&confirm((0,f.default)("Really delete all hidden datasets?"))&&$.post(Galaxy.root+"history/adjust_hidden",{user_action:"delete"},function(){Galaxy.currHistoryPanel.loadCurrentHistory()})}},{html:(0,f.default)("Purge Deleted Datasets"),confirm:(0,f.default)("Really delete all deleted datasets permanently? This cannot be undone."),href:"history/purge_deleted_datasets",purge:!0,anon:!0},{html:(0,f.default)("Downloads"),header:!0},{html:(0,f.default)("Export Tool Citations"),anon:!0,func:function(){Galaxy&&Galaxy.currHistoryPanel&&Galaxy.router&&Galaxy.router.push("/histories/citations?id="+Galaxy.currHistoryPanel.model.id)}},{html:(0,f.default)("Export History to File"),href:"history/export_archive?preview=True",anon:!0},{html:(0,f.default)("Other Actions"),header:!0},{html:(0,f.default)("Import from File"),href:"histories/import",target:"_top"}];y.default.add({url:"api/webhooks/history-menu/all",async:!1,callback:function(e){var t=[];$.each(e.models,function(e,a){var r=a.toJSON();r.activate&&t.push({html:(0,f.default)(r.config.title),anon:!0})}),t.length>0&&(t.unshift({html:(0,f.default)("Webhooks"),header:!0}),$.merge(x,t))}});e.default=function(e,t){var a=s(void 0===(t=t||{}).anonymous||t.anonymous,t.purgeAllowed||!1,Galaxy.root);return new d.default(e,a)}});