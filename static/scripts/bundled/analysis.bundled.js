webpackJsonp([3,1],[function(t,e,i){(function(t,e){var n=i(1),s=n,a=i(59).GalaxyApp,o=i(57),l=i(11),r=i(88),c=i(87),d=i(61),h=i(19),u=i(45);window.app=function(i,n){window.Galaxy=new a(i,n),Galaxy.debug("analysis app");var p=i.config,g=new r({el:"#left",userIsAnonymous:Galaxy.user.isAnonymous(),search_url:p.search_url,toolbox:p.toolbox,toolbox_in_panel:p.toolbox_in_panel,stored_workflow_menu_entries:p.stored_workflow_menu_entries,nginx_upload_path:p.nginx_upload_path,ftp_upload_site:p.ftp_upload_site,default_genome:p.default_genome,default_extension:p.default_extension}),f=new l.CenterPanel({el:"#center"}),m=new c({el:"#right",galaxyRoot:Galaxy.root,userIsAnonymous:Galaxy.user.isAnonymous(),allow_user_dataset_purge:p.allow_user_dataset_purge}),v=new d.PageLayoutView(t.extend(i,{el:"body",left:g,center:f,right:m}));Galaxy.page=v,Galaxy.params=Galaxy.config.params,Galaxy.toolPanel=g.tool_panel,Galaxy.upload=g.uploadButton,Galaxy.currHistoryPanel=m.historyView,Galaxy.currHistoryPanel.listenToGalaxy(Galaxy),Galaxy.app={display:function(t,e){s(".select2-hidden-accessible").remove(),f.display(t)}};new(e.Router.extend({initialize:function(t){this.options=t},execute:function(t,e,i){Galaxy.debug("router execute:",t,e,i);var n=o.parse(e.pop());e.push(n),t&&t.apply(this,e)},routes:{"(/)":"home","(/)root*":"home","(/)tours(/)(:tour_id)":"show_tours"},show_tours:function(t){t?u.giveTour(t):f.display(new u.ToursView)},home:function(t){t.tool_id||t.job_id?"upload1"===t.tool_id?(Galaxy.upload.show(),this._loadCenterIframe("welcome")):this._loadToolForm(t):t.workflow_id?this._loadCenterIframe("workflow/run?id="+t.workflow_id):t.m_c?this._loadCenterIframe(t.m_c+"/"+t.m_a):this._loadCenterIframe("welcome")},_loadToolForm:function(t){t.id=t.tool_id,f.display(new h.View(t))},_loadCenterIframe:function(t,e){e=e||Galaxy.root,t=e+t,f.$("#galaxy_main").prop("src",t)}}))(i);s(function(){v.render().right.historyView.loadCurrentHistory(),Galaxy.listenTo(v.right.historyView,"history-size-change",function(){Galaxy.user.fetch({url:Galaxy.user.urlRoot()+"/"+(Galaxy.user.id||"current")})}),v.right.historyView.connectToQuotaMeter(v.masthead.quotaMeter),e.history.start({root:Galaxy.root,pushState:!0})})}}).call(e,i(2),i(3))},,,,,,,function(t,e,i){var n,s;(function(a,o){n=[i(4),i(22),i(52),i(21),i(48),i(13),i(8)],s=function(t,e,i,n,s,l,r){var c=a.View.extend({tagName:"label",initialize:function(t){this.model=t&&t.model||new a.Model(t),this.tagName=t.tagName||this.tagName,this.setElement(o("<"+this.tagName+"/>")),this.listenTo(this.model,"change",this.render,this),this.render()},title:function(t){this.model.set("title",t)},value:function(){return this.model.get("title")},render:function(){return this.$el.removeClass().addClass("ui-label").addClass(this.model.get("cls")).html(this.model.get("title")),this}}),d=a.View.extend({initialize:function(t){this.model=t&&t.model||new a.Model({message:null,status:"info",cls:"",persistent:!1}).set(t),this.listenTo(this.model,"change",this.render,this),this.render()},update:function(t){this.model.set(t)},render:function(){this.$el.removeClass().addClass("ui-message").addClass(this.model.get("cls"));var t=this.model.get("status");if(this.model.get("large")?this.$el.addClass(("success"==t&&"done"||"danger"==t&&"error"||t)+"messagelarge"):this.$el.addClass("alert").addClass("alert-"+t),this.model.get("message")){if(this.$el.html(this.model.get("message")),this.$el.fadeIn(),this.timeout&&window.clearTimeout(this.timeout),!this.model.get("persistent")){var e=this;this.timeout=window.setTimeout(function(){e.model.set("message","")},3e3)}}else this.$el.fadeOut();return this}}),h=a.View.extend({initialize:function(t){this.model=t&&t.model||new a.Model({type:"text",placeholder:"",disabled:!1,visible:!0,cls:"",area:!1,color:null,style:null}).set(t),this.tagName=this.model.get("area")?"textarea":"input",this.setElement(o("<"+this.tagName+"/>")),this.listenTo(this.model,"change",this.render,this),this.render()},events:{input:"_onchange"},value:function(t){return void 0!==t&&this.model.set("value","string"==typeof t?t:""),this.model.get("value")},render:function(){return this.$el.removeClass().addClass("ui-"+this.tagName).addClass(this.model.get("cls")).addClass(this.model.get("style")).attr("id",this.model.id).attr("type",this.model.get("type")).attr("placeholder",this.model.get("placeholder")).css("color",this.model.get("color")||"").css("border-color",this.model.get("color")||""),this.model.get("value")!==this.$el.val()&&this.$el.val(this.model.get("value")),this.model.get("disabled")?this.$el.attr("disabled",!0):this.$el.removeAttr("disabled"),this.$el[this.model.get("visible")?"show":"hide"](),this},_onchange:function(){this.value(this.$el.val()),this.model.get("onchange")&&this.model.get("onchange")(this.model.get("value"))}}),u=a.View.extend({initialize:function(t){this.model=t&&t.model||new a.Model(t),this.setElement(o("<div/>").append(this.$info=o("<div/>")).append(this.$hidden=o("<div/>"))),this.listenTo(this.model,"change",this.render,this),this.render()},value:function(t){return void 0!==t&&this.model.set("value",t),this.model.get("value")},render:function(){return this.$el.attr("id",this.model.id),this.$hidden.val(this.model.get("value")),this.model.get("info")?this.$info.show().html(this.model.get("info")):this.$info.hide(),this}});return{Button:l.ButtonDefault,ButtonIcon:l.ButtonIcon,ButtonCheck:l.ButtonCheck,ButtonMenu:l.ButtonMenu,ButtonLink:l.ButtonLink,Input:h,Label:c,Message:d,Modal:r,RadioButton:n.RadioButton,Checkbox:n.Checkbox,Radio:n.Radio,Select:e,Hidden:u,Slider:i,Drilldown:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1))},,function(t,e,i){var n,s;(function(a,o,l){n=[i(4),i(7)],s=function(t,e){var i=a.View.extend({visible:!1,initialize:function(i){var n=this;this.model=i&&i.model||new a.Model({id:t.uid(),cls:"ui-portlet",title:"",icon:"",buttons:null,body:null,scrollable:!0,nopadding:!1,operations:null,collapsible:!1,collapsible_button:!1,collapsed:!1}).set(i),this.setElement(this._template()),this.$body=this.$(".portlet-body"),this.$title_text=this.$(".portlet-title-text"),this.$title_icon=this.$(".portlet-title-icon"),this.$header=this.$(".portlet-header"),this.$content=this.$(".portlet-content"),this.$footer=this.$(".portlet-footer"),this.$backdrop=this.$(".portlet-backdrop"),this.$buttons=this.$(".portlet-buttons"),this.$operations=this.$(".portlet-operations"),this.model.get("body")&&this.append(this.model.get("body")),this.collapsible_button=new e.ButtonIcon({icon:"fa-eye",tooltip:"Collapse/Expand",cls:"ui-button-icon-plain",onclick:function(){n[n.collapsed?"expand":"collapse"]()}}),this.render()},render:function(){var t=this,e=this.model.attributes;return this.$el.removeClass().addClass(e.cls).attr("id",e.id),this.$header[e.title?"show":"hide"](),this.$title_text.html(e.title),o.each([this.$content,this.$body],function(t){t[e.nopadding?"addClass":"removeClass"]("no-padding")}),e.icon?this.$title_icon.removeClass().addClass("portlet-title-icon fa").addClass(e.icon).show():this.$title_icon.hide(),this.$title_text[e.collapsible?"addClass":"removeClass"]("no-highlight collapsible").off(),e.collapsible&&(this.$title_text.on("click",function(){t[t.collapsed?"expand":"collapse"]()}),e.collapsed?this.collapse():this.expand()),e.buttons?(this.$buttons.empty().show(),l.each(this.model.get("buttons"),function(e,i){i.$el.prop("id",e),t.$buttons.append(i.$el)})):this.$buttons.hide(),this.$operations.empty,e.collapsible_button&&this.$operations.append(this.collapsible_button.$el),e.operations&&l.each(e.operations,function(e,i){i.$el.prop("id",e),t.$operations.append(i.$el)}),this},append:function(t){this.$body.append(t)},empty:function(){this.$body.empty()},header:function(){return this.$header},body:function(){return this.$body},footer:function(){return this.$footer},show:function(){this.visible=!0,this.$el.fadeIn("fast")},hide:function(){this.visible=!1,this.$el.fadeOut("fast")},enableButton:function(t){this.$buttons.find("#"+t).prop("disabled",!1)},disableButton:function(t){this.$buttons.find("#"+t).prop("disabled",!0)},hideOperation:function(t){this.$operations.find("#"+t).hide()},showOperation:function(t){this.$operations.find("#"+t).show()},setOperation:function(t,e){this.$operations.find("#"+t).off("click").on("click",e)},title:function(t){return t&&this.$title_text.html(t),this.$title_text.html()},collapse:function(){this.collapsed=!0,this.$content.height("0%"),this.$body.hide(),this.$footer.hide(),this.collapsible_button.setIcon("fa-eye-slash")},expand:function(){this.collapsed=!1,this.$content.height("100%"),this.$body.fadeIn("fast"),this.$footer.fadeIn("fast"),this.collapsible_button.setIcon("fa-eye")},disable:function(){this.$backdrop.show()},enable:function(){this.$backdrop.hide()},_template:function(){return l("<div/>").append(l("<div/>").addClass("portlet-header").append(l("<div/>").addClass("portlet-operations")).append(l("<div/>").addClass("portlet-title").append(l("<i/>").addClass("portlet-title-icon")).append(l("<span/>").addClass("portlet-title-text")))).append(l("<div/>").addClass("portlet-content").append(l("<div/>").addClass("portlet-body")).append(l("<div/>").addClass("portlet-buttons"))).append(l("<div/>").addClass("portlet-footer")).append(l("<div/>").addClass("portlet-backdrop"))}});return{View:i}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2),i(1))},function(t,e,i){var n,s;n=[],s=function(){"use strict";var t={UPLOAD:"upload",QUEUED:"queued",RUNNING:"running",SETTING_METADATA:"setting_metadata",NEW:"new",EMPTY:"empty",OK:"ok",PAUSED:"paused",FAILED_METADATA:"failed_metadata",NOT_VIEWABLE:"noPermission",DISCARDED:"discarded",ERROR:"error"};return t.READY_STATES=[t.OK,t.EMPTY,t.PAUSED,t.FAILED_METADATA,t.NOT_VIEWABLE,t.DISCARDED,t.ERROR],t.NOT_READY_STATES=[t.UPLOAD,t.QUEUED,t.RUNNING,t.SETTING_METADATA,t.NEW],t}.apply(e,n),!(void 0!==s&&(t.exports=s))},,function(t,e,i){var n,s;(function(a,o,l){n=[i(8),i(24),i(15)],s=function(t,e,i){var n=a.Model.extend({}),s=a.Model.extend({defaults:{id:"",type:"",name:"",hda_ldda:"hda",metadata:null},initialize:function(){this.get("metadata")||this._set_metadata(),this.on("change",this._set_metadata,this)},_set_metadata:function(){var t=new n;o.each(o.keys(this.attributes),function(e){if(0===e.indexOf("metadata_")){var i=e.split("metadata_")[1];t.set(i,this.attributes[e]),delete this.attributes[e]}},this),this.set("metadata",t,{silent:!0})},get_metadata:function(t){return this.attributes.metadata.get(t)},urlRoot:Galaxy.root+"api/datasets"}),r=s.extend({defaults:o.extend({},s.prototype.defaults,{chunk_url:null,first_data_chunk:null,offset:0,at_eof:!1}),initialize:function(t){s.prototype.initialize.call(this),this.attributes.first_data_chunk&&(this.attributes.offset=this.attributes.first_data_chunk.offset),this.attributes.chunk_url=Galaxy.root+"dataset/display?dataset_id="+this.id,this.attributes.url_viz=Galaxy.root+"visualization"},get_next_chunk:function(){if(this.attributes.at_eof)return null;var t=this,e=l.Deferred();return l.getJSON(this.attributes.chunk_url,{offset:t.attributes.offset}).success(function(i){var n;""!==i.ck_data?(n=i,t.attributes.offset=i.offset):(t.attributes.at_eof=!0,n=null),e.resolve(n)}),e}}),c=a.Collection.extend({model:s}),d=a.View.extend({initialize:function(t){this.row_count=0,this.loading_chunk=!1,new p({model:t.model,$el:this.$el})},expand_to_container:function(){this.$el.height()<this.scroll_elt.height()&&this.attempt_to_fetch()},attempt_to_fetch:function(t){var e=this;!this.loading_chunk&&this.scrolled_to_bottom()&&(this.loading_chunk=!0,this.loading_indicator.show(),l.when(e.model.get_next_chunk()).then(function(t){t&&(e._renderChunk(t),e.loading_chunk=!1),e.loading_indicator.hide(),e.expand_to_container()}))},render:function(){this.loading_indicator=l("<div/>").attr("id","loading_indicator"),this.$el.append(this.loading_indicator);var t=l("<table/>").attr({id:"content_table",cellpadding:0});this.$el.append(t);var e=this.model.get_metadata("column_names"),i=l("<thead/>").appendTo(t),n=l("<tr/>").appendTo(i);if(e)n.append("<th>"+e.join("</th><th>")+"</th>");else for(var s=1;s<=this.model.get_metadata("columns");s++)n.append("<th>"+s+"</th>");var a=this,o=this.model.get("first_data_chunk");o?this._renderChunk(o):l.when(a.model.get_next_chunk()).then(function(t){a._renderChunk(t)}),this.scroll_elt.scroll(function(){a.attempt_to_fetch()})},scrolled_to_bottom:function(){return!1},_renderCell:function(t,e,i){var n=l("<td>").text(t),s=this.model.get_metadata("column_types");return void 0!==i?n.attr("colspan",i).addClass("stringalign"):s&&e<s.length&&("str"!==s[e]&&"list"!==s[e]||n.addClass("stringalign")),n},_renderRow:function(t){var e=t.split("\t"),i=l("<tr>"),n=this.model.get_metadata("columns");return this.row_count%2!==0&&i.addClass("dark_row"),e.length===n?o.each(e,function(t,e){i.append(this._renderCell(t,e))},this):e.length>n?(o.each(e.slice(0,n-1),function(t,e){i.append(this._renderCell(t,e))},this),i.append(this._renderCell(e.slice(n-1).join("\t"),n-1))):n>5&&e.length===n-1?(o.each(e,function(t,e){i.append(this._renderCell(t,e))},this),i.append(l("<td>"))):i.append(this._renderCell(t,0,n)),this.row_count++,i},_renderChunk:function(t){var e=this.$el.find("table");o.each(t.ck_data.split("\n"),function(t,i){""!==t&&e.append(this._renderRow(t))},this)}}),h=d.extend({initialize:function(t){d.prototype.initialize.call(this,t),scroll_elt=o.find(this.$el.parents(),function(t){return"auto"===l(t).css("overflow")}),scroll_elt||(scroll_elt=window),this.scroll_elt=l(scroll_elt)},scrolled_to_bottom:function(){return this.$el.height()-this.scroll_elt.scrollTop()-this.scroll_elt.height()<=0}}),u=d.extend({initialize:function(t){d.prototype.initialize.call(this,t),this.scroll_elt=this.$el.css({position:"relative",overflow:"scroll",height:t.height||"500px"})},scrolled_to_bottom:function(){return this.$el.scrollTop()+this.$el.innerHeight()>=this.el.scrollHeight}}),p=a.View.extend({col:{chrom:null,start:null,end:null},url_viz:null,dataset_id:null,genome_build:null,file_ext:null,initialize:function(t){function e(t,e){for(var i=0;i<e.length;i++)if(e[i].match(t))return i;return-1}var n=parent.Galaxy;if(n&&n.modal&&(this.modal=n.modal),n&&n.frame&&(this.frame=n.frame),this.modal&&this.frame){var s=t.model,a=s.get("metadata");if(s.get("file_ext")){if(this.file_ext=s.get("file_ext"),"bed"==this.file_ext){if(!(a.get("chromCol")&&a.get("startCol")&&a.get("endCol")))return void console.log("TabularButtonTrackster : Bed-file metadata incomplete.");this.col.chrom=a.get("chromCol")-1,this.col.start=a.get("startCol")-1,this.col.end=a.get("endCol")-1}if("vcf"==this.file_ext&&(this.col.chrom=e("Chrom",a.get("column_names")),this.col.start=e("Pos",a.get("column_names")),this.col.end=null,this.col.chrom==-1||this.col.start==-1))return void console.log("TabularButtonTrackster : VCF-file metadata incomplete.");if(void 0!==this.col.chrom){if(!s.id)return void console.log("TabularButtonTrackster : Dataset identification is missing.");if(this.dataset_id=s.id,!s.get("url_viz"))return void console.log("TabularButtonTrackster : Url for visualization controller is missing.");this.url_viz=s.get("url_viz"),s.get("genome_build")&&(this.genome_build=s.get("genome_build"));var o=new i.IconButtonView({model:new i.IconButton({title:"Visualize",icon_class:"chart_curve",id:"btn_viz"})});this.setElement(t.$el),this.$el.append(o.render().$el),this.hide()}}}},events:{"mouseover tr":"show",mouseleave:"hide"},show:function(t){function e(t){return!isNaN(parseFloat(t))&&isFinite(t)}if(null!==this.col.chrom){var i=l(t.target).parent(),n=i.children().eq(this.col.chrom).html(),s=i.children().eq(this.col.start).html(),a=this.col.end?i.children().eq(this.col.end).html():s;if(!n.match("^#")&&""!==n&&e(s)){var o={dataset_id:this.dataset_id,gene_region:n+":"+s+"-"+a},r=i.offset(),c=r.left-10,d=r.top-l(window).scrollTop()+3;l("#btn_viz").css({position:"fixed",top:d+"px",left:c+"px"}),l("#btn_viz").off("click"),l("#btn_viz").click(this.create_trackster_action(this.url_viz,o,this.genome_build)),l("#btn_viz").show()}else l("#btn_viz").hide()}},hide:function(){this.$el.find("#btn_viz").hide()},create_trackster_action:function(t,e,i){var n=this;return function(){var s={};return i&&(s["f-dbkey"]=i),l.ajax({url:t+"/list_tracks?"+l.param(s),dataType:"html",error:function(){n.modal.show({title:"Something went wrong!",body:"Unfortunately we could not add this dataset to the track browser. Please try again or contact us.",buttons:{Cancel:function(){n.modal.hide()}}})},success:function(i){n.modal.show({title:"View Data in a New or Saved Visualization",buttons:{Cancel:function(){n.modal.hide()},"View in saved visualization":function(){n.modal.show({title:"Add Data to Saved Visualization",body:i,buttons:{Cancel:function(){n.modal.hide()},"Add to visualization":function(){n.modal.hide(),n.modal.$el.find("input[name=id]:checked").each(function(){var i=l(this).val();e.id=i,n.frame.add({title:"Trackster",type:"url",content:t+"/trackster?"+l.param(e)})})}}})},"View in new visualization":function(){n.modal.hide(),n.frame.add({title:"Trackster",type:"url",content:t+"/trackster?"+l.param(e)})}}})}}),!1}}}),g=function(t){t.model||(t.model=new r(t.dataset_config));var e=t.parent_elt,i=t.embedded;delete t.embedded,delete t.parent_elt,delete t.dataset_config;var n=i?new u(t):new h(t);return n.render(),e&&(e.append(n.$el),n.expand_to_container()),n};return{Dataset:s,TabularDataset:r,DatasetCollection:c,TabularDatasetChunkedView:d,createTabularDatasetChunkedView:g}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2),i(1))},function(t,e,i){var n,s;(function(a,o){n=[i(4)],s=function(t){var e=a.View.extend({initialize:function(e){this.model=e&&e.model||new a.Model({id:t.uid(),title:"",floating:"right",icon:"",cls:"ui-button btn btn-default",wait:!1,wait_text:"Sending...",wait_cls:"btn btn-info",disabled:!1}).set(e),this.setElement(o("<button/>").attr("type","button").append(this.$icon=o("<i/>")).append(this.$title=o("<span/>"))),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(){var t=this,e=this.model.attributes;this.$el.removeClass().addClass(e.cls).addClass(e.disabled&&"disabled").attr("id",e.id).attr("disabled",e.disabled).css("float",e.floating).off("click").on("click",function(){o(".tooltip").hide(),e.onclick&&!t.disabled&&e.onclick()}).tooltip({title:e.tooltip,placement:"bottom"}),this.$icon.removeClass().addClass("icon fa").addClass(e.icon),this.$title.removeClass().addClass("title").html(e.title),e.icon&&e.title&&this.$icon.addClass("ui-margin-right"),e.wait&&(this.$el.removeClass(e.cls).addClass(e.wait_cls).prop("disabled",!0),this.$icon.removeClass(e.icon).addClass("fa-spinner fa-spin"),this.$title.html(e.wait_text))},show:function(){this.$el.show()},hide:function(){this.$el.hide()},disable:function(){this.model.set("disabled",!0)},enable:function(){this.model.set("disabled",!1)},wait:function(){this.model.set("wait",!0)},unwait:function(){this.model.set("wait",!1)},setIcon:function(t){this.model.set("icon",t)}}),i=e.extend({initialize:function(e){this.model=e&&e.model||new a.Model({id:t.uid(),title:"",icon:"",cls:""}).set(e),this.setElement(o("<a/>").append(this.$icon=o("<span/>"))),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(){var t=this.model.attributes;this.$el.removeClass().addClass(t.cls).attr({id:t.id,href:t.href||"javascript:void(0)",title:t.title,target:t.target||"_top",disabled:t.disabled}),this.$icon.removeClass().addClass(t.icon)}}),n=a.View.extend({initialize:function(e){this.model=e&&e.model||new a.Model({id:t.uid(),title:"Select/Unselect all",icons:["fa-square-o","fa-minus-square-o","fa-check-square-o"],value:0,onchange:function(){}}).set(e),this.setElement(o("<div/>").append(this.$icon=o("<span/>")).append(this.$title=o("<span/>"))),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(t){var e=this,t=this.model.attributes;this.$el.addClass("ui-button-check").off("click").on("click",function(){e.model.set("value",0===e.model.get("value")&&2||0),t.onclick&&t.onclick()}),this.$title.html(t.title),this.$icon.removeClass().addClass("icon fa ui-margin-right").addClass(t.icons[t.value])},value:function(t,e){return void 0!==t&&(e&&0!==t&&(t=t!==e&&1||2),this.model.set("value",t),this.model.get("onchange")(this.model.get("value"))),this.model.get("value")}}),s=e.extend({initialize:function(e){this.model=e&&e.model||new a.Model({id:t.uid(),title:"",floating:"right",icon:"",cls:"ui-button-icon",disabled:!1}).set(e),this.setElement(o("<div/>").append(this.$button=o("<div/>").append(this.$icon=o("<i/>")).append(this.$title=o("<span/>")))),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(t){var t=this.model.attributes;this.$el.removeClass().addClass(t.cls).addClass(t.disabled&&"disabled").attr("disabled",t.disabled).attr("id",t.id).css("float",t.floating).off("click").on("click",function(){o(".tooltip").hide(),!t.disabled&&t.onclick&&t.onclick()}),this.$button.addClass("button").tooltip({title:t.tooltip,placement:"bottom"}),this.$icon.removeClass().addClass("icon fa").addClass(t.icon),this.$title.addClass("title").html(t.title),t.icon&&t.title&&this.$icon.addClass("ui-margin-right")}}),l=e.extend({$menu:null,initialize:function(t){this.model=t&&t.model||new a.Model({id:"",title:"",floating:"right",pull:"right",icon:null,onclick:null,cls:"ui-button-icon ui-button-menu",tooltip:"",target:"",href:"",onunload:null,visible:!0,tag:""}).set(t),this.setElement(o("<div/>").append(this.$root=o("<div/>").append(this.$icon=o("<i/>")).append(this.$title=o("<span/>")))),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(){var t=this.model.attributes;this.$el.removeClass().addClass("dropdown").addClass(t.cls).attr("id",t.id).css({"float":t.floating,display:t.visible?"block":"none"}),this.$root.addClass("root button dropdown-toggle").attr("data-toggle","dropdown").tooltip({title:t.tooltip,placement:"bottom"}).off("click").on("click",function(e){o(".tooltip").hide(),e.preventDefault(),t.onclick&&t.onclick()}),this.$icon.removeClass().addClass("icon fa").addClass(t.icon),this.$title.removeClass().addClass("title").html(t.title),t.icon&&t.title&&this.$icon.addClass("ui-margin-right")},addMenu:function(e){var e=t.merge(e,{title:"",target:"",href:"",onclick:null,divider:!1,icon:null,cls:"button-menu btn-group"});this.$menu||(this.$menu=o("<ul/>").addClass("menu dropdown-menu").addClass("pull-"+this.model.get("pull")).attr("role","menu"),this.$el.append(this.$menu));var i=o("<a/>").addClass("dropdown-item").attr({href:e.href,target:e.target}).append(o("<i/>").addClass("fa").addClass(e.icon).css("display",e.icon?"inline-block":"none")).append(e.title).on("click",function(t){e.onclick&&(t.preventDefault(),e.onclick())});this.$menu.append(o("<li/>").append(i)),e.divider&&this.$menu.append(o("<li/>").addClass("divider"))}});return{ButtonDefault:e,ButtonLink:i,ButtonIcon:s,ButtonCheck:n,ButtonMenu:l}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1))},function(t,e,i){var n,s;(function(a,o){n=[i(4)],s=function(t){var e=a.View.extend({row:null,row_count:0,optionsDefault:{content:"No content available.",onchange:null,ondblclick:null,onconfirm:null,cls:"ui-table",cls_tr:""},events:{click:"_onclick",dblclick:"_ondblclick"},initialize:function(e){this.options=t.merge(e,this.optionsDefault);var i=o(this._template(this.options));this.$thead=i.find("thead"),this.$tbody=i.find("tbody"),this.$tmessage=i.find("tmessage"),this.setElement(i),this.row=this._row()},addHeader:function(t){var e=o("<th></th>");e.append(t),this.row.append(e)},appendHeader:function(){this.$thead.append(this.row),this.row=o("<tr></tr>")},add:function(t,e,i){var n=o("<td></td>");e&&n.css("width",e),i&&n.css("text-align",i),n.append(t),this.row.append(n)},append:function(t,e){this._commit(t,e,!1)},prepend:function(t,e){this._commit(t,e,!0)},get:function(t){return this.$el.find("#"+t)},del:function(t){var e=this.$tbody.find("#"+t);e.length>0&&(e.remove(),this.row_count--,this._refresh())},delAll:function(){this.$tbody.empty(),this.row_count=0,this._refresh()},value:function(t){this.before=this.$tbody.find(".current").attr("id"),void 0!==t&&(this.$tbody.find("tr").removeClass("current"),t&&this.$tbody.find("#"+t).addClass("current"));var e=this.$tbody.find(".current").attr("id");return void 0===e?null:(e!=this.before&&this.options.onchange&&this.options.onchange(t),e)},size:function(){return this.$tbody.find("tr").length},_commit:function(t,e,i){this.del(t),this.row.attr("id",t),i?this.$tbody.prepend(this.row):this.$tbody.append(this.row),e&&(this.row.hide(),this.row.fadeIn()),this.row=this._row(),this.row_count++,this._refresh()},_row:function(){return o('<tr class="'+this.options.cls_tr+'"></tr>')},_onclick:function(t){var e=this.value(),i=o(t.target).closest("tr").attr("id");""!=i&&i&&e!=i&&(this.options.onconfirm?this.options.onconfirm(i):this.value(i))},_ondblclick:function(t){var e=this.value();e&&this.options.ondblclick&&this.options.ondblclick(e)},_refresh:function(){0==this.row_count?this.$tmessage.show():this.$tmessage.hide()},_template:function(t){return'<div><table class="'+t.cls+'"><thead></thead><tbody></tbody></table><tmessage>'+t.content+"</tmessage><div>"}});return{View:e}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1))},function(t,e,i){var n,s;(function(i,a,o){n=[],s=function(){var t=i.Model.extend({defaults:{title:"",icon_class:"",on_click:null,menu_options:null,is_menu_button:!0,id:null,href:null,target:null,enabled:!0,visible:!0,tooltip_config:{}}}),e=i.View.extend({initialize:function(){this.model.attributes.tooltip_config={placement:"bottom"},this.model.bind("change",this.render,this)},render:function(){this.$el.tooltip("hide");var t=this.template(this.model.toJSON());return t.tooltip(this.model.get("tooltip_config")),this.$el.replaceWith(t),this.setElement(t),this},events:{click:"click"},click:function(t){return!a.isFunction(this.model.get("on_click"))||(this.model.get("on_click")(t),!1)},template:function(t){var e='title="'+t.title+'" class="icon-button';return t.is_menu_button&&(e+=" menu-button"),e+=" "+t.icon_class,t.enabled||(e+="_disabled"),e+='"',t.id&&(e+=' id="'+t.id+'"'),e+=' href="'+t.href+'"',t.target&&(e+=' target="'+t.target+'"'),t.visible||(e+=' style="display: none;"'),e=t.enabled?"<a "+e+"/>":"<span "+e+"/>",o(e)}}),n=i.Collection.extend({model:t}),s=i.View.extend({tagName:"div",initialize:function(){this.render()},render:function(){var t=this;return this.collection.each(function(e){var i=o("<a/>").attr("href","javascript:void(0)").attr("title",e.attributes.title).addClass("icon-button menu-button").addClass(e.attributes.icon_class).appendTo(t.$el).click(e.attributes.on_click);e.attributes.tooltip_config&&i.tooltip(e.attributes.tooltip_config);var n=e.get("options");n&&make_popupmenu(i,n)}),this}}),l=function(e,i){i||(i={});var o=new n(a.map(e,function(e){return new t(a.extend(e,i))}));return new s({collection:o})};return{IconButton:t,IconButtonView:e,IconButtonCollection:n,IconButtonMenuView:s,create_icon_buttons_menu:l}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2),i(1))},function(t,e,i){var n,s,a;!function(o){s=[i(1)],n=o,a="function"==typeof n?n.apply(e,s):n,!(void 0!==a&&(t.exports=a))}(function(t){"use_strict";var e=t;e.fn.make_text_editable=function(t){var i="num_cols"in t?t.num_cols:30,n="num_rows"in t?t.num_rows:4,s="use_textarea"in t&&t.use_textarea,a="on_finish"in t?t.on_finish:null,o="help_text"in t?t.help_text:null,l=e(this);return l.addClass("editable-text").click(function(o){if(!(e(this).children(":input").length>0)){l.removeClass("editable-text");var r,c,d=function(t){l.find(":input").remove(),""!==t?l.text(t):l.html("<br>"),l.addClass("editable-text"),a&&a(t)},h="cur_text"in t?t.cur_text:l.text();s?(r=e("<textarea/>").attr({rows:n,cols:i}).text(e.trim(h)).keyup(function(t){27===t.keyCode&&d(h)}),c=e("<button/>").text("Done").click(function(){return d(r.val()),!1})):r=e("<input type='text'/>").attr({value:e.trim(h),size:i}).blur(function(){d(h)}).keyup(function(t){27===t.keyCode?e(this).trigger("blur"):13===t.keyCode&&d(e(this).val()),t.stopPropagation()}),l.text(""),l.append(r),c&&l.append(c),r.focus(),r.select(),o.stopPropagation()}}),o&&l.attr("title",o).tooltip(),l}})},function(t,e,i){var n;(function(s,a){n=function(){function t(t){t+="";for(var e=/(\d+)(\d{3})/;e.test(t);)t=t.replace(e,"$1,$2");return t}var e=function(t){return"promise"in t},i=s.Model.extend({defaults:{ajax_settings:{},interval:1e3,success_fn:function(t){return!0}},go:function(){var t=a.Deferred(),e=this,i=e.get("ajax_settings"),n=e.get("success_fn"),s=e.get("interval"),o=function(){a.ajax(i).success(function(e){n(e)?t.resolve(e):setTimeout(o,s)})};return o(),t}}),n=function(t){t||(t="#ffffff"),"string"==typeof t&&(t=[t]);for(var e=0;e<t.length;e++)t[e]=parseInt(t[e].slice(1),16);var i,n,s,a,o,l,r,c,d,h,u,p=function(t,e,i){return(299*t+587*e+114*i)/1e3},g=function(t,e,i,n,s,a){return Math.max(t,n)-Math.min(t,n)+(Math.max(e,s)-Math.min(e,s))+(Math.max(i,a)-Math.min(i,a))},f=!1,m=0;do{for(i=Math.round(16777215*Math.random()),n=(16711680&i)>>16,s=(65280&i)>>8,a=255&i,d=p(n,s,a),f=!0,e=0;e<t.length;e++)if(o=t[e],l=(16711680&o)>>16,r=(65280&o)>>8,c=255&o,h=p(l,r,c),u=g(n,s,a,l,r,c),Math.abs(d-h)<40||u<200){f=!1;break}m++}while(!f&&m<=10);return"#"+(16777216+i).toString(16).substr(1,6)};return{commatize:t,is_deferred:e,ServerStateDeferred:i,get_random_color:n}}.call(e,i,e,t),!(void 0!==n&&(t.exports=n))}).call(e,i(3),i(1))},function(t,e,i){var n,s;(function(a,o){n=[i(27),i(6),i(5)],s=function(t,e,i){t=t||window.BibtexParser;var n="citation",s=a.Model.extend(e.LoggableMixin).extend({_logNamespace:n,defaults:{content:""},initialize:function(){var e;try{e=t(this.attributes.content)}catch(i){return}if(e.errors.length){var n=e.errors.reduce(function(t,e){return t+"; "+e});this.log("Error parsing bibtex: "+n)}if(this._fields={},this.entry=o.first(e.entries),this.entry){var s=this.entry.Fields;for(var a in s){var l=s[a],r=a.toLowerCase();this._fields[r]=l}}},entryType:function(){return this.entry?this.entry.EntryType:void 0},fields:function(){return this._fields}}),l=a.Collection.extend(e.LoggableMixin).extend({_logNamespace:n,urlRoot:Galaxy.root+"api",partial:!0,model:s}),r=l.extend({url:function(){return this.urlRoot+"/histories/"+this.history_id+"/citations"}}),c=l.extend({url:function(){return this.urlRoot+"/tools/"+this.tool_id+"/citations"},partial:!1});return{Citation:s,HistoryCitationCollection:r,ToolCitationCollection:c}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2))},function(t,e,i){var n,s;(function(a,o){n=[i(4),i(7),i(43),i(54)],s=function(t,e,i,n){var s=i.extend({initialize:function(n){var s=this;i.prototype.initialize.call(this,t.merge({customize:function(t){t.buttons={execute:execute_btn=new e.Button({icon:"fa-check",tooltip:"Execute: "+t.name+" ("+t.version+")",title:"Execute",cls:"ui-button btn btn-primary",floating:"clear",onclick:function(){execute_btn.wait(),s.portlet.disable(),s.submit(t,function(){execute_btn.unwait(),s.portlet.enable()})}})},t.job_id&&t.job_remap&&(t.inputs.rerun_remap_job_id={label:"Resume dependencies from this job",name:"rerun_remap_job_id",type:"select",display:"radio",ignore:"__ignore__",value:"__ignore__",options:[["Yes",t.job_id],["No","__ignore__"]],help:"The previous run of this tool failed and other tools were waiting for it to finish successfully. Use this option to resume those tools using the new output(s) of this tool run."})}},n))},submit:function(e,i){var s=this,l={tool_id:e.id,tool_version:e.version,inputs:this.data.create()};if(this.trigger("reset"),!s.validate(l))return Galaxy.emit.debug("tool-form::submit()","Submission canceled. Validation failed."),void(i&&i());if(e.action!==Galaxy.root+"tool_runner/index"){var r=a("<form/>").attr({action:e.action,method:e.method,enctype:e.enctype});return o.each(l.inputs,function(t,e){
r.append(a("<input/>").attr({name:e,value:t}))}),r.hide().appendTo("body").submit().remove(),void(i&&i())}Galaxy.emit.debug("tool-form::submit()","Validation complete.",l),t.request({type:"POST",url:Galaxy.root+"api/tools",data:l,success:function(t){if(i&&i(),s.$el.empty().append(s._templateSuccess(t)),t.jobs&&t.jobs.length>0){s.$el.append(a("<div/>",{id:"webhook-toolview"}));new n.ToolWebhookView}parent.Galaxy&&parent.Galaxy.currHistoryPanel&&parent.Galaxy.currHistoryPanel.refreshContents()},error:function(t){if(i&&i(),Galaxy.emit.debug("tool-form::submit","Submission failed.",t),t&&t.err_data){var e=s.data.matchResponse(t.err_data);for(var n in e){s.highlight(n,e[n]);break}}else{var a=parent.Galaxy.modal;a&&a.show({title:"Job submission failed",body:t&&t.err_msg||s._templateError(l),buttons:{Close:function(){a.hide()}}})}}})},validate:function(t){var e=t.inputs,i=-1,n=null;for(var s in e){var a=e[s],o=this.data.match(s),l=this.field_list[o],r=this.input_list[o];if(o&&r&&l){if(!r.optional&&null==a)return this.highlight(o),!1;if(a&&a.batch){var c=a.values.length,d=c>0&&a.values[0]&&a.values[0].src;if(d)if(null===n)n=d;else if(n!==d)return this.highlight(o,"Please select either dataset or dataset list fields for all batch mode fields."),!1;if(i===-1)i=c;else if(i!==c)return this.highlight(o,"Please make sure that you select the same number of inputs for all batch mode fields. This field contains <b>"+c+"</b> selection(s) while a previous field contains <b>"+i+"</b>."),!1}}else Galaxy.emit.debug("tool-form::validate()","Retrieving input objects failed.")}return!0},_templateSuccess:function(t){if(t.jobs&&t.jobs.length>0){var e=t.jobs.length,i=1==e?"1 job has":e+" jobs have",n=a("<div/>").addClass("donemessagelarge").append(a("<p/>").text(i+" been successfully added to the queue - resulting in the following datasets:"));return o.each(t.outputs,function(t){n.append(a("<p/>").addClass("messagerow").append(a("<b/>").text(t.hid+": "+t.name)))}),n.append(a("<p/>").append("<b/>").text("You can check the status of queued jobs and view the resulting data by refreshing the History pane. When the job has been run the status will change from 'running' to 'finished' if completed successfully or 'error' if problems were encountered.")),n}return this._templateError(t)},_templateError:function(t){return a("<div/>").addClass("errormessagelarge").append(a("<p/>").text("The server could not complete the request. Please contact the Galaxy Team if this error persists.")).append(a("<pre/>").text(JSON.stringify(t,null,4)))}});return{View:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(1),i(2))},function(t,e,i){var n,s;(function(a,o){n=[i(4),i(9),i(7)],s=function(t,e,i){var n=a.View.extend({initialize:function(t){var n=this;this.options=t,this.name=t.name||"element",this.multiple=t.multiple||!1,this.message=new i.Message,this.portlet=new e.View({cls:"ui-portlet-section"}),this.select=new i.Select.View({optional:t.optional}),this.button=new i.ButtonIcon({icon:"fa fa-sign-in",floating:"left",tooltip:"Insert new "+this.name,onclick:function(){n.add({id:n.select.value(),name:n.select.text()})}}),this.setElement(this._template(t)),this.$(".ui-list-message").append(this.message.$el),this.$(".ui-list-portlet").append(this.portlet.$el),this.$(".ui-list-button").append(this.button.$el),this.$(".ui-list-select").append(this.select.$el)},value:function(t){if(void 0!==t){if(this.portlet.empty(),o.isArray(t))for(var e in t){var i=t[e],n=null,s=null;"string"!=o.type(i)?(n=i.id,s=i.name):n=s=i,null!=n&&this.add({id:n,name:s})}this._refresh()}var a=[];return this.$(".ui-list-id").each(function(){a.push({id:o(this).prop("id"),name:o(this).find(".ui-list-name").html()})}),0==a.length?null:a},add:function(e){var i=this;if(0===this.$('[id="'+e.id+'"]').length)if(t.isEmpty(e.id))this.message.update({message:"Please select a valid "+this.name+".",status:"danger"});else{var n=o(this._templateRow({id:e.id,name:e.name}));n.on("click",function(){n.remove(),i._refresh()}),n.on("mouseover",function(){n.addClass("portlet-highlight")}),n.on("mouseout",function(){n.removeClass("portlet-highlight")}),this.portlet.append(n),this._refresh()}else this.message.update({message:"This "+this.name+" is already in the list."})},update:function(t){this.select.update(t)},_refresh:function(){this.$(".ui-list-id").length>0?(!this.multiple&&this.button.disable(),this.$(".ui-list-portlet").show()):(this.button.enable(),this.$(".ui-list-portlet").hide()),this.options.onchange&&this.options.onchange()},_template:function(t){return'<div class="ui-list"><div class="ui-margin-top"><span class="ui-list-button"/><span class="ui-list-select"/></div><div class="ui-list-message"/><div class="ui-list-portlet"/></div>'},_templateRow:function(t){return'<div id="'+t.id+'" class="ui-list-id"><span class="ui-list-delete fa fa-trash"/><span class="ui-list-name">'+t.name+"</span></div>"}});return{View:n}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1))},function(t,e,i){var n,s;(function(a,o,l){n=[i(4),i(13)],s=function(t,e){var i=a.View.extend({initialize:function(e){var i=this;this.model=e&&e.model||new a.Model({visible:!0,data:[],id:t.uid(),error_text:"No options available.",wait_text:"Please wait...",multiple:!1,optional:!1,onchange:function(){}}).set(e),this.listenTo(this.model,"change:value",this._changeValue,this),this.listenTo(this.model,"change:wait",this._changeWait,this),this.listenTo(this.model,"change:data",this._changeData,this),this.listenTo(this.model,"change:visible",this._changeVisible,this),this.on("change",function(){i.model.get("onchange")(i.value())}),this.render()},render:function(){var t=this;this.$el.empty().removeClass().addClass("ui-options").append(this.$message=o("<div/>")).append(this.$menu=o("<div/>").addClass("ui-options-menu")).append(this.$options=o(this._template())),this.all_button=null,this.model.get("multiple")&&(this.all_button=new e.ButtonCheck({onclick:function(){t.$("input").prop("checked",0!==t.all_button.value()),t.value(t._getValue()),t.trigger("change")}}),this.$menu.append(this.all_button.$el)),this._changeData(),this._changeWait(),this._changeVisible()},_changeData:function(){var t=this;this.$options.empty(),this._templateOptions?this.$options.append(this._templateOptions(this.model.get("data"))):l.each(this.model.get("data"),function(e){t.$options.append(o(t._templateOption(e)).addClass("ui-option").tooltip({title:e.tooltip,placement:"bottom"}))});var t=this;this.$("input").on("change",function(){t.value(t._getValue()),t.trigger("change")}),this._changeValue(),this._changeWait()},_changeVisible:function(){this.$el[this.model.get("visible")?"show":"hide"]()},_changeWait:function(){this.model.get("wait")?0===this.length()&&(this._messageShow(this.model.get("wait_text"),"info"),this.$options.hide(),this.$menu.hide()):0===this.length()?(this._messageShow(this.model.get("error_text"),"danger"),this.$options.hide(),this.$menu.hide()):(this.$message.hide(),this.$options.css("display","inline-block"),this.$menu.show())},_changeValue:function(){this._setValue(this.model.get("value")),null!==this._getValue()||this.model.get("multiple")||this.model.get("optional")||this._setValue(this.first()),this.all_button&&this.all_button.value(o.isArray(this._getValue())?this._getValue().length:0,this.length())},value:function(t){return void 0!==t&&this.model.set("value",t),this._getValue()},first:function(){var t=this.$("input").first();return t.length>0?t.val():null},wait:function(){this.model.set("wait",!0)},unwait:function(){this.model.set("wait",!1)},length:function(){return this.$(".ui-option").length},_setValue:function(t){var e=this;if(void 0!==t&&(this.$("input").prop("checked",!1),null!==t)){var i=o.isArray(t)?t:[t];l.each(i,function(t){e.$('input[value="'+t+'"]').first().prop("checked",!0)})}},_getValue:function(){var e=[];return this.$(":checked").each(function(){e.push(o(this).val())}),t.isEmpty(e)?null:this.model.get("multiple")?e:e[0]},_messageShow:function(t,e){this.$message.show().removeClass().addClass("ui-message alert alert-"+e).html(t)},_template:function(){return o("<div/>").addClass("ui-options-list")}}),n=i.extend({_templateOption:function(e){var i=t.uid();return o("<div/>").addClass("ui-option").append(o("<input/>").attr({id:i,type:this.model.get("type"),name:this.model.id,value:e.value})).append(o("<label/>").addClass("ui-options-label").attr("for",i).html(e.label))}}),s={};s.View=n.extend({initialize:function(t){t.type="radio",n.prototype.initialize.call(this,t)}});var r={};r.View=n.extend({initialize:function(t){t.type="checkbox",t.multiple=!0,n.prototype.initialize.call(this,t)}});var c={};return c.View=i.extend({initialize:function(t){i.prototype.initialize.call(this,t)},_setValue:function(t){void 0!==t&&(this.$("input").prop("checked",!1),this.$("label").removeClass("active"),this.$('[value="'+t+'"]').prop("checked",!0).closest("label").addClass("active"))},_templateOption:function(t){var e=o("<label/>").addClass("btn btn-default");return t.icon&&e.append(o("<i/>").addClass("fa").addClass(t.icon).addClass(!t.label&&"no-padding")),e.append(o("<input/>").attr({type:"radio",name:this.model.id,value:t.value})),t.label&&e.append(t.label),e},_template:function(){return o("<div/>").addClass("btn-group ui-radiobutton").attr("data-toggle","buttons")}}),{Base:i,BaseIcons:n,Radio:s,RadioButton:c,Checkbox:r}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1),i(2))},function(t,e,i){var n,s;(function(a,o,l){n=[i(4),i(13)],s=function(t,e){var i=a.View.extend({initialize:function(e){var i=this;this.data=[],this.data2=[],this.model=e&&e.model||new a.Model({id:t.uid(),cls:"ui-select",error_text:"No options available",empty_text:"Nothing selected",visible:!0,wait:!1,multiple:!1,searchable:!0,optional:!1,disabled:!1,onchange:function(){},value:null,selectall:!0,pagesize:20}).set(e),this.on("change",function(){i.model.get("onchange")&&i.model.get("onchange")(i.value())}),this.listenTo(this.model,"change:data",this._changeData,this),this.listenTo(this.model,"change:disabled",this._changeDisabled,this),this.listenTo(this.model,"change:wait",this._changeWait,this),this.listenTo(this.model,"change:visible",this._changeVisible,this),this.listenTo(this.model,"change:value",this._changeValue,this),this.listenTo(this.model,"change:multiple change:searchable change:cls change:id",this.render,this),this.render()},render:function(){var t=this;this.model.get("searchable")?this._renderSearchable():this._renderClassic(),this.$el.addClass(this.model.get("cls")).attr("id",this.model.get("id")),this.$select.empty().addClass("select").attr("id",this.model.get("id")+"_select").prop("multiple",this.model.get("multiple")).on("change",function(){t.value(t._getValue()),t.trigger("change")}),this._changeData(),this._changeWait(),this._changeVisible(),this._changeDisabled()},_renderClassic:function(){var t=this;this.$el.addClass("ui-select-multiple").append(this.$select=o("<select/>")).append(this.$resize=o("<div/>").append(this.$resize_icon=o("<i/>"))),this.$resize_icon.addClass("fa fa-angle-double-right fa-rotate-45"),this.$resize.removeClass().addClass("icon-resize").off("mousedown").on("mousedown",function(e){var i=e.pageY,n=t.$select.height();t.minHeight=t.minHeight||n,o("#dd-helper").show().on("mousemove",function(e){t.$select.height(Math.max(n+(e.pageY-i),t.minHeight))}).on("mouseup mouseleave",function(){o("#dd-helper").hide().off()})})},_renderSearchable:function(){var t=this;this.$el.append(this.$select=o("<div/>")).append(this.$dropdown=o("<div/>")),this.$dropdown.hide(),this.model.get("multiple")||this.$dropdown.show().on("click",function(){t.$select.select2&&t.$select.select2("open")}),this.all_button=null,this.model.get("multiple")&&this.model.get("selectall")&&(this.all_button=new e.ButtonCheck({onclick:function(){var e=[];0!==t.all_button.value()&&l.each(t.model.get("data"),function(t){e.push(t.value)}),t.value(e),t.trigger("change")}}),this.$el.prepend(this.all_button.$el))},_changeData:function(){var t=this;this.data=[],!this.model.get("multiple")&&this.model.get("optional")&&this.data.push({value:"__null__",label:t.model.get("empty_text")}),l.each(this.model.get("data"),function(e){t.data.push(e)}),0==this.length()&&this.data.push({value:"__null__",label:this.model.get("error_text")}),this.model.get("searchable")?(this.data2=[],l.each(this.data,function(e,i){t.data2.push({order:i,id:e.value,text:e.label})}),this.$select.data("select2")&&this.$select.select2("destroy"),this.$select.select2({data:t.data2,closeOnSelect:!this.model.get("multiple"),multiple:this.model.get("multiple"),query:function(e){var i=t.model.get("pagesize"),n=l.filter(t.data2,function(t){return!e.term||""==e.term||t.text.toUpperCase().indexOf(e.term.toUpperCase())>=0});e.callback({results:n.slice((e.page-1)*i,e.page*i),more:n.length>=e.page*i})}}),this.$(".select2-container .select2-search input").off("blur")):(this.$select.find("option").remove(),l.each(this.data,function(e){t.$select.append(o("<option/>").attr("value",e.value).html(l.escape(e.label)))})),this.model.set("disabled",0==this.length()),this._changeValue()},_changeDisabled:function(){this.model.get("searchable")?this.$select.select2(this.model.get("disabled")?"disable":"enable"):this.$select.prop("disabled",this.model.get("disabled"))},_changeWait:function(){this.model.get("searchable")&&this.$dropdown.removeClass().addClass("icon-dropdown fa").addClass(this.model.get("wait")?"fa-spinner fa-spin":"fa-caret-down")},_changeVisible:function(){this.$el[this.model.get("visible")?"show":"hide"](),this.$select[this.model.get("visible")?"show":"hide"]()},_changeValue:function(){if(this._setValue(this.model.get("value")),this.model.get("multiple")){if(this.all_button){var t=this._getValue();this.all_button.value(o.isArray(t)?t.length:0,this.length())}}else null!==this._getValue()||this.model.get("optional")||this._setValue(this.first())},value:function(t){return void 0!==t&&this.model.set("value",t),this._getValue()},first:function(){return this.data.length>0?this.data[0].value:null},exists:function(t){return l.findWhere(this.data,{value:t})},text:function(){var t=this._getValue(),e=this.exists(o.isArray(t)?t[0]:t);return e?e.label:""},show:function(){this.model.set("visible",!0)},hide:function(){this.model.set("visible",!1)},wait:function(){this.model.set("wait",!0)},unwait:function(){this.model.set("wait",!1)},disabled:function(){return this.model.get("disabled")},enable:function(){this.model.set("disabled",!1)},disable:function(){this.model.set("disabled",!0)},add:function(t,e){l.each(this.model.get("data"),function(e){!l.findWhere(t,e)&&t.push(e)}),e&&t&&t.sort(e),this.model.set("data",t)},update:function(t){this.model.set("data",t)},setOnChange:function(t){this.model.set("onchange",t)},length:function(){return o.isArray(this.model.get("data"))?this.model.get("data").length:0},_setValue:function(t){var e=this;if(null!==t&&void 0!==t||(t="__null__"),this.model.get("multiple")?t=o.isArray(t)?t:[t]:o.isArray(t)&&(t=t.length>0?t[0]:"__null__"),this.model.get("searchable")){if(o.isArray(t))val=[],l.each(t,function(t){var i=l.findWhere(e.data2,{id:t});i&&val.push(i)}),t=val;else{var i=l.findWhere(this.data2,{id:t});t=i}this.$select.select2("data",t)}else this.$select.val(t)},_getValue:function(){var e=null;if(this.model.get("searchable")){var i=this.$select.select2("data");i&&(o.isArray(i)?(e=[],i.sort(function(t,e){return t.order-e.order}),l.each(i,function(t){e.push(t.id)})):e=i.id)}else e=this.$select.val();return t.isEmpty(e)?null:e}});return{View:i}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1),i(2))},function(t,e,i){var n,s,a;(function(i,o){!function(i,o){s=[],n=o,a="function"==typeof n?n.apply(e,s):n,!(void 0!==a&&(t.exports=a))}(this,function(){var t=function(t){t=t||{},t.tooltipConfig=t.tooltipConfig||{placement:"bottom"},t.classes=["icon-btn"].concat(t.classes||[]),t.disabled&&t.classes.push("disabled");var e=['<a class="',t.classes.join(" "),'"',t.title?' title="'+t.title+'"':"",!t.disabled&&t.target?' target="'+t.target+'"':"",' href="',!t.disabled&&t.href?t.href:"javascript:void(0);",'">','<span class="fa ',t.faIcon,'"></span>',"</a>"].join(""),n=i(e).tooltip(t.tooltipConfig);return o.isFunction(t.onclick)&&n.click(t.onclick),n};return t})}).call(e,i(1),i(2))},,function(t,e,i){var n,s;(function(a,o,l){n=[i(4)],s=function(t){var e=a.View.extend({optionsDefault:{with_close:!0,title:null,placement:"top",container:"body",body:null},initialize:function(e){this.setElement(this._template()),this.uid=t.uid(),this.options=o.defaults(e||{},this.optionsDefault),this.options.container.parent().append(this.el),this.$title=this.$(".popover-title-label"),this.$close=this.$(".popover-close"),this.$body=this.$(".popover-content"),this.options.body&&this.append(this.options.body);var i=this;l("body").on("mousedown."+this.uid,function(t){i.visible&&!l(i.options.container).is(t.target)&&!l(i.el).is(t.target)&&0===l(i.el).has(t.target).length&&i.hide()})},render:function(){this.$title.html(this.options.title),this.$el.removeClass().addClass("ui-popover popover fade in").addClass(this.options.placement),this.$el.css(this._get_placement(this.options.placement));var t=this;this.options.with_close?this.$close.on("click",function(){t.hide()}).show():this.$close.off().hide()},title:function(t){void 0!==t&&(this.options.title=t,this.$title.html(t))},show:function(){this.render(),this.$el.show(),this.visible=!0},hide:function(){this.$el.hide(),this.visible=!1},append:function(t){this.$body.append(t)},empty:function(){this.$body.empty()},remove:function(){l("body").off("mousedown."+this.uid),this.$el.remove()},_get_placement:function(t){var e=this._get_width(this.$el),i=this.$el.height(),n=this.options.container,s=this._get_width(n),a=this._get_height(n),o=n.position(),l=left=0;if(["top","bottom"].indexOf(t)!=-1)switch(left=o.left-e+(s+e)/2,t){case"top":l=o.top-i-5;break;case"bottom":l=o.top+a+5}else switch(l=o.top-i+(a+i)/2,t){case"right":left=o.left+s}return{top:l,left:left}},_get_width:function(t){return t.width()+parseInt(t.css("padding-left"))+parseInt(t.css("margin-left"))+parseInt(t.css("padding-right"))+parseInt(t.css("margin-right"))},_get_height:function(t){return t.height()+parseInt(t.css("padding-top"))+parseInt(t.css("padding-bottom"))},_template:function(t){return'<div class="ui-popover popover fade in"><div class="arrow"/><div class="popover-title"><div class="popover-title-label"/><div class="popover-close fa fa-times-circle"/></div><div class="popover-content"/></div>'}});return{View:e}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2),i(1))},function(t,e,i){var n,s;(function(a,o){n=[i(4)],s=function(t){var e=a.View.extend({optionsDefault:{css:"",placeholder:"No data available",data:[],value:null,multiple:!1,minimumInputLength:0,initialData:""},initialize:function(e){if(this.options=t.merge(e,this.optionsDefault),this.setElement(this._template(this.options)),!this.options.container)return void console.log("ui-select::initialize() : container not specified.");if(this.options.container.append(this.$el),this.select_data=this.options.data,this._refresh(),!this.options.multiple){this.options.value&&this._setValue(this.options.value);var i=this;this.options.onchange&&this.$el.on("change",function(){i.options.onchange(i.value())})}},value:function(t){var e=this._getValue();void 0!==t&&this._setValue(t);var i=this._getValue();return i!=e&&this.options.onchange&&this.options.onchange(i),i},text:function(){return this.$el.select2("data").text},disabled:function(){return!this.$el.select2("enable")},enable:function(){this.$el.select2("enable",!0)},disable:function(){this.$el.select2("enable",!1)},add:function(t){this.select_data.push({id:t.id,text:t.text}),this._refresh()},del:function(t){var e=this._getIndex(t);e!=-1&&(this.select_data.splice(e,1),this._refresh())},remove:function(){this.$el.select2("destroy")},update:function(t){this.select_data=[];for(var e in t.data)this.select_data.push(t.data[e]);this._refresh()},_refresh:function(){if(this.options.multiple){var t={multiple:this.options.multiple,containerCssClass:this.options.css,placeholder:this.options.placeholder,minimumInputLength:this.options.minimumInputLength,ajax:this.options.ajax,dropdownCssClass:this.options.dropdownCssClass,escapeMarkup:this.options.escapeMarkup,formatResult:this.options.formatResult,formatSelection:this.options.formatSelection,initSelection:this.options.initSelection,initialData:this.options.initialData};this.$el.select2(t)}else{var e=this._getValue(),t={data:this.select_data,containerCssClass:this.options.css,placeholder:this.options.placeholder,dropdownAutoWidth:!0};this.$el.select2(t),this._setValue(e)}},_getIndex:function(t){o.findIndex(this.select_data,{id:t})},_getValue:function(){return this.$el.select2("val")},_setValue:function(t){var e=this._getIndex(t);e==-1&&this.select_data.length>0&&(t=this.select_data[0].id),this.$el.select2("val",t)},_template:function(t){return'<input type="hidden" value="'+this.options.initialData+'"/>'}});return{View:e}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2))},function(t,e){function i(t){function e(t){s.push(t)}if("string"==typeof t){var n={},s=[],a=i.call(n,e);return a.parse(t),{entries:s,errors:a.getErrors()}}if("function"!=typeof t)throw"Invalid parser construction.";return this.STATES_={ENTRY_OR_JUNK:0,OBJECT_TYPE:1,ENTRY_KEY:2,KV_KEY:3,EQUALS:4,KV_VALUE:5},this.DATA_={},this.CALLBACK_=t,this.CHAR_=0,this.LINE_=1,this.CHAR_IN_LINE_=0,this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.PARSETMP_={},this.SKIPTILLEOL_=!1,this.VALBRACES_=null,this.BRACETYPE_=null,this.BRACECOUNT_=0,this.STATE_=this.STATES_.ENTRY_OR_JUNK,this.ERRORS_=[],this.ENTRY_TYPES_={inproceedings:1,proceedings:2,article:3,techreport:4,misc:5,mastersthesis:6,book:7,phdthesis:8,incollection:9,unpublished:10,inbook:11,manual:12,periodical:13,booklet:14,masterthesis:15,conference:16,online:998,data:999},this.MACROS_={jan:"January",feb:"February",mar:"March",apr:"April",may:"May",jun:"June",jul:"July",aug:"August",sep:"September",oct:"October",nov:"November",dec:"December",Jan:"January",Feb:"February",Mar:"March",Apr:"April",May:"May",Jun:"June",Jul:"July",Aug:"August",Sep:"September",Oct:"October",Nov:"November",Dec:"December"},this.getErrors=function(){return this.ERRORS_},this.parse=function(t){for(var e=0;e<t.length;e++)this.processCharacter_(t[e])},this.error_=function(t){this.ERRORS_.push([this.LINE_,this.CHAR_IN_LINE_,this.CHAR_,t])},this.processEntry_=function(){var t=this.DATA_;if(t.Fields)for(var e in t.Fields){for(var i=t.Fields[e],n=0;n<this.CHARCONV_.length;n++){var s=this.CHARCONV_[n][0],a=this.CHARCONV_[n][1];i=i.replace(s,a)}i=i.replace(/[\n\r\t]/g," ").replace(/\s\s+/g," ").replace(/^\s+|\s+$/g,"");for(var o=i.length,l="",n=0;n<o;n++){var r=i[n],c=!1;"\\"==r&&n<o-1?r=i[++n]:"{"!=r&&"}"!=r||(c=!0),c||(l+=r)}t.Fields[e]=l}if("string"==t.ObjectType)for(var e in t.Fields)this.MACROS_[e]=t.Fields[e];else this.CALLBACK_(t)},this.processCharacter_=function(t){if(this.CHAR_++,this.CHAR_IN_LINE_++,"\n"==t&&(this.LINE_++,this.CHAR_IN_LINE_=1),this.SKIPTILLEOL_)return void("\n"==t&&(this.SKIPTILLEOL_=!1));if(this.SKIPCOMMENT_&&"%"==t)return void(this.SKIPTILLEOL_=!0);if(!this.SKIPWS_||!/\s/.test(t)){this.SKIPWS_=!1,this.SKIPCOMMENT_=!1,this.SKIPTILLEOL_=!1;for(var e=!0;e;)switch(e=!1,this.STATE_){case this.STATES_.ENTRY_OR_JUNK:"@"==t&&(this.STATE_=this.STATES_.OBJECT_TYPE,this.DATA_={ObjectType:""}),this.BRACETYPE_=null,this.SKIPWS_=!0,this.SKIPCOMMENT_=!0;break;case this.STATES_.OBJECT_TYPE:if(/[A-Za-z]/.test(t))this.DATA_.ObjectType+=t.toLowerCase(),this.SKIPWS_=!0,this.SKIPCOMMENT_=!0;else{var i=this.DATA_.ObjectType;"comment"==i?this.STATE_=this.STATES_.ENTRY_OR_JUNK:"string"==i?(this.DATA_.ObjectType=i,this.DATA_.Fields={},this.BRACETYPE_=t,this.BRACECOUNT_=1,this.STATE_=this.STATES_.KV_KEY,this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.PARSETMP_={Key:""}):"preamble"==i?this.STATE_=this.STATES_.ENTRY_OR_JUNK:i in this.ENTRY_TYPES_?(this.DATA_.ObjectType="entry",this.DATA_.EntryType=i,this.DATA_.EntryKey="",this.STATE_=this.STATES_.ENTRY_KEY,e=!0):(this.error_('Unrecognized object type: "'+this.DATA_.ObjectType+'"'),this.STATE_=this.STATES_.ENTRY_OR_JUNK)}break;case this.STATES_.ENTRY_KEY:if(("{"===t||"("===t)&&null==this.BRACETYPE_){this.BRACETYPE_=t,this.BRACECOUNT_=1,this.SKIPWS_=!0,this.SKIPCOMMENT_=!0;break}/[,%\s]/.test(t)?this.DATA_.EntryKey.length<1?(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0):null==this.BRACETYPE_?(this.error_("No opening brace for object."),this.STATE_=this.STATES_.ENTRY_OR_JUNK):(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,e=!0,this.STATE_=this.STATES_.KV_KEY,this.PARSETMP_.Key="",this.DATA_.Fields={}):(this.DATA_.EntryKey+=t,this.SKIPWS_=!1,this.SKIPCOMMENT_=!1);break;case this.STATES_.KV_KEY:if("}"==t&&"{"==this.BRACETYPE_||")"==t&&"("==this.BRACETYPE_){this.processEntry_(),this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.STATE_=this.STATES_.ENTRY_OR_JUNK;break}/[\-A-Za-z:]/.test(t)?(this.PARSETMP_.Key+=t,this.SKIPWS_=!1,this.SKIPCOMMENT_=!1):this.PARSETMP_.Key.length<1?(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0):(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.STATE_=this.STATES_.EQUALS,e=!0);break;case this.STATES_.EQUALS:if("}"==t&&"{"==this.BRACETYPE_||")"==t&&"("==this.BRACETYPE_){this.error_('Key-value pair has key "'+this.PARSETMP_.Key+'", but no value.'),this.processEntry_(),this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.STATE_=this.STATES_.ENTRY_OR_JUNK;break}"="==t&&(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.STATE_=this.STATES_.KV_VALUE,this.PARSETMP_.Value="",this.VALBRACES_={'"':[],"{":[]});break;case this.STATES_.KV_VALUE:var n=this.VALBRACES_,s=this.PARSETMP_.Value,a=!1;if('"'==t||"{"==t||"}"==t||","==t){if(","==t&&0===n['"'].length+n["{"].length){var o=this.PARSETMP_.Value.trim();o in this.MACROS_?this.PARSETMP_.Value=this.MACROS_[o]:this.error_("Reference to an undefined macro: "+o),a=!0}if('"'==t){if(0===n['"'].length+n["{"].length){n['"'].push(this.CHAR_),this.SKIPWS_=!1,this.SKIPCOMMENT_=!1;break}1!=n['"'].length||0!=n["{"].length||0!=s.length&&"\\"==s[s.length-1]||(a=!0)}if("{"==t&&(0!=s.length&&"\\"==s[s.length-1]||(n["{"].push(this.CHAR_),this.SKIPWS_=!1,this.SKIPCOMMENT_=!1)),"}"==t)if(0===n['"'].length+n["{"].length){var o=this.PARSETMP_.Value.trim();o in this.MACROS_?this.PARSETMP_.Value=this.MACROS_[o]:this.error_("Reference to an undefined macro: "+o),e=!0,a=!0}else 0!=s.length&&"\\"==s[s.length-1]||n["{"].length>0&&(n["{"].splice(n["{"].length-1,1),0==n["{"].length+n['"'].length&&(a=!0))}a?(this.SKIPWS_=!0,this.SKIPCOMMENT_=!0,this.STATE_=this.STATES_.KV_KEY,this.DATA_.Fields[this.PARSETMP_.Key]=this.PARSETMP_.Value,this.PARSETMP_={Key:""},this.VALBRACES_=null):this.PARSETMP_.Value+=t}}},this.CHARCONV_=[[/\\space /g," "],[/\\textdollar /g,"$"],[/\\textquotesingle /g,"'"],[/\\ast /g,"*"],[/\\textbackslash /g,"\\"],[/\\\^\{\}/g,"^"],[/\\textasciigrave /g,"`"],[/\\lbrace /g,"{"],[/\\vert /g,"|"],[/\\rbrace /g,"}"],[/\\textasciitilde /g,"~"],[/\\textexclamdown /g,""],[/\\textcent /g,""],[/\\textsterling /g,""],[/\\textcurrency /g,""],[/\\textyen /g,""],[/\\textbrokenbar /g,""],[/\\textsection /g,""],[/\\textasciidieresis /g,""],[/\\textcopyright /g,""],[/\\textordfeminine /g,""],[/\\guillemotleft /g,""],[/\\lnot /g,""],[/\\textregistered /g,""],[/\\textasciimacron /g,""],[/\\textdegree /g,""],[/\\pm /g,""],[/\\textasciiacute /g,""],[/\\mathrm\{\\mu\}/g,""],[/\\textparagraph /g,""],[/\\cdot /g,""],[/\\c\{\}/g,""],[/\\textordmasculine /g,""],[/\\guillemotright /g,""],[/\\textonequarter /g,""],[/\\textonehalf /g,""],[/\\textthreequarters /g,""],[/\\textquestiondown /g,""],[/\\`\{A\}/g,""],[/\\'\{A\}/g,""],[/\\\^\{A\}/g,""],[/\\~\{A\}/g,""],[/\\"\{A\}/g,""],[/\\AA /g,""],[/\\AE /g,""],[/\\c\{C\}/g,""],[/\\`\{E\}/g,""],[/\\'\{E\}/g,""],[/\\\^\{E\}/g,""],[/\\"\{E\}/g,""],[/\\`\{I\}/g,""],[/\\'\{I\}/g,""],[/\\\^\{I\}/g,""],[/\\"\{I\}/g,""],[/\\DH /g,""],[/\\~\{N\}/g,""],[/\\`\{O\}/g,""],[/\\'\{O\}/g,""],[/\\\^\{O\}/g,""],[/\\~\{O\}/g,""],[/\\"\{O\}/g,""],[/\\texttimes /g,""],[/\\O /g,""],[/\\`\{U\}/g,""],[/\\'\{U\}/g,""],[/\\\^\{U\}/g,""],[/\\"\{U\}/g,""],[/\\'\{Y\}/g,""],[/\\TH /g,""],[/\\ss /g,""],[/\\`\{a\}/g,""],[/\\'\{a\}/g,""],[/\\\^\{a\}/g,""],[/\\~\{a\}/g,""],[/\\"\{a\}/g,""],[/\\aa /g,""],[/\\ae /g,""],[/\\c\{c\}/g,""],[/\\`\{e\}/g,""],[/\\'\{e\}/g,""],[/\\\^\{e\}/g,""],[/\\"\{e\}/g,""],[/\\`\{\\i\}/g,""],[/\\'\{\\i\}/g,""],[/\\\^\{\\i\}/g,""],[/\\"\{\\i\}/g,""],[/\\dh /g,""],[/\\~\{n\}/g,""],[/\\`\{o\}/g,""],[/\\'\{o\}/g,""],[/\\\^\{o\}/g,""],[/\\~\{o\}/g,""],[/\\"\{o\}/g,""],[/\\div /g,""],[/\\o /g,""],[/\\`\{u\}/g,""],[/\\'\{u\}/g,""],[/\\\^\{u\}/g,""],[/\\"\{u\}/g,""],[/\\'\{y\}/g,""],[/\\th /g,""],[/\\"\{y\}/g,""],[/\\=\{A\}/g,""],[/\\=\{a\}/g,""],[/\\u\{A\}/g,""],[/\\u\{a\}/g,""],[/\\k\{A\}/g,""],[/\\k\{a\}/g,""],[/\\'\{C\}/g,""],[/\\'\{c\}/g,""],[/\\\^\{C\}/g,""],[/\\\^\{c\}/g,""],[/\\.\{C\}/g,""],[/\\.\{c\}/g,""],[/\\v\{C\}/g,""],[/\\v\{c\}/g,""],[/\\v\{D\}/g,""],[/\\v\{d\}/g,""],[/\\DJ /g,""],[/\\dj /g,""],[/\\=\{E\}/g,""],[/\\=\{e\}/g,""],[/\\u\{E\}/g,""],[/\\u\{e\}/g,""],[/\\.\{E\}/g,""],[/\\.\{e\}/g,""],[/\\k\{E\}/g,""],[/\\k\{e\}/g,""],[/\\v\{E\}/g,""],[/\\v\{e\}/g,""],[/\\\^\{G\}/g,""],[/\\\^\{g\}/g,""],[/\\u\{G\}/g,""],[/\\u\{g\}/g,""],[/\\.\{G\}/g,""],[/\\.\{g\}/g,""],[/\\c\{G\}/g,""],[/\\c\{g\}/g,""],[/\\\^\{H\}/g,""],[/\\\^\{h\}/g,""],[/\\Elzxh /g,""],[/\\~\{I\}/g,""],[/\\~\{\\i\}/g,""],[/\\=\{I\}/g,""],[/\\=\{\\i\}/g,""],[/\\u\{I\}/g,""],[/\\u\{\\i\}/g,""],[/\\k\{I\}/g,""],[/\\k\{i\}/g,""],[/\\.\{I\}/g,""],[/\\i /g,""],[/\\\^\{J\}/g,""],[/\\\^\{\\j\}/g,""],[/\\c\{K\}/g,""],[/\\c\{k\}/g,""],[/\\'\{L\}/g,""],[/\\'\{l\}/g,""],[/\\c\{L\}/g,""],[/\\c\{l\}/g,""],[/\\v\{L\}/g,""],[/\\v\{l\}/g,""],[/\\L /g,""],[/\\l /g,""],[/\\'\{N\}/g,""],[/\\'\{n\}/g,""],[/\\c\{N\}/g,""],[/\\c\{n\}/g,""],[/\\v\{N\}/g,""],[/\\v\{n\}/g,""],[/\\NG /g,""],[/\\ng /g,""],[/\\=\{O\}/g,""],[/\\=\{o\}/g,""],[/\\u\{O\}/g,""],[/\\u\{o\}/g,""],[/\\H\{O\}/g,""],[/\\H\{o\}/g,""],[/\\OE /g,""],[/\\oe /g,""],[/\\'\{R\}/g,""],[/\\'\{r\}/g,""],[/\\c\{R\}/g,""],[/\\c\{r\}/g,""],[/\\v\{R\}/g,""],[/\\v\{r\}/g,""],[/\\'\{S\}/g,""],[/\\'\{s\}/g,""],[/\\\^\{S\}/g,""],[/\\\^\{s\}/g,""],[/\\c\{S\}/g,""],[/\\c\{s\}/g,""],[/\\v\{S\}/g,""],[/\\v\{s\}/g,""],[/\\c\{T\}/g,""],[/\\c\{t\}/g,""],[/\\v\{T\}/g,""],[/\\v\{t\}/g,""],[/\\~\{U\}/g,""],[/\\~\{u\}/g,""],[/\\=\{U\}/g,""],[/\\=\{u\}/g,""],[/\\u\{U\}/g,""],[/\\u\{u\}/g,""],[/\\r\{U\}/g,""],[/\\r\{u\}/g,""],[/\\H\{U\}/g,""],[/\\H\{u\}/g,""],[/\\k\{U\}/g,""],[/\\k\{u\}/g,""],[/\\\^\{W\}/g,""],[/\\\^\{w\}/g,""],[/\\\^\{Y\}/g,""],[/\\\^\{y\}/g,""],[/\\"\{Y\}/g,""],[/\\'\{Z\}/g,""],[/\\'\{z\}/g,""],[/\\.\{Z\}/g,""],[/\\.\{z\}/g,""],[/\\v\{Z\}/g,""],[/\\v\{z\}/g,""],[/\\texthvlig /g,""],[/\\textnrleg /g,""],[/\\eth /g,""],[/\\textdoublepipe /g,""],[/\\'\{g\}/g,""],[/\\Elztrna /g,""],[/\\Elztrnsa /g,""],[/\\Elzopeno /g,""],[/\\Elzrtld /g,""],[/\\Elzschwa /g,""],[/\\varepsilon /g,""],[/\\Elzpgamma /g,""],[/\\Elzpbgam /g,""],[/\\Elztrnh /g,""],[/\\Elzbtdl /g,""],[/\\Elzrtll /g,""],[/\\Elztrnm /g,""],[/\\Elztrnmlr /g,""],[/\\Elzltlmr /g,""],[/\\Elzltln /g,""],[/\\Elzrtln /g,""],[/\\Elzclomeg /g,""],[/\\textphi /g,""],[/\\Elztrnr /g,""],[/\\Elztrnrl /g,""],[/\\Elzrttrnr /g,""],[/\\Elzrl /g,""],[/\\Elzrtlr /g,""],[/\\Elzfhr /g,""],[/\\Elzrtls /g,""],[/\\Elzesh /g,""],[/\\Elztrnt /g,""],[/\\Elzrtlt /g,""],[/\\Elzpupsil /g,""],[/\\Elzpscrv /g,""],[/\\Elzinvv /g,""],[/\\Elzinvw /g,""],[/\\Elztrny /g,""],[/\\Elzrtlz /g,""],[/\\Elzyogh /g,""],[/\\Elzglst /g,""],[/\\Elzreglst /g,""],[/\\Elzinglst /g,""],[/\\textturnk /g,""],[/\\Elzdyogh /g,""],[/\\Elztesh /g,""],[/\\textasciicaron /g,""],[/\\Elzverts /g,""],[/\\Elzverti /g,""],[/\\Elzlmrk /g,""],[/\\Elzhlmrk /g,""],[/\\Elzsbrhr /g,""],[/\\Elzsblhr /g,""],[/\\Elzrais /g,""],[/\\Elzlow /g,""],[/\\textasciibreve /g,""],[/\\textperiodcentered /g,""],[/\\r\{\}/g,""],[/\\k\{\}/g,""],[/\\texttildelow /g,""],[/\\H\{\}/g,""],[/\\tone\{55\}/g,""],[/\\tone\{44\}/g,""],[/\\tone\{33\}/g,""],[/\\tone\{22\}/g,""],[/\\tone\{11\}/g,""],[/\\cyrchar\\C/g,""],[/\\Elzpalh /g,""],[/\\Elzrh /g,""],[/\\Elzsbbrg /g,""],[/\\Elzxl /g,""],[/\\Elzbar /g,""],[/\\'\{A\}/g,""],[/\\'\{E\}/g,""],[/\\'\{H\}/g,""],[/\\'\{\}\{I\}/g,""],[/\\'\{\}O/g,""],[/\\mathrm\{'Y\}/g,""],[/\\mathrm\{'\\Omega\}/g,""],[/\\acute\{\\ddot\{\\iota\}\}/g,""],[/\\Alpha /g,""],[/\\Beta /g,""],[/\\Gamma /g,""],[/\\Delta /g,""],[/\\Epsilon /g,""],[/\\Zeta /g,""],[/\\Eta /g,""],[/\\Theta /g,""],[/\\Iota /g,""],[/\\Kappa /g,""],[/\\Lambda /g,""],[/\\Xi /g,""],[/\\Pi /g,""],[/\\Rho /g,""],[/\\Sigma /g,""],[/\\Tau /g,""],[/\\Upsilon /g,""],[/\\Phi /g,""],[/\\Chi /g,""],[/\\Psi /g,""],[/\\Omega /g,""],[/\\mathrm\{\\ddot\{I\}\}/g,""],[/\\mathrm\{\\ddot\{Y\}\}/g,""],[/\\'\{\$\\alpha\$\}/g,""],[/\\acute\{\\epsilon\}/g,""],[/\\acute\{\\eta\}/g,""],[/\\acute\{\\iota\}/g,""],[/\\acute\{\\ddot\{\\upsilon\}\}/g,""],[/\\alpha /g,""],[/\\beta /g,""],[/\\gamma /g,""],[/\\delta /g,""],[/\\epsilon /g,""],[/\\zeta /g,""],[/\\eta /g,""],[/\\texttheta /g,""],[/\\iota /g,""],[/\\kappa /g,""],[/\\lambda /g,""],[/\\mu /g,""],[/\\nu /g,""],[/\\xi /g,""],[/\\pi /g,""],[/\\rho /g,""],[/\\varsigma /g,""],[/\\sigma /g,""],[/\\tau /g,""],[/\\upsilon /g,""],[/\\varphi /g,""],[/\\chi /g,""],[/\\psi /g,""],[/\\omega /g,""],[/\\ddot\{\\iota\}/g,""],[/\\ddot\{\\upsilon\}/g,""],[/\\'\{o\}/g,""],[/\\acute\{\\upsilon\}/g,""],[/\\acute\{\\omega\}/g,""],[/\\Pisymbol\{ppi022\}\{87\}/g,""],[/\\textvartheta /g,""],[/\\Upsilon /g,""],[/\\phi /g,""],[/\\varpi /g,""],[/\\Stigma /g,""],[/\\Digamma /g,""],[/\\digamma /g,""],[/\\Koppa /g,""],[/\\Sampi /g,""],[/\\varkappa /g,""],[/\\varrho /g,""],[/\\textTheta /g,""],[/\\backepsilon /g,""],[/\\cyrchar\\CYRYO /g,""],[/\\cyrchar\\CYRDJE /g,""],[/\\cyrchar\{\\'\\CYRG\}/g,""],[/\\cyrchar\\CYRIE /g,""],[/\\cyrchar\\CYRDZE /g,""],[/\\cyrchar\\CYRII /g,""],[/\\cyrchar\\CYRYI /g,""],[/\\cyrchar\\CYRJE /g,""],[/\\cyrchar\\CYRLJE /g,""],[/\\cyrchar\\CYRNJE /g,""],[/\\cyrchar\\CYRTSHE /g,""],[/\\cyrchar\{\\'\\CYRK\}/g,""],[/\\cyrchar\\CYRUSHRT /g,""],[/\\cyrchar\\CYRDZHE /g,""],[/\\cyrchar\\CYRA /g,""],[/\\cyrchar\\CYRB /g,""],[/\\cyrchar\\CYRV /g,""],[/\\cyrchar\\CYRG /g,""],[/\\cyrchar\\CYRD /g,""],[/\\cyrchar\\CYRE /g,""],[/\\cyrchar\\CYRZH /g,""],[/\\cyrchar\\CYRZ /g,""],[/\\cyrchar\\CYRI /g,""],[/\\cyrchar\\CYRISHRT /g,""],[/\\cyrchar\\CYRK /g,""],[/\\cyrchar\\CYRL /g,""],[/\\cyrchar\\CYRM /g,""],[/\\cyrchar\\CYRN /g,""],[/\\cyrchar\\CYRO /g,""],[/\\cyrchar\\CYRP /g,""],[/\\cyrchar\\CYRR /g,""],[/\\cyrchar\\CYRS /g,""],[/\\cyrchar\\CYRT /g,""],[/\\cyrchar\\CYRU /g,""],[/\\cyrchar\\CYRF /g,""],[/\\cyrchar\\CYRH /g,""],[/\\cyrchar\\CYRC /g,""],[/\\cyrchar\\CYRCH /g,""],[/\\cyrchar\\CYRSH /g,""],[/\\cyrchar\\CYRSHCH /g,""],[/\\cyrchar\\CYRHRDSN /g,""],[/\\cyrchar\\CYRERY /g,""],[/\\cyrchar\\CYRSFTSN /g,""],[/\\cyrchar\\CYREREV /g,""],[/\\cyrchar\\CYRYU /g,""],[/\\cyrchar\\CYRYA /g,""],[/\\cyrchar\\cyra /g,""],[/\\cyrchar\\cyrb /g,""],[/\\cyrchar\\cyrv /g,""],[/\\cyrchar\\cyrg /g,""],[/\\cyrchar\\cyrd /g,""],[/\\cyrchar\\cyre /g,""],[/\\cyrchar\\cyrzh /g,""],[/\\cyrchar\\cyrz /g,""],[/\\cyrchar\\cyri /g,""],[/\\cyrchar\\cyrishrt /g,""],[/\\cyrchar\\cyrk /g,""],[/\\cyrchar\\cyrl /g,""],[/\\cyrchar\\cyrm /g,""],[/\\cyrchar\\cyrn /g,""],[/\\cyrchar\\cyro /g,""],[/\\cyrchar\\cyrp /g,""],[/\\cyrchar\\cyrr /g,""],[/\\cyrchar\\cyrs /g,""],[/\\cyrchar\\cyrt /g,""],[/\\cyrchar\\cyru /g,""],[/\\cyrchar\\cyrf /g,""],[/\\cyrchar\\cyrh /g,""],[/\\cyrchar\\cyrc /g,""],[/\\cyrchar\\cyrch /g,""],[/\\cyrchar\\cyrsh /g,""],[/\\cyrchar\\cyrshch /g,""],[/\\cyrchar\\cyrhrdsn /g,""],[/\\cyrchar\\cyrery /g,""],[/\\cyrchar\\cyrsftsn /g,""],[/\\cyrchar\\cyrerev /g,""],[/\\cyrchar\\cyryu /g,""],[/\\cyrchar\\cyrya /g,""],[/\\cyrchar\\cyryo /g,""],[/\\cyrchar\\cyrdje /g,""],[/\\cyrchar\{\\'\\cyrg\}/g,""],[/\\cyrchar\\cyrie /g,""],[/\\cyrchar\\cyrdze /g,""],[/\\cyrchar\\cyrii /g,""],[/\\cyrchar\\cyryi /g,""],[/\\cyrchar\\cyrje /g,""],[/\\cyrchar\\cyrlje /g,""],[/\\cyrchar\\cyrnje /g,""],[/\\cyrchar\\cyrtshe /g,""],[/\\cyrchar\{\\'\\cyrk\}/g,""],[/\\cyrchar\\cyrushrt /g,""],[/\\cyrchar\\cyrdzhe /g,""],[/\\cyrchar\\CYROMEGA /g,""],[/\\cyrchar\\cyromega /g,""],[/\\cyrchar\\CYRYAT /g,""],[/\\cyrchar\\CYRIOTE /g,""],[/\\cyrchar\\cyriote /g,""],[/\\cyrchar\\CYRLYUS /g,""],[/\\cyrchar\\cyrlyus /g,""],[/\\cyrchar\\CYRIOTLYUS /g,""],[/\\cyrchar\\cyriotlyus /g,""],[/\\cyrchar\\CYRBYUS /g,""],[/\\cyrchar\\CYRIOTBYUS /g,""],[/\\cyrchar\\cyriotbyus /g,""],[/\\cyrchar\\CYRKSI /g,""],[/\\cyrchar\\cyrksi /g,""],[/\\cyrchar\\CYRPSI /g,""],[/\\cyrchar\\cyrpsi /g,""],[/\\cyrchar\\CYRFITA /g,""],[/\\cyrchar\\CYRIZH /g,""],[/\\cyrchar\\CYRUK /g,""],[/\\cyrchar\\cyruk /g,""],[/\\cyrchar\\CYROMEGARND /g,""],[/\\cyrchar\\cyromegarnd /g,""],[/\\cyrchar\\CYROMEGATITLO /g,""],[/\\cyrchar\\cyromegatitlo /g,""],[/\\cyrchar\\CYROT /g,""],[/\\cyrchar\\cyrot /g,""],[/\\cyrchar\\CYRKOPPA /g,""],[/\\cyrchar\\cyrkoppa /g,""],[/\\cyrchar\\cyrthousands /g,""],[/\\cyrchar\\cyrhundredthousands /g,""],[/\\cyrchar\\cyrmillions /g,""],[/\\cyrchar\\CYRSEMISFTSN /g,""],[/\\cyrchar\\cyrsemisftsn /g,""],[/\\cyrchar\\CYRRTICK /g,""],[/\\cyrchar\\cyrrtick /g,""],[/\\cyrchar\\CYRGUP /g,""],[/\\cyrchar\\cyrgup /g,""],[/\\cyrchar\\CYRGHCRS /g,""],[/\\cyrchar\\cyrghcrs /g,""],[/\\cyrchar\\CYRGHK /g,""],[/\\cyrchar\\cyrghk /g,""],[/\\cyrchar\\CYRZHDSC /g,""],[/\\cyrchar\\cyrzhdsc /g,""],[/\\cyrchar\\CYRZDSC /g,""],[/\\cyrchar\\cyrzdsc /g,""],[/\\cyrchar\\CYRKDSC /g,""],[/\\cyrchar\\cyrkdsc /g,""],[/\\cyrchar\\CYRKVCRS /g,""],[/\\cyrchar\\cyrkvcrs /g,""],[/\\cyrchar\\CYRKHCRS /g,""],[/\\cyrchar\\cyrkhcrs /g,""],[/\\cyrchar\\CYRKBEAK /g,""],[/\\cyrchar\\cyrkbeak /g,""],[/\\cyrchar\\CYRNDSC /g,""],[/\\cyrchar\\cyrndsc /g,""],[/\\cyrchar\\CYRNG /g,""],[/\\cyrchar\\cyrng /g,""],[/\\cyrchar\\CYRPHK /g,""],[/\\cyrchar\\cyrphk /g,""],[/\\cyrchar\\CYRABHHA /g,""],[/\\cyrchar\\cyrabhha /g,""],[/\\cyrchar\\CYRSDSC /g,""],[/\\cyrchar\\cyrsdsc /g,""],[/\\cyrchar\\CYRTDSC /g,""],[/\\cyrchar\\cyrtdsc /g,""],[/\\cyrchar\\CYRY /g,""],[/\\cyrchar\\cyry /g,""],[/\\cyrchar\\CYRYHCRS /g,""],[/\\cyrchar\\cyryhcrs /g,""],[/\\cyrchar\\CYRHDSC /g,""],[/\\cyrchar\\cyrhdsc /g,""],[/\\cyrchar\\CYRTETSE /g,""],[/\\cyrchar\\cyrtetse /g,""],[/\\cyrchar\\CYRCHRDSC /g,""],[/\\cyrchar\\cyrchrdsc /g,""],[/\\cyrchar\\CYRCHVCRS /g,""],[/\\cyrchar\\cyrchvcrs /g,""],[/\\cyrchar\\CYRSHHA /g,""],[/\\cyrchar\\cyrshha /g,""],[/\\cyrchar\\CYRABHCH /g,""],[/\\cyrchar\\cyrabhch /g,""],[/\\cyrchar\\CYRABHCHDSC /g,""],[/\\cyrchar\\cyrabhchdsc /g,""],[/\\cyrchar\\CYRpalochka /g,""],[/\\cyrchar\\CYRKHK /g,""],[/\\cyrchar\\cyrkhk /g,""],[/\\cyrchar\\CYRNHK /g,""],[/\\cyrchar\\cyrnhk /g,""],[/\\cyrchar\\CYRCHLDSC /g,""],[/\\cyrchar\\cyrchldsc /g,""],[/\\cyrchar\\CYRAE /g,""],[/\\cyrchar\\cyrae /g,""],[/\\cyrchar\\CYRSCHWA /g,""],[/\\cyrchar\\cyrschwa /g,""],[/\\cyrchar\\CYRABHDZE /g,""],[/\\cyrchar\\cyrabhdze /g,""],[/\\cyrchar\\CYROTLD /g,""],[/\\cyrchar\\cyrotld /g,""],[/\\hspace\{0.6em\}/g,""],[/\\hspace\{1em\}/g,""],[/\\hspace\{0.33em\}/g,""],[/\\hspace\{0.25em\}/g,""],[/\\hspace\{0.166em\}/g,""],[/\\hphantom\{0\}/g,""],[/\\hphantom\{,\}/g,""],[/\\hspace\{0.167em\}/g,""],[/\\mkern1mu /g,""],[/\\textendash /g,""],[/\\textemdash /g,""],[/\\rule\{1em\}\{1pt\}/g,""],[/\\Vert /g,""],[/\\Elzreapos /g,""],[/\\textquotedblleft /g,""],[/\\textquotedblright /g,""],[/\\textdagger /g,""],[/\\textdaggerdbl /g,""],[/\\textbullet /g,""],[/\\ldots /g,""],[/\\textperthousand /g,""],[/\\textpertenthousand /g,""],[/\\backprime /g,""],[/\\guilsinglleft /g,""],[/\\guilsinglright /g,""],[/\\mkern4mu /g,""],[/\\nolinebreak /g,""],[/\\ensuremath\{\\Elzpes\}/g,""],[/\\mbox\{\\texteuro\} /g,""],[/\\dddot /g,""],[/\\ddddot /g,""],[/\\mathbb\{C\}/g,""],[/\\mathscr\{g\}/g,""],[/\\mathscr\{H\}/g,""],[/\\mathfrak\{H\}/g,""],[/\\mathbb\{H\}/g,""],[/\\hslash /g,""],[/\\mathscr\{I\}/g,""],[/\\mathfrak\{I\}/g,""],[/\\mathscr\{L\}/g,""],[/\\mathscr\{l\}/g,""],[/\\mathbb\{N\}/g,""],[/\\cyrchar\\textnumero /g,""],[/\\wp /g,""],[/\\mathbb\{P\}/g,""],[/\\mathbb\{Q\}/g,""],[/\\mathscr\{R\}/g,""],[/\\mathfrak\{R\}/g,""],[/\\mathbb\{R\}/g,""],[/\\Elzxrat /g,""],[/\\texttrademark /g,""],[/\\mathbb\{Z\}/g,""],[/\\Omega /g,""],[/\\mho /g,""],[/\\mathfrak\{Z\}/g,""],[/\\ElsevierGlyph\{2129\}/g,""],[/\\AA /g,""],[/\\mathscr\{B\}/g,""],[/\\mathfrak\{C\}/g,""],[/\\mathscr\{e\}/g,""],[/\\mathscr\{E\}/g,""],[/\\mathscr\{F\}/g,""],[/\\mathscr\{M\}/g,""],[/\\mathscr\{o\}/g,""],[/\\aleph /g,""],[/\\beth /g,""],[/\\gimel /g,""],[/\\daleth /g,""],[/\\textfrac\{1\}\{3\}/g,""],[/\\textfrac\{2\}\{3\}/g,""],[/\\textfrac\{1\}\{5\}/g,""],[/\\textfrac\{2\}\{5\}/g,""],[/\\textfrac\{3\}\{5\}/g,""],[/\\textfrac\{4\}\{5\}/g,""],[/\\textfrac\{1\}\{6\}/g,""],[/\\textfrac\{5\}\{6\}/g,""],[/\\textfrac\{1\}\{8\}/g,""],[/\\textfrac\{3\}\{8\}/g,""],[/\\textfrac\{5\}\{8\}/g,""],[/\\textfrac\{7\}\{8\}/g,""],[/\\leftarrow /g,""],[/\\uparrow /g,""],[/\\rightarrow /g,""],[/\\downarrow /g,""],[/\\leftrightarrow /g,""],[/\\updownarrow /g,""],[/\\nwarrow /g,""],[/\\nearrow /g,""],[/\\searrow /g,""],[/\\swarrow /g,""],[/\\nleftarrow /g,""],[/\\nrightarrow /g,""],[/\\arrowwaveright /g,""],[/\\arrowwaveright /g,""],[/\\twoheadleftarrow /g,""],[/\\twoheadrightarrow /g,""],[/\\leftarrowtail /g,""],[/\\rightarrowtail /g,""],[/\\mapsto /g,""],[/\\hookleftarrow /g,""],[/\\hookrightarrow /g,""],[/\\looparrowleft /g,""],[/\\looparrowright /g,""],[/\\leftrightsquigarrow /g,""],[/\\nleftrightarrow /g,""],[/\\Lsh /g,""],[/\\Rsh /g,""],[/\\ElsevierGlyph\{21B3\}/g,""],[/\\curvearrowleft /g,""],[/\\curvearrowright /g,""],[/\\circlearrowleft /g,""],[/\\circlearrowright /g,""],[/\\leftharpoonup /g,""],[/\\leftharpoondown /g,""],[/\\upharpoonright /g,""],[/\\upharpoonleft /g,""],[/\\rightharpoonup /g,""],[/\\rightharpoondown /g,""],[/\\downharpoonright /g,""],[/\\downharpoonleft /g,""],[/\\rightleftarrows /g,""],[/\\dblarrowupdown /g,""],[/\\leftrightarrows /g,""],[/\\leftleftarrows /g,""],[/\\upuparrows /g,""],[/\\rightrightarrows /g,""],[/\\downdownarrows /g,""],[/\\leftrightharpoons /g,""],[/\\rightleftharpoons /g,""],[/\\nLeftarrow /g,""],[/\\nLeftrightarrow /g,""],[/\\nRightarrow /g,""],[/\\Leftarrow /g,""],[/\\Uparrow /g,""],[/\\Rightarrow /g,""],[/\\Downarrow /g,""],[/\\Leftrightarrow /g,""],[/\\Updownarrow /g,""],[/\\Lleftarrow /g,""],[/\\Rrightarrow /g,""],[/\\rightsquigarrow /g,""],[/\\DownArrowUpArrow /g,""],[/\\forall /g,""],[/\\complement /g,""],[/\\partial /g,""],[/\\exists /g,""],[/\\nexists /g,""],[/\\varnothing /g,""],[/\\nabla /g,""],[/\\in /g,""],[/\\not\\in /g,""],[/\\ni /g,""],[/\\not\\ni /g,""],[/\\prod /g,""],[/\\coprod /g,""],[/\\sum /g,""],[/\\mp /g,""],[/\\dotplus /g,""],[/\\setminus /g,""],[/\\circ /g,""],[/\\bullet /g,""],[/\\surd /g,""],[/\\propto /g,""],[/\\infty /g,""],[/\\rightangle /g,""],[/\\angle /g,""],[/\\measuredangle /g,""],[/\\sphericalangle /g,""],[/\\mid /g,""],[/\\nmid /g,""],[/\\parallel /g,""],[/\\nparallel /g,""],[/\\wedge /g,""],[/\\vee /g,""],[/\\cap /g,""],[/\\cup /g,""],[/\\int /g,""],[/\\int\\!\\int /g,""],[/\\int\\!\\int\\!\\int /g,""],[/\\oint /g,""],[/\\surfintegral /g,""],[/\\volintegral /g,""],[/\\clwintegral /g,""],[/\\ElsevierGlyph\{2232\}/g,""],[/\\ElsevierGlyph\{2233\}/g,""],[/\\therefore /g,""],[/\\because /g,""],[/\\Colon /g,""],[/\\ElsevierGlyph\{2238\}/g,""],[/\\mathbin\{\{:\}\\!\\!\{\-\}\\!\\!\{:\}\}/g,""],[/\\homothetic /g,""],[/\\sim /g,""],[/\\backsim /g,""],[/\\lazysinv /g,""],[/\\wr /g,""],[/\\not\\sim /g,""],[/\\ElsevierGlyph\{2242\}/g,""],[/\\NotEqualTilde /g,"-00338"],[/\\simeq /g,""],[/\\not\\simeq /g,""],[/\\cong /g,""],[/\\approxnotequal /g,""],[/\\not\\cong /g,""],[/\\approx /g,""],[/\\not\\approx /g,""],[/\\approxeq /g,""],[/\\tildetrpl /g,""],[/\\not\\apid /g,"-00338"],[/\\allequal /g,""],[/\\asymp /g,""],[/\\Bumpeq /g,""],[/\\NotHumpDownHump /g,"-00338"],[/\\bumpeq /g,""],[/\\NotHumpEqual /g,"-00338"],[/\\doteq /g,""],[/\\not\\doteq/g,"-00338"],[/\\doteqdot /g,""],[/\\fallingdotseq /g,""],[/\\risingdotseq /g,""],[/\\eqcirc /g,""],[/\\circeq /g,""],[/\\estimates /g,""],[/\\ElsevierGlyph\{225A\}/g,""],[/\\starequal /g,""],[/\\triangleq /g,""],[/\\ElsevierGlyph\{225F\}/g,""],[/\\not =/g,""],[/\\equiv /g,""],[/\\not\\equiv /g,""],[/\\leq /g,""],[/\\geq /g,""],[/\\leqq /g,""],[/\\geqq /g,""],[/\\lneqq /g,""],[/\\lvertneqq /g,"-0FE00"],[/\\gneqq /g,""],[/\\gvertneqq /g,"-0FE00"],[/\\ll /g,""],[/\\NotLessLess /g,"-00338"],[/\\gg /g,""],[/\\NotGreaterGreater /g,"-00338"],[/\\between /g,""],[/\\not\\kern\-0.3em\\times /g,""],[/\\not</g,""],[/\\not>/g,""],[/\\not\\leq /g,""],[/\\not\\geq /g,""],[/\\lessequivlnt /g,""],[/\\greaterequivlnt /g,""],[/\\ElsevierGlyph\{2274\}/g,""],[/\\ElsevierGlyph\{2275\}/g,""],[/\\lessgtr /g,""],[/\\gtrless /g,""],[/\\notlessgreater /g,""],[/\\notgreaterless /g,""],[/\\prec /g,""],[/\\succ /g,""],[/\\preccurlyeq /g,""],[/\\succcurlyeq /g,""],[/\\precapprox /g,""],[/\\NotPrecedesTilde /g,"-00338"],[/\\succapprox /g,""],[/\\NotSucceedsTilde /g,"-00338"],[/\\not\\prec /g,""],[/\\not\\succ /g,""],[/\\subset /g,""],[/\\supset /g,""],[/\\not\\subset /g,""],[/\\not\\supset /g,""],[/\\subseteq /g,""],[/\\supseteq /g,""],[/\\not\\subseteq /g,""],[/\\not\\supseteq /g,""],[/\\subsetneq /g,""],[/\\varsubsetneqq /g,"-0FE00"],[/\\supsetneq /g,""],[/\\varsupsetneq /g,"-0FE00"],[/\\uplus /g,""],[/\\sqsubset /g,""],[/\\NotSquareSubset /g,"-00338"],[/\\sqsupset /g,""],[/\\NotSquareSuperset /g,"-00338"],[/\\sqsubseteq /g,""],[/\\sqsupseteq /g,""],[/\\sqcap /g,""],[/\\sqcup /g,""],[/\\oplus /g,""],[/\\ominus /g,""],[/\\otimes /g,""],[/\\oslash /g,""],[/\\odot /g,""],[/\\circledcirc /g,""],[/\\circledast /g,""],[/\\circleddash /g,""],[/\\boxplus /g,""],[/\\boxminus /g,""],[/\\boxtimes /g,""],[/\\boxdot /g,""],[/\\vdash /g,""],[/\\dashv /g,""],[/\\top /g,""],[/\\perp /g,""],[/\\truestate /g,""],[/\\forcesextra /g,""],[/\\Vdash /g,""],[/\\Vvdash /g,""],[/\\VDash /g,""],[/\\nvdash /g,""],[/\\nvDash /g,""],[/\\nVdash /g,""],[/\\nVDash /g,""],[/\\vartriangleleft /g,""],[/\\vartriangleright /g,""],[/\\trianglelefteq /g,""],[/\\trianglerighteq /g,""],[/\\original /g,""],[/\\image /g,""],[/\\multimap /g,""],[/\\hermitconjmatrix /g,""],[/\\intercal /g,""],[/\\veebar /g,""],[/\\rightanglearc /g,""],[/\\ElsevierGlyph\{22C0\}/g,""],[/\\ElsevierGlyph\{22C1\}/g,""],[/\\bigcap /g,""],[/\\bigcup /g,""],[/\\diamond /g,""],[/\\cdot /g,""],[/\\star /g,""],[/\\divideontimes /g,""],[/\\bowtie /g,""],[/\\ltimes /g,""],[/\\rtimes /g,""],[/\\leftthreetimes /g,""],[/\\rightthreetimes /g,""],[/\\backsimeq /g,""],[/\\curlyvee /g,""],[/\\curlywedge /g,""],[/\\Subset /g,""],[/\\Supset /g,""],[/\\Cap /g,""],[/\\Cup /g,""],[/\\pitchfork /g,""],[/\\lessdot /g,""],[/\\gtrdot /g,""],[/\\verymuchless /g,""],[/\\verymuchgreater /g,""],[/\\lesseqgtr /g,""],[/\\gtreqless /g,""],[/\\curlyeqprec /g,""],[/\\curlyeqsucc /g,""],[/\\not\\sqsubseteq /g,""],[/\\not\\sqsupseteq /g,""],[/\\Elzsqspne /g,""],[/\\lnsim /g,""],[/\\gnsim /g,""],[/\\precedesnotsimilar /g,""],[/\\succnsim /g,""],[/\\ntriangleleft /g,""],[/\\ntriangleright /g,""],[/\\ntrianglelefteq /g,""],[/\\ntrianglerighteq /g,""],[/\\vdots /g,""],[/\\cdots /g,""],[/\\upslopeellipsis /g,""],[/\\downslopeellipsis /g,""],[/\\barwedge /g,""],[/\\perspcorrespond /g,""],[/\\lceil /g,""],[/\\rceil /g,""],[/\\lfloor /g,""],[/\\rfloor /g,""],[/\\recorder /g,""],[/\\mathchar"2208/g,""],[/\\ulcorner /g,""],[/\\urcorner /g,""],[/\\llcorner /g,""],[/\\lrcorner /g,""],[/\\frown /g,""],[/\\smile /g,""],[/\\langle /g,""],[/\\rangle /g,""],[/\\ElsevierGlyph\{E838\}/g,""],[/\\Elzdlcorn /g,""],[/\\lmoustache /g,""],[/\\rmoustache /g,""],[/\\textvisiblespace /g,""],[/\\ding\{172\}/g,""],[/\\ding\{173\}/g,""],[/\\ding\{174\}/g,""],[/\\ding\{175\}/g,""],[/\\ding\{176\}/g,""],[/\\ding\{177\}/g,""],[/\\ding\{178\}/g,""],[/\\ding\{179\}/g,""],[/\\ding\{180\}/g,""],[/\\ding\{181\}/g,""],[/\\circledS /g,""],[/\\Elzdshfnc /g,""],[/\\Elzsqfnw /g,""],[/\\diagup /g,""],[/\\ding\{110\}/g,""],[/\\square /g,""],[/\\blacksquare /g,""],[/\\fbox\{~~\}/g,""],[/\\Elzvrecto /g,""],[/\\ElsevierGlyph\{E381\}/g,""],[/\\ding\{115\}/g,""],[/\\bigtriangleup /g,""],[/\\blacktriangle /g,""],[/\\vartriangle /g,""],[/\\blacktriangleright /g,""],[/\\triangleright /g,""],[/\\ding\{116\}/g,""],[/\\bigtriangledown /g,""],[/\\blacktriangledown /g,""],[/\\triangledown /g,""],[/\\blacktriangleleft /g,""],[/\\triangleleft /g,""],[/\\ding\{117\}/g,""],[/\\lozenge /g,""],[/\\bigcirc /g,""],[/\\ding\{108\}/g,""],[/\\Elzcirfl /g,""],[/\\Elzcirfr /g,""],[/\\Elzcirfb /g,""],[/\\ding\{119\}/g,""],[/\\Elzrvbull /g,""],[/\\Elzsqfl /g,""],[/\\Elzsqfr /g,""],[/\\Elzsqfse /g,""],[/\\bigcirc /g,""],[/\\ding\{72\}/g,""],[/\\ding\{73\}/g,""],[/\\ding\{37\}/g,""],[/\\ding\{42\}/g,""],[/\\ding\{43\}/g,""],[/\\rightmoon /g,""],[/\\mercury /g,""],[/\\venus /g,""],[/\\male /g,""],[/\\jupiter /g,""],[/\\saturn /g,""],[/\\uranus /g,""],[/\\neptune /g,""],[/\\pluto /g,""],[/\\aries /g,""],[/\\taurus /g,""],[/\\gemini /g,""],[/\\cancer /g,""],[/\\leo /g,""],[/\\virgo /g,""],[/\\libra /g,""],[/\\scorpio /g,""],[/\\sagittarius /g,""],[/\\capricornus /g,""],[/\\aquarius /g,""],[/\\pisces /g,""],[/\\ding\{171\}/g,""],[/\\diamond /g,""],[/\\ding\{168\}/g,""],[/\\ding\{170\}/g,""],[/\\ding\{169\}/g,""],[/\\quarternote /g,""],[/\\eighthnote /g,""],[/\\flat /g,""],[/\\natural /g,""],[/\\sharp /g,""],[/\\ding\{33\}/g,""],[/\\ding\{34\}/g,""],[/\\ding\{35\}/g,""],[/\\ding\{36\}/g,""],[/\\ding\{38\}/g,""],[/\\ding\{39\}/g,""],[/\\ding\{40\}/g,""],[/\\ding\{41\}/g,""],[/\\ding\{44\}/g,""],[/\\ding\{45\}/g,""],[/\\ding\{46\}/g,""],[/\\ding\{47\}/g,""],[/\\ding\{48\}/g,""],[/\\ding\{49\}/g,""],[/\\ding\{50\}/g,""],[/\\ding\{51\}/g,""],[/\\ding\{52\}/g,""],[/\\ding\{53\}/g,""],[/\\ding\{54\}/g,""],[/\\ding\{55\}/g,""],[/\\ding\{56\}/g,""],[/\\ding\{57\}/g,""],[/\\ding\{58\}/g,""],[/\\ding\{59\}/g,""],[/\\ding\{60\}/g,""],[/\\ding\{61\}/g,""],[/\\ding\{62\}/g,""],[/\\ding\{63\}/g,""],[/\\ding\{64\}/g,""],[/\\ding\{65\}/g,""],[/\\ding\{66\}/g,""],[/\\ding\{67\}/g,""],[/\\ding\{68\}/g,""],[/\\ding\{69\}/g,""],[/\\ding\{70\}/g,""],[/\\ding\{71\}/g,""],[/\\ding\{73\}/g,""],[/\\ding\{74\}/g,""],[/\\ding\{75\}/g,""],[/\\ding\{76\}/g,""],[/\\ding\{77\}/g,""],[/\\ding\{78\}/g,""],[/\\ding\{79\}/g,""],[/\\ding\{80\}/g,""],[/\\ding\{81\}/g,""],[/\\ding\{82\}/g,""],[/\\ding\{83\}/g,""],[/\\ding\{84\}/g,""],[/\\ding\{85\}/g,""],[/\\ding\{86\}/g,""],[/\\ding\{87\}/g,""],[/\\ding\{88\}/g,""],[/\\ding\{89\}/g,""],[/\\ding\{90\}/g,""],[/\\ding\{91\}/g,""],[/\\ding\{92\}/g,""],[/\\ding\{93\}/g,""],[/\\ding\{94\}/g,""],[/\\ding\{95\}/g,""],[/\\ding\{96\}/g,""],[/\\ding\{97\}/g,""],[/\\ding\{98\}/g,""],[/\\ding\{99\}/g,""],[/\\ding\{100\}/g,""],[/\\ding\{101\}/g,""],[/\\ding\{102\}/g,""],[/\\ding\{103\}/g,""],[/\\ding\{104\}/g,""],[/\\ding\{105\}/g,""],[/\\ding\{106\}/g,""],[/\\ding\{107\}/g,""],[/\\ding\{109\}/g,""],[/\\ding\{111\}/g,""],[/\\ding\{112\}/g,""],[/\\ding\{113\}/g,""],[/\\ding\{114\}/g,""],[/\\ding\{118\}/g,""],[/\\ding\{120\}/g,""],[/\\ding\{121\}/g,""],[/\\ding\{122\}/g,""],[/\\ding\{123\}/g,""],[/\\ding\{124\}/g,""],[/\\ding\{125\}/g,""],[/\\ding\{126\}/g,""],[/\\ding\{161\}/g,""],[/\\ding\{162\}/g,""],[/\\ding\{163\}/g,""],[/\\ding\{164\}/g,""],[/\\ding\{165\}/g,""],[/\\ding\{166\}/g,""],[/\\ding\{167\}/g,""],[/\\ding\{182\}/g,""],[/\\ding\{183\}/g,""],[/\\ding\{184\}/g,""],[/\\ding\{185\}/g,""],[/\\ding\{186\}/g,""],[/\\ding\{187\}/g,""],[/\\ding\{188\}/g,""],[/\\ding\{189\}/g,""],[/\\ding\{190\}/g,""],[/\\ding\{191\}/g,""],[/\\ding\{192\}/g,""],[/\\ding\{193\}/g,""],[/\\ding\{194\}/g,""],[/\\ding\{195\}/g,""],[/\\ding\{196\}/g,""],[/\\ding\{197\}/g,""],[/\\ding\{198\}/g,""],[/\\ding\{199\}/g,""],[/\\ding\{200\}/g,""],[/\\ding\{201\}/g,""],[/\\ding\{202\}/g,""],[/\\ding\{203\}/g,""],[/\\ding\{204\}/g,""],[/\\ding\{205\}/g,""],[/\\ding\{206\}/g,""],[/\\ding\{207\}/g,""],[/\\ding\{208\}/g,""],[/\\ding\{209\}/g,""],[/\\ding\{210\}/g,""],[/\\ding\{211\}/g,""],[/\\ding\{212\}/g,""],[/\\ding\{216\}/g,""],[/\\ding\{217\}/g,""],[/\\ding\{218\}/g,""],[/\\ding\{219\}/g,""],[/\\ding\{220\}/g,""],[/\\ding\{221\}/g,""],[/\\ding\{222\}/g,""],[/\\ding\{223\}/g,""],[/\\ding\{224\}/g,""],[/\\ding\{225\}/g,""],[/\\ding\{226\}/g,""],[/\\ding\{227\}/g,""],[/\\ding\{228\}/g,""],[/\\ding\{229\}/g,""],[/\\ding\{230\}/g,""],[/\\ding\{231\}/g,""],[/\\ding\{232\}/g,""],[/\\ding\{233\}/g,""],[/\\ding\{234\}/g,""],[/\\ding\{235\}/g,""],[/\\ding\{236\}/g,""],[/\\ding\{237\}/g,""],[/\\ding\{238\}/g,""],[/\\ding\{239\}/g,""],[/\\ding\{241\}/g,""],[/\\ding\{242\}/g,""],[/\\ding\{243\}/g,""],[/\\ding\{244\}/g,""],[/\\ding\{245\}/g,""],[/\\ding\{246\}/g,""],[/\\ding\{247\}/g,""],[/\\ding\{248\}/g,""],[/\\ding\{249\}/g,""],[/\\ding\{250\}/g,""],[/\\ding\{251\}/g,""],[/\\ding\{252\}/g,""],[/\\ding\{253\}/g,""],[/\\ding\{254\}/g,""],[/\\longleftarrow /g,""],[/\\longrightarrow /g,""],[/\\longleftrightarrow /g,""],[/\\Longleftarrow /g,""],[/\\Longrightarrow /g,""],[/\\Longleftrightarrow /g,""],[/\\longmapsto /g,""],[/\\sim\\joinrel\\leadsto/g,""],[/\\ElsevierGlyph\{E212\}/g,""],[/\\UpArrowBar /g,""],[/\\DownArrowBar /g,""],[/\\ElsevierGlyph\{E20C\}/g,""],[/\\ElsevierGlyph\{E20D\}/g,""],[/\\ElsevierGlyph\{E20B\}/g,""],[/\\ElsevierGlyph\{E20A\}/g,""],[/\\ElsevierGlyph\{E211\}/g,""],[/\\ElsevierGlyph\{E20E\}/g,""],[/\\ElsevierGlyph\{E20F\}/g,""],[/\\ElsevierGlyph\{E210\}/g,""],[/\\ElsevierGlyph\{E21C\}/g,""],[/\\ElsevierGlyph\{E21D\}/g,"-00338"],[/\\ElsevierGlyph\{E21A\}/g,""],[/\\ElsevierGlyph\{E219\}/g,""],[/\\Elolarr /g,""],[/\\Elorarr /g,""],[/\\ElzRlarr /g,""],[/\\ElzrLarr /g,""],[/\\Elzrarrx /g,""],[/\\LeftRightVector /g,""],[/\\RightUpDownVector /g,""],[/\\DownLeftRightVector /g,""],[/\\LeftUpDownVector /g,""],[/\\LeftVectorBar /g,""],[/\\RightVectorBar /g,""],[/\\RightUpVectorBar /g,""],[/\\RightDownVectorBar /g,""],[/\\DownLeftVectorBar /g,""],[/\\DownRightVectorBar /g,""],[/\\LeftUpVectorBar /g,""],[/\\LeftDownVectorBar /g,""],[/\\LeftTeeVector /g,""],[/\\RightTeeVector /g,""],[/\\RightUpTeeVector /g,""],[/\\RightDownTeeVector /g,""],[/\\DownLeftTeeVector /g,""],[/\\DownRightTeeVector /g,""],[/\\LeftUpTeeVector /g,""],[/\\LeftDownTeeVector /g,""],[/\\UpEquilibrium /g,""],[/\\ReverseUpEquilibrium /g,""],[/\\RoundImplies /g,""],[/\\ElsevierGlyph\{E214\}/g,""],[/\\ElsevierGlyph\{E215\}/g,""],[/\\Elztfnc /g,""],[/\\ElsevierGlyph\{3018\}/g,""],[/\\Elroang /g,""],[/\\ElsevierGlyph\{E291\}/g,""],[/\\Elzddfnc /g,""],[/\\Angle /g,""],[/\\Elzlpargt /g,""],[/\\ElsevierGlyph\{E260\}/g,""],[/\\ElsevierGlyph\{E61B\}/g,""],[/\\ElzLap /g,""],[/\\Elzdefas /g,""],[/\\LeftTriangleBar /g,""],[/\\NotLeftTriangleBar /g,"-00338"],[/\\RightTriangleBar /g,""],[/\\NotRightTriangleBar /g,"-00338"],[/\\ElsevierGlyph\{E372\}/g,""],[/\\blacklozenge /g,""],[/\\RuleDelayed /g,""],[/\\Elxuplus /g,""],[/\\ElzThr /g,""],[/\\Elxsqcup /g,""],[/\\ElzInf /g,""],[/\\ElzSup /g,""],[/\\ElzCint /g,""],[/\\clockoint /g,""],[/\\ElsevierGlyph\{E395\}/g,""],[/\\sqrint /g,""],[/\\ElsevierGlyph\{E25A\}/g,""],[/\\ElsevierGlyph\{E25B\}/g,""],[/\\ElsevierGlyph\{E25C\}/g,""],[/\\ElsevierGlyph\{E25D\}/g,""],[/\\ElzTimes /g,""],[/\\ElsevierGlyph\{E25E\}/g,""],[/\\ElsevierGlyph\{E25E\}/g,""],[/\\ElsevierGlyph\{E259\}/g,""],[/\\amalg /g,""],[/\\ElzAnd /g,""],[/\\ElzOr /g,""],[/\\ElsevierGlyph\{E36E\}/g,""],[/\\ElOr /g,""],[/\\perspcorrespond /g,""],[/\\Elzminhat /g,""],[/\\ElsevierGlyph\{225A\}/g,""],[/\\stackrel\{*\}\{=\}/g,""],[/\\Equal /g,""],[/\\leqslant /g,""],[/\\nleqslant /g,"-00338"],[/\\geqslant /g,""],[/\\ngeqslant /g,"-00338"],[/\\lessapprox /g,""],[/\\gtrapprox /g,""],[/\\lneq /g,""],[/\\gneq /g,""],[/\\lnapprox /g,""],[/\\gnapprox /g,""],[/\\lesseqqgtr /g,""],[/\\gtreqqless /g,""],[/\\eqslantless /g,""],[/\\eqslantgtr /g,""],[/\\Pisymbol\{ppi020\}\{117\}/g,""],[/\\Pisymbol\{ppi020\}\{105\}/g,""],[/\\NestedLessLess /g,""],[/\\NotNestedLessLess /g,"-00338"],[/\\NestedGreaterGreater /g,""],[/\\NotNestedGreaterGreater /g,"-00338"],[/\\preceq /g,""],[/\\not\\preceq /g,"-00338"],[/\\succeq /g,""],[/\\not\\succeq /g,"-00338"],[/\\precneqq /g,""],[/\\succneqq /g,""],[/\\precapprox /g,""],[/\\succapprox /g,""],[/\\precnapprox /g,""],[/\\succnapprox /g,""],[/\\subseteqq /g,""],[/\\nsubseteqq /g,"-00338"],[/\\supseteqq /g,""],[/\\nsupseteqq/g,"-00338"],[/\\subsetneqq /g,""],[/\\supsetneqq /g,""],[/\\ElsevierGlyph\{E30D\}/g,""],[/\\Elztdcol /g,""],[/\\ElsevierGlyph\{300A\}/g,""],[/\\ElsevierGlyph\{300B\}/g,""],[/\\ElsevierGlyph\{3018\}/g,""],[/\\ElsevierGlyph\{3019\}/g,""],[/\\openbracketleft /g,""],[/\\openbracketright /g,""]],
this}"undefined"!=typeof t&&t.exports&&(t.exports=i)},function(t,e,i){var n,s;(function(a){n=[i(6),i(18),i(5)],s=function(t,e,i){var n=a.View.extend({tagName:"div",className:"citations",render:function(){return this.$el.append("<p>"+this.formattedReference()+"</p>"),this},formattedReference:function(){var t=this.model,e=t.entryType(),i=t.fields(),n="",s=this._asSentence((i.author?i.author:"")+(i.year?" ("+i.year+")":""))+" ",a=i.title||"",o=i.pages?"pp. "+i.pages:"",l=i.address;if("article"==e){var r=(i.volume?i.volume:"")+(i.number?" ("+i.number+")":"")+(o?", "+o:"");n=s+this._asSentence(a)+(i.journal?"In <em>"+i.journal+", ":"")+this._asSentence(r)+this._asSentence(i.address)+"</em>"}else n="inproceedings"==e||"proceedings"==e?s+this._asSentence(a)+(i.booktitle?"In <em>"+i.booktitle+", ":"")+(o?o:"")+(l?", "+l:"")+".</em>":"mastersthesis"==e||"phdthesis"==e?s+this._asSentence(a)+(i.howpublished?i.howpublished+". ":"")+(i.note?i.note+".":""):"techreport"==e?s+this._asSentence(a)+this._asSentence(i.institution)+this._asSentence(i.number)+this._asSentence(i.type):"book"==e||"inbook"==e||"incollection"==e?s+" "+this._formatBookInfo(i):s+" "+this._asSentence(a)+this._asSentence(i.howpublished)+this._asSentence(i.note);var c="";i.doi&&(c="http://dx.doi.org/"+i.doi,n+='[<a href="'+c+'" target="_blank">doi:'+i.doi+"</a>]");var d=i.url||c;return d&&(n+='[<a href="'+d+'" target="_blank">Link</a>]'),n},_formatBookInfo:function(t){var e="";return t.chapter&&(e+=t.chapter+" in "),t.title&&(e+="<em>"+t.title+"</em>"),t.editor&&(e+=", Edited by "+t.editor+", "),t.publisher&&(e+=", "+t.publisher),t.pages&&(e+=", pp. "+t.pages),t.series&&(e+=", <em>"+t.series+"</em>"),t.volume&&(e+=", Vol."+t.volume),t.issn&&(e+=", ISBN: "+t.issn),e+"."},_asSentence:function(t){return t&&t.trim()?t+". ":""}}),s=a.View.extend({el:"#citations",initialize:function(){this.listenTo(this.collection,"add",this.renderCitation)},events:{"click .citations-to-bibtex":"showBibtex","click .citations-to-formatted":"showFormatted"},renderCitation:function(t){var e=new n({model:t});this.$(".citations-formatted").append(e.render().el);var i=this.$(".citations-bibtex-text");i.val(i.val()+"\n\r"+t.attributes.content)},render:function(){this.$el.html(this.citationsElement()),this.collection.each(function(t){this.renderCitation(t)},this),this.showFormatted()},showBibtex:function(){this.$(".citations-to-formatted").show(),this.$(".citations-to-bibtex").hide(),this.$(".citations-bibtex").show(),this.$(".citations-formatted").hide(),this.$(".citations-bibtex-text").select()},showFormatted:function(){this.$(".citations-to-formatted").hide(),this.$(".citations-to-bibtex").show(),this.$(".citations-bibtex").hide(),this.$(".citations-formatted").show()},partialWarningElement:function(){return this.collection.partial?['<div style="padding:5px 10px">',"<b>Warning: This is a experimental feature.</b> Most Galaxy tools will not annotate"," citations explicitly at this time. When writing up your analysis, please manually"," review your histories and find all references"," that should be cited in order to completely describe your work. Also, please remember to",' <a href="https://wiki.galaxyproject.org/CitingGalaxy">cite Galaxy</a>.',"</div>"].join(""):""},citationsElement:function(){return['<div class="toolForm">','<div class="toolFormTitle">',i("Citations"),' <button type="button" class="btn btn-xs citations-to-bibtex" title="Show all in BibTeX format."><i class="fa fa-pencil-square-o"></i> Show BibTeX</button>',' <button type="button" class="btn btn-xs citations-to-formatted" title="Return to formatted citation list."><i class="fa fa-times"></i> Hide BibTeX</button>',"</div>",'<div class="toolFormBody" style="padding:5px 10px">',this.partialWarningElement(),'<span class="citations-formatted" style="word-wrap: break-word;"></span>',"</div>",'<div class="citations-bibtex toolFormBody" style="padding:5px 10px">','<textarea style="width: 100%; height: 500px;" class="citations-bibtex-text"></textarea>',"</div>","</div>"].join("")}});return{CitationView:n,CitationListView:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3))},function(t,e,i){var n,s;(function(a,o,l){n=[i(42),i(32),i(6),i(5)],s=function(t,e,i,n){"use strict";var s=t.FoldoutListItemView,r=t.ListItemView,c=s.extend({className:s.prototype.className+" dataset-collection",id:function(){return["dataset_collection",this.model.get("id")].join("-")},initialize:function(t){this.linkTarget=t.linkTarget||"_blank",this.hasUser=t.hasUser,s.prototype.initialize.call(this,t)},_setUpListeners:function(){s.prototype._setUpListeners.call(this),this.listenTo(this.model,"change",function(t,e){a.has(t.changed,"deleted")?this.render():a.has(t.changed,"element_count")&&this.$("> .title-bar .subtitle").replaceWith(this._renderSubtitle())})},_renderSubtitle:function(){return o(this.templates.subtitle(this.model.toJSON(),this))},_getFoldoutPanelOptions:function(){var t=s.prototype._getFoldoutPanelOptions.call(this);return a.extend(t,{linkTarget:this.linkTarget,hasUser:this.hasUser})},$selector:function(){return this.$("> .selector")},toString:function(){var t=this.model?this.model+"":"(no model)";return"DCListItemView("+t+")"}});c.prototype.templates=function(){var t=a.extend({},s.prototype.templates.warnings,{error:i.wrapTemplate(["<% if( model.error ){ %>",'<div class="errormessagesmall">',n("There was an error getting the data for this collection"),": <%- model.error %>","</div>","<% } %>"]),purged:i.wrapTemplate(["<% if( model.purged ){ %>",'<div class="purged-msg warningmessagesmall">',n("This collection has been deleted and removed from disk"),"</div>","<% } %>"]),deleted:i.wrapTemplate(["<% if( model.deleted && !model.purged ){ %>",'<div class="deleted-msg warningmessagesmall">',n("This collection has been deleted"),"</div>","<% } %>"])}),e=i.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<div class="title">','<span class="name"><%- collection.element_identifier || collection.name %></span>',"</div>",'<div class="subtitle"></div>',"</div>"],"collection"),o=i.wrapTemplate(['<div class="subtitle">','<% var countText = collection.element_count? ( collection.element_count + " " ) : ""; %>','<%        if( collection.collection_type === "list" ){ %>',n("a list of <%- countText %>datasets"),'<% } else if( collection.collection_type === "paired" ){ %>',n("a pair of datasets"),'<% } else if( collection.collection_type === "list:paired" ){ %>',n("a list of <%- countText %>dataset pairs"),'<% } else if( collection.collection_type === "list:list" ){ %>',n("a list of <%- countText %>dataset lists"),"<% } %>","</div>"],"collection");return a.extend({},s.prototype.templates,{warnings:t,titleBar:e,subtitle:o})}();var d=r.extend({className:r.prototype.className+" dataset-collection-element",initialize:function(t){t.logger&&(this.logger=this.model.logger=t.logger),this.log("DCEListItemView.initialize:",t),r.prototype.initialize.call(this,t)},toString:function(){var t=this.model?this.model+"":"(no model)";return"DCEListItemView("+t+")"}});d.prototype.templates=function(){var t=i.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<div class="title">','<span class="name"><%- element.element_identifier %></span>',"</div>",'<div class="subtitle"></div>',"</div>"],"element");return a.extend({},r.prototype.templates,{titleBar:t})}();var h=e.DatasetListItemView.extend({className:e.DatasetListItemView.prototype.className+" dataset-collection-element",initialize:function(t){t.logger&&(this.logger=this.model.logger=t.logger),this.log("DatasetDCEListItemView.initialize:",t),e.DatasetListItemView.prototype.initialize.call(this,t)},_fetchModelDetails:function(){var t=this;return t.model.inReadyState()&&!t.model.hasDetails()?t.model.fetch({silent:!0}):l.when()},toString:function(){var t=this.model?this.model+"":"(no model)";return"DatasetDCEListItemView("+t+")"}});h.prototype.templates=function(){var t=i.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<span class="state-icon"></span>','<div class="title">','<span class="name"><%- element.element_identifier %></span>',"</div>","</div>"],"element");return a.extend({},e.DatasetListItemView.prototype.templates,{titleBar:t})}();var u=c.extend({className:c.prototype.className+" dataset-collection-element",_swapNewRender:function(t){c.prototype._swapNewRender.call(this,t);var e=this.model.get("state")||"ok";return this.$el.addClass("state-"+e),this.$el},toString:function(){var t=this.model?this.model+"":"(no model)";return"NestedDCDCEListItemView("+t+")"}});return{DCListItemView:c,DCEListItemView:d,DatasetDCEListItemView:h,NestedDCDCEListItemView:u}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(2),i(1),i(1))},function(t,e,i){var n,s;(function(a,o,l){n=[i(71),i(6),i(5)],s=function(t,e,i){"use strict";var n="collections",s={defaults:{model_class:"DatasetCollectionElement",element_identifier:null,element_index:null,element_type:null},_mergeObject:function(t){return a.extend(t,t.object,{element_id:t.id}),delete t.object,t},constructor:function(t,e){t=this._mergeObject(t),this.idAttribute="element_id",o.Model.apply(this,arguments)},parse:function(t,e){var i=t;return i=this._mergeObject(i)}},r=o.Model.extend(e.LoggableMixin).extend(s).extend({_logNamespace:n}),c=o.Collection.extend(e.LoggableMixin).extend({_logNamespace:n,model:r,initialize:function(t,e){this.debug(this+"(DCECollection).initialize:",t,e),e=e||{}},toString:function(){return["DatasetCollectionElementCollection(",this.length,")"].join("")}}),d=t.DatasetAssociation.extend(e.mixin(s,{url:function(){return this.has("history_id")?Galaxy.root+"api/histories/"+this.get("history_id")+"/contents/"+this.get("id"):(console.warn("no endpoint for non-hdas within a collection yet"),Galaxy.root+"api/datasets")},defaults:a.extend({},t.DatasetAssociation.prototype.defaults,s.defaults),constructor:function(t,e){this.debug("\t DatasetDCE.constructor:",t,e),s.constructor.call(this,t,e)},initialize:function(e,i){this.debug(this+"(DatasetDCE).initialize:",e,i),t.DatasetAssociation.prototype.initialize.call(this,e,i)},hasDetails:function(){return a.has(this.attributes,"annotation")},toString:function(){var t=this.get("element_identifier");return["DatasetDCE(",t,")"].join("")}})),h=c.extend({model:d,initialize:function(t,e){this.debug(this+"(DatasetDCECollection).initialize:",t,e),c.prototype.initialize.call(this,t,e)},toString:function(){return["DatasetDCECollection(",this.length,")"].join("")}}),u=o.Model.extend(e.LoggableMixin).extend(e.SearchableModelMixin).extend({_logNamespace:n,defaults:{collection_type:null,deleted:!1},collectionClass:c,initialize:function(t,e){this.debug(this+"(DatasetCollection).initialize:",t,e,this),this.elements=this._createElementsModel(),this.on("change:elements",function(){this.log("change:elements"),this.elements=this._createElementsModel()})},_createElementsModel:function(){this.debug(this+"._createElementsModel",this.collectionClass,this.get("elements"),this.elements);var t=this.get("elements")||[];return this.unset("elements",{silent:!0}),this.elements=new this.collectionClass(t),this.elements},toJSON:function(){var t=o.Model.prototype.toJSON.call(this);return this.elements&&(t.elements=this.elements.toJSON()),t},inReadyState:function(){var t=this.get("populated");return this.isDeletedOrPurged()||t},hasDetails:function(){return this.debug("hasDetails:",this.elements.length),0!==this.elements.length},getVisibleContents:function(t){return this.elements},"delete":function(t){return this.get("deleted")?l.when():this.save({deleted:!0},t)},undelete:function(t){return!this.get("deleted")||this.get("purged")?l.when():this.save({deleted:!1},t)},isDeletedOrPurged:function(){return this.get("deleted")||this.get("purged")},searchAttributes:["name"],toString:function(){var t=[this.get("id"),this.get("name")||this.get("element_identifier")];return"DatasetCollection("+t.join(",")+")"}}),p=u.extend({collectionClass:h,initialize:function(t,e){this.debug(this+"(ListDatasetCollection).initialize:",t,e),u.prototype.initialize.call(this,t,e)},toString:function(){return["ListDatasetCollection(",this.get("name"),")"].join("")}}),g=p.extend({initialize:function(t,e){this.debug(this+"(PairDatasetCollection).initialize:",t,e),p.prototype.initialize.call(this,t,e)},toString:function(){return["PairDatasetCollection(",this.get("name"),")"].join("")}}),f=u.extend(e.mixin(s,{constructor:function(t,e){this.debug("\t NestedDCDCE.constructor:",t,e),s.constructor.call(this,t,e)},toString:function(){var t=this.object?""+this.object:this.get("element_identifier");return["NestedDCDCE(",t,")"].join("")}})),m=c.extend({model:f,initialize:function(t,e){this.debug(this+"(NestedDCDCECollection).initialize:",t,e),c.prototype.initialize.call(this,t,e)},toString:function(){return["NestedDCDCECollection(",this.length,")"].join("")}}),v=g.extend(e.mixin(s,{constructor:function(t,e){this.debug("\t NestedPairDCDCE.constructor:",t,e),s.constructor.call(this,t,e)},toString:function(){var t=this.object?""+this.object:this.get("element_identifier");return["NestedPairDCDCE(",t,")"].join("")}})),_=m.extend({model:v,initialize:function(t,e){this.debug(this+"(NestedPairDCDCECollection).initialize:",t,e),m.prototype.initialize.call(this,t,e)},toString:function(){return["NestedPairDCDCECollection(",this.length,")"].join("")}}),y=u.extend({collectionClass:_,initialize:function(t,e){this.debug(this+"(ListPairedDatasetCollection).initialize:",t,e),u.prototype.initialize.call(this,t,e)},toString:function(){return["ListPairedDatasetCollection(",this.get("name"),")"].join("")}}),b=p.extend(e.mixin(s,{constructor:function(t,e){this.debug("\t NestedListDCDCE.constructor:",t,e),s.constructor.call(this,t,e)},toString:function(){var t=this.object?""+this.object:this.get("element_identifier");return["NestedListDCDCE(",t,")"].join("")}})),w=m.extend({model:b,toString:function(){return["NestedListDCDCECollection(",this.length,")"].join("")}}),x=u.extend({collectionClass:w,toString:function(){return["ListOfListsDatasetCollection(",this.get("name"),")"].join("")}});return{ListDatasetCollection:p,PairDatasetCollection:g,ListPairedDatasetCollection:y,ListOfListsDatasetCollection:x}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(2),i(3),i(1))},function(t,e,i){var n,s;(function(a,o,l,r){n=[i(39),i(10),i(6),i(8),i(85),i(5),i(82)],s=function(t,e,i,n,s,c){"use strict";function d(t){var e=t.toJSON(),i=f(e,{creationFn:function(e,i){return e=e.map(function(t){return{id:t.id,name:t.name,src:"dataset"===t.history_content_type?"hda":"hdca"}}),t.createHDCA(e,"list",i)}});return i}var h="collections",u=a.View.extend(i.LoggableMixin).extend({_logNamespace:h,tagName:"li",className:"collection-element",initialize:function(t){this.element=t.element||{},this.selected=t.selected||!1},render:function(){return this.$el.attr("data-element-id",this.element.id).attr("draggable",!0).html(this.template({element:this.element})),this.selected&&this.$el.addClass("selected"),this},template:o.template(['<a class="name" title="',c("Click to rename"),'" href="javascript:void(0)">',"<%- element.name %>","</a>",'<button class="discard btn btn-sm" title="',c("Remove this dataset from the list"),'">',c("Discard"),"</button>"].join("")),select:function(t){this.$el.toggleClass("selected",t),this.trigger("select",{source:this,selected:this.$el.hasClass("selected")})},discard:function(){var t=this,e=this.$el.parent().width();this.$el.animate({"margin-right":e},"fast",function(){t.trigger("discard",{source:t}),t.destroy()})},destroy:function(){this.off(),this.$el.remove()},events:{click:"_click","click .name":"_clickName","click .discard":"_clickDiscard",dragstart:"_dragstart",dragend:"_dragend",dragover:"_sendToParent",drop:"_sendToParent"},_click:function(t){t.stopPropagation(),this.select(t)},_clickName:function(t){t.stopPropagation(),t.preventDefault();var e=([c("Enter a new name for the element"),":\n(",c("Note that changing the name here will not rename the dataset"),")"].join(""),prompt(c("Enter a new name for the element")+":",this.element.name));e&&(this.element.name=e,this.render())},_clickDiscard:function(t){t.stopPropagation(),this.discard()},_dragstart:function(t){t.originalEvent&&(t=t.originalEvent),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",JSON.stringify(this.element)),this.$el.addClass("dragging"),this.$el.parent().trigger("collection-element.dragstart",[this])},_dragend:function(t){this.$el.removeClass("dragging"),this.$el.parent().trigger("collection-element.dragend",[this])},_sendToParent:function(t){this.$el.parent().trigger(t)},toString:function(){return"DatasetCollectionElementView()"}}),p=a.View.extend(i.LoggableMixin).extend({_logNamespace:h,elementViewClass:u,collectionClass:t.HistoryListDatasetCollection,className:"list-collection-creator collection-creator flex-row-container",minElements:1,defaultAttributes:{creationFn:function(){throw new TypeError("no creation fn for creator")},oncreate:function(){},oncancel:function(){},autoscrollDist:24,highlightClr:"rgba( 64, 255, 255, 1.0 )"},initialize:function(t){this.metric("ListCollectionCreator.initialize",t);var e=this;o.each(this.defaultAttributes,function(i,n){i=t[n]||i,e[n]=i}),e.initialElements=t.elements||[],this._instanceSetUp(),this._elementsSetUp(),this._setUpBehaviors()},_instanceSetUp:function(){this.selectedIds={},this.$dragging=null,this.blocking=!1},_elementsSetUp:function(){this.invalidElements=[],this.workingElements=[],this.elementViews=[],this.workingElements=this.initialElements.slice(0),this._ensureElementIds(),this._validateElements(),this._mangleDuplicateNames(),this._sortElements()},_ensureElementIds:function(){return this.workingElements.forEach(function(t){t.hasOwnProperty("id")||(t.id=o.uniqueId())}),this.workingElements},_validateElements:function(){var t=this;return t.invalidElements=[],this.workingElements=this.workingElements.filter(function(e){var i=t._isElementInvalid(e);return i&&t.invalidElements.push({element:e,text:i}),!i}),this.workingElements},_isElementInvalid:function(t){return"dataset"!==t.history_content_type?c("is not a dataset"):t.state!==e.OK?c(o.contains(e.NOT_READY_STATES,t.state)?"hasn't finished running yet":"has errored, is paused, or is not accessible"):t.deleted||t.purged?c("has been deleted or purged"):null},_mangleDuplicateNames:function(){var t=900,e=1,i={};this.workingElements.forEach(function(n){for(var s=n.name;i.hasOwnProperty(s);)if(s=n.name+" ("+e+")",e+=1,e>=t)throw new Error("Safety hit in while loop - thats impressive");n.name=s,i[n.name]=!0})},_sortElements:function(t){},render:function(t,e){return this.workingElements.length<this.minElements?this._renderInvalid(t,e):(this.$el.empty().html(this.templates.main()),this._renderHeader(t),this._renderMiddle(t),this._renderFooter(t),this._addPluginComponents(),this.$(".collection-name").focus(),this.trigger("rendered",this),this)},_renderInvalid:function(t,e){return this.$el.empty().html(this.templates.invalidInitial({problems:this.invalidElements,elements:this.workingElements})),"function"==typeof this.oncancel&&this.$(".cancel-create.btn").show(),this.trigger("rendered",this),this},_renderHeader:function(t,e){var i=this.$(".header").empty().html(this.templates.header()).find(".help-content").prepend(l(this.templates.helpContent()));return this.invalidElements.length&&this._invalidElementsAlert(),i},_renderMiddle:function(t,e){var i=this.$(".middle").empty().html(this.templates.middle());return this._renderList(t),i},_renderFooter:function(t,e){var i=this.$(".footer").empty().html(this.templates.footer());return"function"==typeof this.oncancel&&this.$(".cancel-create.btn").show(),i},_addPluginComponents:function(){this.$(".help-content i").hoverhighlight(".collection-creator",this.highlightClr)},_invalidElementsAlert:function(){this._showAlert(this.templates.invalidElements({problems:this.invalidElements}),"alert-warning")},_validationWarning:function(t,e){var i="validation-warning";"name"===t&&(t=this.$(".collection-name").add(this.$(".collection-name-prompt")),this.$(".collection-name").focus().select()),e?(t=t||this.$("."+i),t.removeClass(i)):t.addClass(i)},_disableNameAndCreate:function(t){t=!!o.isUndefined(t)||t,t&&(this.$(".collection-name").prop("disabled",!0),this.$(".create-collection").toggleClass("disabled",!0))},$list:function(){return this.$(".collection-elements")},_renderClearSelected:function(){o.size(this.selectedIds)?this.$(".collection-elements-controls > .clear-selected").show():this.$(".collection-elements-controls > .clear-selected").hide()},_renderList:function(t,e){var i=this,n=r("<div/>"),s=i.$list();o.each(this.elementViews,function(t){t.destroy(),i.removeElementView(t)}),i.workingElements.forEach(function(t){var e=i._createElementView(t);n.append(e.$el)}),i._renderClearSelected(),s.empty().append(n.children()),o.invoke(i.elementViews,"render"),s.height()>s.css("max-height")?s.css("border-width","1px 0px 1px 0px"):s.css("border-width","0px")},_createElementView:function(t){var e=new this.elementViewClass({element:t,selected:o.has(this.selectedIds,t.id)});return this.elementViews.push(e),this._listenToElementView(e),e},_listenToElementView:function(t){var e=this;e.listenTo(t,{select:function(t){var i=t.source.element;t.selected?e.selectedIds[i.id]=!0:delete e.selectedIds[i.id],e.trigger("elements:select",t)},discard:function(t){e.trigger("elements:discard",t)}})},addElementView:function(t){},removeElementView:function(t){delete this.selectedIds[t.element.id],this._renderClearSelected(),this.elementViews=o.without(this.elementViews,t),this.stopListening(t)},_renderNoElementsLeft:function(){this._disableNameAndCreate(!0),this.$(".collection-elements").append(this.templates.noElementsLeft())},_elementToJSON:function(t){return t},createList:function(t){if(!this.workingElements.length){var e=c("No valid elements for final list")+". ";return e+='<a class="cancel-create" href="javascript:void(0);">'+c("Cancel")+"</a> ",e+=c("or"),e+=' <a class="reset" href="javascript:void(0);">'+c("start over")+"</a>.",void this._showAlert(e)}var i=this,n=this.workingElements.map(function(t){return i._elementToJSON(t)});return i.blocking=!0,i.creationFn(n,t).always(function(){i.blocking=!1}).fail(function(t,e,n){i.trigger("error",{xhr:t,status:e,message:c("An error occurred while creating this collection")})}).done(function(t,e,n){i.trigger("collection:created",t,e,n),i.metric("collection:created",t),"function"==typeof i.oncreate&&i.oncreate.call(this,t,e,n)})},_setUpBehaviors:function(){return this.on("error",this._errorHandler),this.once("rendered",function(){this.trigger("rendered:initial",this)}),this.on("elements:select",function(t){this._renderClearSelected()}),this.on("elements:discard",function(t){var e=t.source.element;this.removeElementView(t.source),this.workingElements=o.without(this.workingElements,e),this.workingElements.length||this._renderNoElementsLeft()}),this},_errorHandler:function(t){this.error(t);var e=this;if(content=t.message||c("An error occurred"),t.xhr){var i=t.xhr,n=t.message;0===i.readyState&&0===i.status?content+=": "+c("Galaxy could not be reached and may be updating.")+c(" Try again in a few minutes."):i.responseJSON?content+=":<br /><pre>"+JSON.stringify(i.responseJSON)+"</pre>":content+=": "+n}e._showAlert(content,"alert-danger")},events:{"click .more-help":"_clickMoreHelp","click .less-help":"_clickLessHelp","click .main-help":"_toggleHelp","click .header .alert button":"_hideAlert","click .reset":"reset","click .clear-selected":"clearSelectedElements","click .collection-elements":"clearSelectedElements","dragover .collection-elements":"_dragoverElements","drop .collection-elements":"_dropElements","collection-element.dragstart .collection-elements":"_elementDragstart","collection-element.dragend   .collection-elements":"_elementDragend","change .collection-name":"_changeName","keydown .collection-name":"_nameCheckForEnter","click .cancel-create":function(t){"function"==typeof this.oncancel&&this.oncancel.call(this)},"click .create-collection":"_clickCreate"},_clickMoreHelp:function(t){t.stopPropagation(),this.$(".main-help").addClass("expanded"),this.$(".more-help").hide()},_clickLessHelp:function(t){t.stopPropagation(),this.$(".main-help").removeClass("expanded"),this.$(".more-help").show()},_toggleHelp:function(t){t.stopPropagation(),this.$(".main-help").toggleClass("expanded"),this.$(".more-help").toggle()},_showAlert:function(t,e){e=e||"alert-danger",this.$(".main-help").hide(),this.$(".header .alert").attr("class","alert alert-dismissable").addClass(e).show().find(".alert-message").html(t)},_hideAlert:function(t){this.$(".main-help").show(),this.$(".header .alert").hide()},reset:function(){this._instanceSetUp(),this._elementsSetUp(),this.render()},clearSelectedElements:function(t){this.$(".collection-elements .collection-element").removeClass("selected"),this.$(".collection-elements-controls > .clear-selected").hide()},_dragoverElements:function(t){t.preventDefault();var e=this.$list();this._checkForAutoscroll(e,t.originalEvent.clientY);var i=this._getNearestElement(t.originalEvent.clientY);this.$(".element-drop-placeholder").remove();var n=l('<div class="element-drop-placeholder"></div>');i.length?i.before(n):e.append(n)},_checkForAutoscroll:function(t,e){var i=2,n=t.offset(),s=t.scrollTop(),a=e-n.top,o=n.top+t.outerHeight()-e;a>=0&&a<this.autoscrollDist?t.scrollTop(s-i):o>=0&&o<this.autoscrollDist&&t.scrollTop(s+i)},_getNearestElement:function(t){for(var e=4,i=this.$(".collection-elements li.collection-element").toArray(),n=0;n<i.length;n++){var s=l(i[n]),a=s.offset().top,o=Math.floor(s.outerHeight()/2)+e;if(a+o>t&&a-o<t)return s}return l()},_dropElements:function(t){t.originalEvent&&(t=t.originalEvent),t.preventDefault(),t.dataTransfer.dropEffect="move";var e=this._getNearestElement(t.clientY);return e.length?this.$dragging.insertBefore(e):this.$dragging.insertAfter(this.$(".collection-elements .collection-element").last()),this._syncOrderToDom(),!1},_syncOrderToDom:function(){var t=this,e=[];this.$(".collection-elements .collection-element").each(function(){var i=l(this).attr("data-element-id"),n=o.findWhere(t.workingElements,{id:i});n?e.push(n):console.error("missing element: ",i)}),this.workingElements=e,this._renderList()},_elementDragstart:function(t,e){e.select(!0),this.$dragging=this.$(".collection-elements .collection-element.selected")},_elementDragend:function(t,e){l(".element-drop-placeholder").remove(),this.$dragging=null},_changeName:function(t){this._validationWarning("name",!!this._getName())},_nameCheckForEnter:function(t){13!==t.keyCode||this.blocking||this._clickCreate()},_getName:function(){return o.escape(this.$(".collection-name").val())},_clickCreate:function(t){var e=this._getName();e?this.blocking||this.createList(e):this._validationWarning("name")},templates:{main:o.template(['<div class="header flex-row no-flex"></div>','<div class="middle flex-row flex-row-container"></div>','<div class="footer flex-row no-flex"></div>'].join("")),header:o.template(['<div class="main-help well clear">','<a class="more-help" href="javascript:void(0);">',c("More help"),"</a>",'<div class="help-content">','<a class="less-help" href="javascript:void(0);">',c("Less"),"</a>","</div>","</div>",'<div class="alert alert-dismissable">','<button type="button" class="close" data-dismiss="alert" ','title="',c("Close and show more help"),'" aria-hidden="true">&times;</button>','<span class="alert-message"></span>',"</div>"].join("")),middle:o.template(['<div class="collection-elements-controls">','<a class="reset" href="javascript:void(0);" ','title="',c("Undo all reordering and discards"),'">',c("Start over"),"</a>",'<a class="clear-selected" href="javascript:void(0);" ','title="',c("De-select all selected datasets"),'">',c("Clear selected"),"</a>","</div>",'<div class="collection-elements scroll-container flex-row">',"</div>"].join("")),footer:o.template(['<div class="attributes clear">','<div class="clear">','<input class="collection-name form-control pull-right" ','placeholder="',c("Enter a name for your new collection"),'" />','<div class="collection-name-prompt pull-right">',c("Name"),":</div>","</div>","</div>",'<div class="actions clear vertically-spaced">','<div class="other-options pull-left">','<button class="cancel-create btn" tabindex="-1">',c("Cancel"),"</button>",'<div class="create-other btn-group dropup">','<button class="btn btn-default dropdown-toggle" data-toggle="dropdown">',c("Create a different kind of collection"),' <span class="caret"></span>',"</button>",'<ul class="dropdown-menu" role="menu">','<li><a href="#">',c("Create a <i>single</i> pair"),"</a></li>",'<li><a href="#">',c("Create a list of <i>unpaired</i> datasets"),"</a></li>","</ul>","</div>","</div>",'<div class="main-options pull-right">','<button class="create-collection btn btn-primary">',c("Create list"),"</button>","</div>","</div>"].join("")),helpContent:o.template(["<p>",c(["Collections of datasets are permanent, ordered lists of datasets that can be passed to tools and ","workflows in order to have analyses done on each member of the entire group. This interface allows ","you to create a collection and re-order the final collection."].join("")),"</p>","<ul>","<li>",c(["Rename elements in the list by clicking on ",'<i data-target=".collection-element .name">the existing name</i>.'].join("")),"</li>","<li>",c(["Discard elements from the final created list by clicking on the ",'<i data-target=".collection-element .discard">"Discard"</i> button.'].join("")),"</li>","<li>",c(["Reorder the list by clicking and dragging elements. Select multiple elements by clicking on ",'<i data-target=".collection-element">them</i> and you can then move those selected by dragging the ',"entire group. Deselect them by clicking them again or by clicking the ",'the <i data-target=".clear-selected">"Clear selected"</i> link.'].join("")),"</li>","<li>",c(['Click the <i data-target=".reset">"Start over"</i> link to begin again as if you had just opened ',"the interface."].join("")),"</li>","<li>",c(['Click the <i data-target=".cancel-create">"Cancel"</i> button to exit the interface.'].join("")),"</li>","</ul><br />","<p>",c(['Once your collection is complete, enter a <i data-target=".collection-name">name</i> and ','click <i data-target=".create-collection">"Create list"</i>.'].join("")),"</p>"].join("")),invalidElements:o.template([c("The following selections could not be included due to problems:"),"<ul><% _.each( problems, function( problem ){ %>","<li><b><%- problem.element.name %></b>: <%- problem.text %></li>","<% }); %></ul>"].join("")),noElementsLeft:o.template(['<li class="no-elements-left-message">',c("No elements left! "),c("Would you like to "),'<a class="reset" href="javascript:void(0)">',c("start over"),"</a>?","</li>"].join("")),invalidInitial:o.template(['<div class="header flex-row no-flex">','<div class="alert alert-warning" style="display: block">','<span class="alert-message">',"<% if( _.size( problems ) ){ %>",c("The following selections could not be included due to problems"),":","<ul><% _.each( problems, function( problem ){ %>","<li><b><%- problem.element.name %></b>: <%- problem.text %></li>","<% }); %></ul>","<% } else if( _.size( elements ) < 1 ){ %>",c("No datasets were selected"),".","<% } %>","<br />",c("At least one element is needed for the collection"),". ",c("You may need to "),'<a class="cancel-create" href="javascript:void(0)">',c("cancel"),"</a> ",c("and reselect new elements"),".","</span>","</div>","</div>",'<div class="footer flex-row no-flex">','<div class="actions clear vertically-spaced">','<div class="other-options pull-left">','<button class="cancel-create btn" tabindex="-1">',c("Cancel"),"</button>","</div>","</div>","</div>"].join(""))},toString:function(){return"ListCollectionCreator"}}),g=function(t,e,i){var s,a=r.Deferred(),l=Galaxy.modal||new n.View;return e=o.defaults(e||{},{elements:t,oncancel:function(){l.hide(),a.reject("cancelled");
},oncreate:function(t,e){l.hide(),a.resolve(e)}}),s=new i(e),l.show({title:e.title||c("Create a collection"),body:s.$el,width:"80%",height:"100%",closing_events:!0}),s.render(),window._collectionCreator=s,a},f=function(t,e){return e=e||{},e.title=c("Create a collection from a list of datasets"),g(t,e,p)};return{DatasetCollectionElementView:u,ListCollectionCreator:p,collectionCreatorModal:g,listCollectionCreatorModal:f,createListCollection:d}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2),i(1),i(1))},function(t,e,i){var n,s;(function(a,o,l,r){n=[i(42),i(10),i(23),i(6),i(5)],s=function(t,e,i,n,s){"use strict";var c="dataset",d=t.ListItemView,h=d.extend({_logNamespace:c,className:d.prototype.className+" dataset",id:function(){return["dataset",this.model.get("id")].join("-")},initialize:function(t){t.logger&&(this.logger=this.model.logger=t.logger),this.log(this+".initialize:",t),d.prototype.initialize.call(this,t),this.linkTarget=t.linkTarget||"_blank"},_setUpListeners:function(){d.prototype._setUpListeners.call(this),this.listenTo(this.model,"change",function(t,e){this.model.changedAttributes().state&&this.model.inReadyState()&&this.expanded&&!this.model.hasDetails()?this.model.fetch():this.render()})},_fetchModelDetails:function(){var t=this;return t.model.inReadyState()&&!t.model.hasDetails()?t.model.fetch({silent:!0}):a.when()},remove:function(t,e){var i=this;t=t||this.fxSpeed,this.$el.fadeOut(t,function(){o.View.prototype.remove.call(i),e&&e.call(i)})},render:function(t){return d.prototype.render.call(this,t)},_swapNewRender:function(t){return d.prototype._swapNewRender.call(this,t),this.model.has("state")&&this.$el.addClass("state-"+this.model.get("state")),this.$el},_renderPrimaryActions:function(){return[this._renderDisplayButton()]},_renderDisplayButton:function(){var t=this.model.get("state");if(t===e.NOT_VIEWABLE||t===e.DISCARDED||!this.model.get("accessible"))return null;var n={target:this.linkTarget,classes:"display-btn"};if(this.model.get("purged"))n.disabled=!0,n.title=s("Cannot display datasets removed from disk");else if(t===e.UPLOAD)n.disabled=!0,n.title=s("This dataset must finish uploading before it can be viewed");else if(t===e.NEW)n.disabled=!0,n.title=s("This dataset is not yet viewable");else{n.title=s("View data"),n.href=this.model.urls.display;var a=this;n.onclick=function(t){Galaxy.frame&&Galaxy.frame.active&&(Galaxy.frame.addDataset(a.model.get("id")),t.preventDefault())}}return n.faIcon="fa-eye",i(n)},_renderDetails:function(){if(this.model.get("state")===e.NOT_VIEWABLE)return l(this.templates.noAccess(this.model.toJSON(),this));var t=d.prototype._renderDetails.call(this);return t.find(".actions .left").empty().append(this._renderSecondaryActions()),t.find(".summary").html(this._renderSummary()).prepend(this._renderDetailMessages()),t.find(".display-applications").html(this._renderDisplayApplications()),this._setUpBehaviors(t),t},_renderSummary:function(){var t=this.model.toJSON(),e=this.templates.summaries[t.state];return(e=e||this.templates.summaries.unknown)(t,this)},_renderDetailMessages:function(){var t=this,e=l('<div class="detail-messages"></div>'),i=t.model.toJSON();return r.each(t.templates.detailMessages,function(n){e.append(l(n(i,t)))}),e},_renderDisplayApplications:function(){return this.model.isDeletedOrPurged()?"":[this.templates.displayApplications(this.model.get("display_apps"),this),this.templates.displayApplications(this.model.get("display_types"),this)].join("")},_renderSecondaryActions:function(){switch(this.debug("_renderSecondaryActions"),this.model.get("state")){case e.NOT_VIEWABLE:return[];case e.OK:case e.FAILED_METADATA:case e.ERROR:return[this._renderDownloadButton(),this._renderShowParamsButton()]}return[this._renderShowParamsButton()]},_renderShowParamsButton:function(){return i({title:s("View details"),classes:"params-btn",href:this.model.urls.show_params,target:this.linkTarget,faIcon:"fa-info-circle"})},_renderDownloadButton:function(){return this.model.get("purged")||!this.model.hasData()?null:r.isEmpty(this.model.get("meta_files"))?l(['<a class="download-btn icon-btn" href="',this.model.urls.download,'" title="'+s("Download")+'" download>','<span class="fa fa-floppy-o"></span>',"</a>"].join("")):this._renderMetaFileDownloadButton()},_renderMetaFileDownloadButton:function(){var t=this.model.urls;return l(['<div class="metafile-dropdown dropdown">','<a class="download-btn icon-btn" href="javascript:void(0)" data-toggle="dropdown"',' title="'+s("Download")+'">','<span class="fa fa-floppy-o"></span>',"</a>",'<ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">','<li><a href="'+t.download+'" download>',s("Download dataset"),"</a></li>",r.map(this.model.get("meta_files"),function(e){return['<li><a href="',t.meta_download+e.file_type,'">',s("Download")," ",e.file_type,"</a></li>"].join("")}).join("\n"),"</ul>","</div>"].join("\n"))},events:r.extend(r.clone(d.prototype.events),{"click .display-btn":function(t){this.trigger("display",this,t)},"click .params-btn":function(t){this.trigger("params",this,t)},"click .download-btn":function(t){this.trigger("download",this,t)}}),toString:function(){var t=this.model?this.model+"":"(no model)";return"DatasetListItemView("+t+")"}});return h.prototype.templates=function(){var t=r.extend({},d.prototype.templates.warnings,{failed_metadata:n.wrapTemplate(['<% if( model.state === "failed_metadata" ){ %>','<div class="warningmessagesmall">',s("An error occurred setting the metadata for this dataset"),"</div>","<% } %>"]),error:n.wrapTemplate(["<% if( model.error ){ %>",'<div class="errormessagesmall">',s("There was an error getting the data for this dataset"),": <%- model.error %>","</div>","<% } %>"]),purged:n.wrapTemplate(["<% if( model.purged ){ %>",'<div class="purged-msg warningmessagesmall">',s("This dataset has been deleted and removed from disk"),"</div>","<% } %>"]),deleted:n.wrapTemplate(["<% if( model.deleted && !model.purged ){ %>",'<div class="deleted-msg warningmessagesmall">',s("This dataset has been deleted"),"</div>","<% } %>"])}),i=n.wrapTemplate(['<div class="details">','<div class="summary"></div>','<div class="actions clear">','<div class="left"></div>','<div class="right"></div>',"</div>","<% if( !dataset.deleted && !dataset.purged ){ %>",'<div class="tags-display"></div>','<div class="annotation-display"></div>','<div class="display-applications"></div>',"<% if( dataset.peek ){ %>",'<pre class="dataset-peek"><%= dataset.peek %></pre>',"<% } %>","<% } %>","</div>"],"dataset"),a=n.wrapTemplate(['<div class="details">','<div class="summary">',s("You do not have permission to view this dataset"),"</div>","</div>"],"dataset"),o={};o[e.OK]=o[e.FAILED_METADATA]=n.wrapTemplate(["<% if( dataset.misc_blurb ){ %>",'<div class="blurb">','<span class="value"><%- dataset.misc_blurb %></span>',"</div>","<% } %>","<% if( dataset.file_ext ){ %>",'<div class="datatype">','<label class="prompt">',s("format"),"</label>",'<span class="value"><%- dataset.file_ext %></span>',"</div>","<% } %>","<% if( dataset.metadata_dbkey ){ %>",'<div class="dbkey">','<label class="prompt">',s("database"),"</label>",'<span class="value">',"<%- dataset.metadata_dbkey %>","</span>","</div>","<% } %>","<% if( dataset.misc_info ){ %>",'<div class="info">','<span class="value"><%- dataset.misc_info %></span>',"</div>","<% } %>"],"dataset"),o[e.NEW]=n.wrapTemplate(["<div>",s("This is a new dataset and not all of its data are available yet"),"</div>"],"dataset"),o[e.NOT_VIEWABLE]=n.wrapTemplate(["<div>",s("You do not have permission to view this dataset"),"</div>"],"dataset"),o[e.DISCARDED]=n.wrapTemplate(["<div>",s("The job creating this dataset was cancelled before completion"),"</div>"],"dataset"),o[e.QUEUED]=n.wrapTemplate(["<div>",s("This job is waiting to run"),"</div>"],"dataset"),o[e.RUNNING]=n.wrapTemplate(["<div>",s("This job is currently running"),"</div>"],"dataset"),o[e.UPLOAD]=n.wrapTemplate(["<div>",s("This dataset is currently uploading"),"</div>"],"dataset"),o[e.SETTING_METADATA]=n.wrapTemplate(["<div>",s("Metadata is being auto-detected"),"</div>"],"dataset"),o[e.PAUSED]=n.wrapTemplate(["<div>",s('This job is paused. Use the "Resume Paused Jobs" in the history menu to resume'),"</div>"],"dataset"),o[e.ERROR]=n.wrapTemplate(["<% if( !dataset.purged ){ %>","<div><%- dataset.misc_blurb %></div>","<% } %>",'<span class="help-text">',s("An error occurred with this dataset"),":</span>",'<div class="job-error-text"><%- dataset.misc_info %></div>'],"dataset"),o[e.EMPTY]=n.wrapTemplate(["<div>",s("No data"),": <i><%- dataset.misc_blurb %></i></div>"],"dataset"),o.unknown=n.wrapTemplate(['<div>Error: unknown dataset state: "<%- dataset.state %>"</div>'],"dataset");var l={resubmitted:n.wrapTemplate(["<% if( model.resubmitted ){ %>",'<div class="resubmitted-msg infomessagesmall">',s("The job creating this dataset has been resubmitted"),"</div>","<% } %>"])},c=n.wrapTemplate(["<% _.each( apps, function( app ){ %>",'<div class="display-application">','<span class="display-application-location"><%- app.label %></span> ','<span class="display-application-links">',"<% _.each( app.links, function( link ){ %>",'<a target="<%- link.target %>" href="<%- link.href %>">',"<% print( _l( link.text ) ); %>","</a> ","<% }); %>","</span>","</div>","<% }); %>"],"apps");return r.extend({},d.prototype.templates,{warnings:t,details:i,noAccess:a,summaries:o,detailMessages:l,displayApplications:c})}(),{DatasetListItemView:h}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(1),i(3),i(1),i(2))},function(t,e,i){var n,s;(function(a,o,l){n=[i(4)],s=function(t){var e=a.Model.extend({initialize:function(t){this.app=t},checksum:function(){var t="",e=this;return this.app.section.$el.find(".section-row").each(function(){var i=o(this).attr("id"),n=e.app.field_list[i];n&&(t+=i+":"+JSON.stringify(n.value&&n.value())+":"+n.collapsed+";")}),t},set:function(t){for(var e in t.attributes){var i=this.match(e);i&&this.app.field_list[i].value(t.get(e))}},create:function(){function t(t,e,i){n.flat_dict[t]=e,a[t]=i,n.app.element_list[e]&&n.app.element_list[e].$el.attr("tour_id",t)}function e(s,a){for(var o in a){var l=a[o];if(l.input){var r=l.input,c=s;switch(""!=s&&(c+="|"),c+=r.name,r.type){case"repeat":var d="section-",h=[],u=null;for(var p in l){var g=p.indexOf(d);g!=-1&&(g+=d.length,h.push(parseInt(p.substr(g))),u||(u=p.substr(0,g)))}h.sort(function(t,e){return t-e});var o=0;for(var f in h)e(c+"_"+o++,l[u+h[f]]);break;case"conditional":var m=n.app.field_list[r.id].value();t(c+"|"+r.test_param.name,r.id,m);var v=i(r,m);v!=-1&&e(c,a[r.id+"-section-"+v]);break;case"section":e(!r.flat&&c||"",l);break;default:var _=n.app.field_list[r.id];if(_&&_.value){var m=_.value();if((void 0===r.ignore||r.ignore!=m)&&(_.collapsed&&r.collapsible_value&&(m=r.collapsible_value),t(c,r.id,m),r.payload))for(var y in r.payload)t(y,r.id,r.payload[y])}}}}}var n=this,s={};this._iterate(this.app.section.$el,s);var a={};return this.flat_dict={},e("",s),a},match:function(t){return this.flat_dict&&this.flat_dict[t]},matchCase:function(t,e){return i(t,e)},matchModel:function(t,e){var i=this;n(t.inputs,function(t,n){i.flat_dict[n]&&e(t,i.flat_dict[n])})},matchResponse:function(t){function e(t,s){if("string"==typeof s){var a=n.flat_dict[t];a&&(i[a]=s)}else for(var o in s){var l=o;if(""!==t){var r="|";s instanceof Array&&(r="_"),l=t+r+l}e(l,s[o])}}var i={},n=this;return e("",t),i},_iterate:function(t,e){var i=this,n=o(t).children();n.each(function(){var t=this,n=o(t).attr("id");if(o(t).hasClass("section-row")){var s=i.app.input_list[n];e[n]=s&&{input:s}||{},i._iterate(t,e[n])}else i._iterate(t,e)})}}),i=function(t,e){"boolean"==t.test_param.type&&(e="true"==e?t.test_param.truevalue||"true":t.test_param.falsevalue||"false");for(var i in t.cases)if(t.cases[i].value==e)return i;return-1},n=function(t,e,s,a){a=o.extend(!0,{},a),l.each(t,function(t){t&&t.type&&t.name&&(a[t.name]=t)});for(var r in t){var c=t[r],d=s?s+"|"+c.name:c.name;switch(c.type){case"repeat":l.each(c.cache,function(t,i){n(t,e,d+"_"+i,a)});break;case"conditional":if(c.test_param){e(c.test_param,d+"|"+c.test_param.name,a);var h=i(c,c.test_param.value);h!=-1?n(c.cases[h].inputs,e,d,a):Galaxy.emit.debug("form-data::visitInputs() - Invalid case for "+d+".")}else Galaxy.emit.debug("form-data::visitInputs() - Conditional test parameter missing for "+d+".");break;case"section":n(c.inputs,e,d,a);break;default:e(c,d,a)}}};return{Manager:e,visitInputs:n}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1),i(2))},function(t,e,i){var n,s;(function(i,a,o){n=[],s=function(){return i.View.extend({initialize:function(t,e){this.app=t,this.app_options=t.options||{},this.field=e&&e.field||new i.View,this.model=e&&e.model||new i.Model({text_enable:this.app_options.text_enable||"Enable",text_disable:this.app_options.text_disable||"Disable",cls_enable:this.app_options.cls_enable||"fa fa-caret-square-o-down",cls_disable:this.app_options.cls_disable||"fa fa-caret-square-o-up"}).set(e),this.setElement(this._template()),this.$field=this.$(".ui-form-field"),this.$info=this.$(".ui-form-info"),this.$preview=this.$(".ui-form-preview"),this.$collapsible=this.$(".ui-form-collapsible"),this.$collapsible_text=this.$(".ui-form-collapsible-text"),this.$collapsible_icon=this.$(".ui-form-collapsible-icon"),this.$title=this.$(".ui-form-title"),this.$title_text=this.$(".ui-form-title-text"),this.$error_text=this.$(".ui-form-error-text"),this.$error=this.$(".ui-form-error"),this.$backdrop=this.$(".ui-form-backdrop"),this.$field.prepend(this.field.$el);var n=this.model.get("collapsible_value");this.field.collapsed=void 0!==n&&JSON.stringify(this.model.get("value"))==JSON.stringify(n),this.listenTo(this.model,"change",this.render,this),this.render();var s=this;this.$collapsible.on("click",function(){s.field.collapsed=!s.field.collapsed,t.trigger&&t.trigger("change"),s.render()})},backdrop:function(){this.model.set("backdrop",!0)},error:function(t){this.model.set("error_text",t)},reset:function(){this.model.set("error_text",null)},render:function(){a(".tooltip").hide();var t=this.model.get("help",""),e=this.model.get("argument");e&&t.indexOf("("+e+")")==-1&&(t+=" ("+e+")"),this.$info.html(t),this.$preview[this.field.collapsed&&this.model.get("collapsible_preview")||this.model.get("disabled")?"show":"hide"]().html(o.escape(this.model.get("text_value")));var i=this.model.get("error_text");if(this.$error[i?"show":"hide"](),this.$el[i?"addClass":"removeClass"]("ui-error"),this.$error_text.html(i),this.$backdrop[this.model.get("backdrop")?"show":"hide"](),this.field.collapsed||this.model.get("disabled")?this.$field.hide():this.$field.fadeIn("fast"),this.field.model&&this.field.model.set({color:this.model.get("color"),style:this.model.get("style")}),this.model.get("disabled")||void 0===this.model.get("collapsible_value"))this.$title_text.show().text(this.model.get("label")),this.$collapsible.hide();else{var n=this.field.collapsed?"enable":"disable";this.$title_text.hide(),this.$collapsible.show(),this.$collapsible_text.text(this.model.get("label")),this.$collapsible_icon.removeClass().addClass("icon").addClass(this.model.get("cls_"+n)).attr("data-original-title",this.model.get("text_"+n)).tooltip({placement:"bottom"})}},_template:function(){return a("<div/>").addClass("ui-form-element").append(a("<div/>").addClass("ui-form-error ui-error").append(a("<span/>").addClass("fa fa-arrow-down")).append(a("<span/>").addClass("ui-form-error-text"))).append(a("<div/>").addClass("ui-form-title").append(a("<div/>").addClass("ui-form-collapsible").append(a("<i/>").addClass("ui-form-collapsible-icon")).append(a("<span/>").addClass("ui-form-collapsible-text"))).append(a("<span/>").addClass("ui-form-title-text"))).append(a("<div/>").addClass("ui-form-field").append(a("<span/>").addClass("ui-form-info")).append(a("<div/>").addClass("ui-form-backdrop"))).append(a("<div/>").addClass("ui-form-preview"))}})}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1),i(2))},function(t,e,i){var n,s;(function(a,o,l){n=[i(4),i(7),i(49),i(51),i(50),i(47)],s=function(t,e,i,n,s,r){return a.Model.extend({types:{text:"_fieldText",select:"_fieldSelect",data_column:"_fieldSelect",genomebuild:"_fieldSelect",data:"_fieldData",data_collection:"_fieldData",integer:"_fieldSlider","float":"_fieldSlider","boolean":"_fieldBoolean",drill_down:"_fieldDrilldown",color:"_fieldColor",hidden:"_fieldHidden",hidden_data:"_fieldHidden",baseurl:"_fieldHidden",library_data:"_fieldLibrary",ftpfile:"_fieldFtp"},create:function(t){var e=this.types[t.type],i="function"==typeof this[e]?this[e].call(this,t):null;return i||(i=t.options?this._fieldSelect(t):this._fieldText(t),Galaxy.emit.debug("form-parameters::_addRow()","Auto matched field type ("+t.type+").")),void 0===t.value&&(t.value=null),i.value(t.value),i},_fieldData:function(t){return new i.View({id:"field-"+t.id,extensions:t.extensions,optional:t.optional,multiple:t.multiple,type:t.type,flavor:t.flavor,data:t.options,onchange:t.onchange})},_fieldSelect:function(t){if(t.is_workflow)return this._fieldText(t);"data_column"==t.type&&(t.error_text="Missing columns in referenced dataset.");var i=t.data;i||(i=[],o.each(t.options,function(t){i.push({label:t[0],value:t[1]})}));var n=e.Select;switch(t.display){case"checkboxes":n=e.Checkbox;break;case"radio":n=e.Radio;break;case"radiobutton":n=e.RadioButton}return new n.View({id:"field-"+t.id,data:i,error_text:t.error_text||"No options available",multiple:t.multiple,optional:t.optional,onchange:t.onchange})},_fieldDrilldown:function(t){return t.is_workflow?this._fieldText(t):new e.Drilldown.View({id:"field-"+t.id,data:t.options,display:t.display,optional:t.optional,onchange:t.onchange})},_fieldText:function(i){if(i.options&&i.data)if(i.area=i.multiple,t.isEmpty(i.value))i.value=null;else if(l.isArray(i.value)){var n="";for(var s in i.value){if(n+=String(i.value[s]),!i.multiple)break;n+="\n"}i.value=n}return new e.Input({id:"field-"+i.id,area:i.area,placeholder:i.placeholder,onchange:i.onchange})},_fieldSlider:function(t){return new e.Slider.View({id:"field-"+t.id,precise:"float"==t.type,is_workflow:t.is_workflow,min:t.min,max:t.max,onchange:t.onchange})},_fieldHidden:function(t){return new e.Hidden({id:"field-"+t.id,info:t.info})},_fieldBoolean:function(t){return new e.RadioButton.View({id:"field-"+t.id,data:[{label:"Yes",value:"true"},{label:"No",value:"false"}],onchange:t.onchange})},_fieldColor:function(t){return new r({id:"field-"+t.id,onchange:t.onchange})},_fieldLibrary:function(t){return new n.View({id:"field-"+t.id,optional:t.optional,multiple:t.multiple,onchange:t.onchange})},_fieldFtp:function(t){return new s.View({id:"field-"+t.id,optional:t.optional,multiple:t.multiple,onchange:t.onchange})}})}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2),i(1))},function(t,e,i){var n,s;(function(a,o,l){n=[i(4),i(14),i(9),i(7)],s=function(t,e,i,n){var s=a.View.extend({initialize:function(i){this.options=t.merge(i,{title:"Section",empty_text:"Not available.",max:null,min:null}),this.setElement("<div/>"),this.button_new=new n.ButtonIcon({icon:"fa-plus",title:"Insert "+this.options.title_new,tooltip:"Add new "+this.options.title_new+" block",floating:"clear",onclick:function(){i.onnew&&i.onnew()}}),this.table=new e.View({cls:"ui-table-plain",content:""}),this.$el.append(this.table.$el),this.$el.append(o("<div/>").append(this.button_new.$el)),this.list={},this.n=0},size:function(){return this.n},add:function(t){if(!t.id||this.list[t.id])return void Galaxy.emit.debug("form-repeat::add()","Duplicate repeat block id.");this.n++;var e=new n.ButtonIcon({icon:"fa-trash-o",tooltip:"Delete this repeat block",cls:"ui-button-icon-plain",onclick:function(){t.ondel&&t.ondel()}}),s=new i.View({id:t.id,title:"placeholder",cls:t.cls||"ui-portlet-repeat",operations:{button_delete:e}});s.append(t.$el),s.$el.addClass("section-row"),this.list[t.id]=s,this.table.add(s.$el),this.table.append("row_"+t.id,!0),this.options.max>0&&this.n>=this.options.max&&this.button_new.disable(),this._refresh()},del:function(t){if(!this.list[t])return void Galaxy.emit.debug("form-repeat::del()","Invalid repeat block id.");this.n--;var e=this.table.get("row_"+t);e.remove(),delete this.list[t],this.button_new.enable(),this._refresh()},delAll:function(){for(var t in this.list)this.del(t)},hideOptions:function(){this.button_new.$el.hide(),l.each(this.list,function(t){t.hideOperation("button_delete")}),l.isEmpty(this.list)&&this.$el.append(o("<div/>").addClass("ui-form-info").html(this.options.empty_text))},_refresh:function(){var t=0;for(var e in this.list){var i=this.list[e];i.title(++t+": "+this.options.title),this.n>this.options.min?i.showOperation("button_delete"):i.hideOperation("button_delete")}}});return{View:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1),i(2))},function(t,e,i){var n,s;(function(a,o,l,r){n=[i(4),i(14),i(7),i(9),i(36),i(34),i(35)],s=function(t,e,i,n,s,c,d){var h=a.View.extend({initialize:function(t,i){this.app=t,this.inputs=i.inputs,i.cls="ui-table-plain",i.cls_tr="section-row",this.table=new e.View(i),this.parameters=new d,this.setElement(this.table.$el),this.render()},render:function(){this.table.delAll();for(var t in this.inputs)this.add(this.inputs[t])},add:function(e){var i=o.extend(!0,{},e);i.id=e.id=t.uid(),this.app.input_list[i.id]=i;var n=i.type;switch(n){case"conditional":this._addConditional(i);break;case"repeat":this._addRepeat(i);break;case"section":this._addSection(i);break;default:this._addRow(i)}},_addConditional:function(t){var e=this;t.test_param.id=t.id,this.app.options.sustain_conditionals&&(t.test_param.disabled=!0);var i=this._addRow(t.test_param);i.model&&i.model.set("onchange",function(i){var n=e.app.data.matchCase(t,i);for(var s in t.cases){var a=t.cases[s],o=t.id+"-section-"+s,l=e.table.get(o),r=!1;for(var c in a.inputs)if(!a.inputs[c].hidden){r=!0;break}s==n&&r?l.fadeIn("fast"):l.hide()}e.app.trigger("change")});for(var n in t.cases){var s=t.id+"-section-"+n,a=new h(this.app,{inputs:t.cases[n].inputs});a.$el.addClass("ui-table-section"),this.table.add(a.$el),this.table.append(s)}i.trigger("change")},_addRepeat:function(t){function e(e){var s=t.id+"-section-"+n++,o=new h(i.app,{inputs:e});a.add({id:s,$el:o.$el,ondel:function(){a.del(s),i.app.trigger("change")}})}for(var i=this,n=0,a=new s.View({title:t.title||"Repeat",title_new:t.title||"",min:t.min,max:t.max,onnew:function(){e(t.inputs),i.app.trigger("change")}}),o=l.size(t.cache),r=0;r<Math.max(Math.max(o,t.min),t["default"]);r++)e(r<o?t.cache[r]:t.inputs);this.app.options.sustain_repeats&&a.hideOptions();var d=new c(this.app,{label:t.title||t.name,help:t.help,field:a});this.table.add(d.$el),this.table.append(t.id)},_addSection:function(t){var e=new n.View({title:t.title||t.name,cls:"ui-portlet-section",collapsible:!0,collapsible_button:!0,collapsed:!t.expanded});e.append(new h(this.app,{inputs:t.inputs}).$el),e.append(r("<div/>").addClass("ui-form-info").html(t.help)),this.app.on("expand",function(t){e.$("#"+t).length>0&&e.expand()}),this.table.add(e.$el),this.table.append(t.id)},_addRow:function(t){var e=this,i=t.id;t.onchange=function(){e.app.trigger("change")};var n=this.parameters.create(t);this.app.field_list[i]=n;var s=new c(this.app,{name:t.name,label:t.label||t.name,value:t.value,text_value:t.text_value,collapsible_value:t.collapsible_value,collapsible_preview:t.collapsible_preview,help:t.help,argument:t.argument,disabled:t.disabled,color:t.color,style:t.style,backdrop:t.backdrop,field:n});return this.app.element_list[i]=s,this.table.add(s.$el),this.table.append(i),t.hidden&&this.table.get(i).hide(),n}});return{View:h}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1),i(2),i(1))},function(t,e,i){var n,s;(function(a,o,l){n=[i(4),i(9),i(7),i(37),i(33)],s=function(t,e,i,n,s){return a.View.extend({initialize:function(e){this.options=t.merge(e,{initial_errors:!1,cls:"ui-portlet-limited",icon:null}),this.setElement("<div/>"),this.render()},update:function(t){var e=this;this.data.matchModel(t,function(t,i){var n=e.input_list[i];if(n&&n.options&&!o.isEqual(n.options,t.options)){n.options=t.options;var s=e.field_list[i];if(s.update){var a=[];if(["data","data_collection","drill_down"].indexOf(n.type)!=-1)a=n.options;else for(var l in t.options){var r=t.options[l];r.length>2&&a.push({label:r[0],value:r[1]})}s.update(a),s.trigger("change"),Galaxy.emit.debug("form-view::update()","Updating options for "+i)}}})},wait:function(t){for(var e in this.input_list){var i=this.field_list[e],n=this.input_list[e];n.is_dynamic&&i.wait&&i.unwait&&(t?i.wait():i.unwait())}},highlight:function(t,e,i){var n=this.element_list[t];if(n&&(n.error(e||"Please verify this parameter."),this.portlet.expand(),this.trigger("expand",t),!i))if(self==top){var s=this.$el.parents().filter(function(){return"auto"==l(this).css("overflow")}).first();s.animate({scrollTop:s.scrollTop()+n.$el.offset().top-50},500)}else l("html, body").animate({scrollTop:n.$el.offset().top-20},500)},errors:function(t){if(this.trigger("reset"),t&&t.errors){var e=this.data.matchResponse(t.errors);for(var i in this.element_list){this.element_list[i];e[i]&&this.highlight(i,e[i],!0)}}},setOnChange:function(t){this.options.onchange=t},render:function(){var t=this;this.off("change"),this.off("reset"),this.field_list={},this.input_list={},this.element_list={},this.data=new s.Manager(this),this._renderForm(),this.data.create(),this.options.initial_errors&&this.errors(this.options);var e=this.data.checksum();return this.on("change",function(i){var n=t.data.checksum();(n!=e||i)&&(e=n,t.options.onchange&&t.options.onchange())}),this.on("reset",function(){for(var t in this.element_list)this.element_list[t].reset()}),this},_renderForm:function(){this.message=new i.Message,this.section=new n.View(this,{inputs:this.options.inputs}),l(".tooltip").remove(),this.portlet=new e.View({icon:this.options.icon,title:this.options.title,cls:this.options.cls,operations:this.options.operations,buttons:this.options.buttons,collapsible:this.options.collapsible,collapsed:this.options.collapsed}),this.portlet.append(this.message.$el),this.portlet.append(this.section.$el),this.$el.empty(),this.$el.append(this.portlet.$el),this.options.message&&this.message.update({persistent:!0,status:"warning",message:this.options.message}),Galaxy.emit.debug("form-view::initialize()","Completed")}})}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2),i(1))},function(t,e,i){var n,s;(function(a){n=[i(30),i(40),i(5)],s=function(t,e,i){"use strict";function n(t){return function(e,i){return this.isNew()&&(i=i||{},i.url=this.urlRoot+this.get("history_id")+"/contents",e=e||{},e.type="dataset_collection"),t.call(this,e,i)}}var s=e.HistoryContentMixin,o=t.ListDatasetCollection,l=t.PairDatasetCollection,r=t.ListPairedDatasetCollection,c=t.ListOfListsDatasetCollection,d=o.extend(s).extend({defaults:a.extend(a.clone(o.prototype.defaults),{history_content_type:"dataset_collection",collection_type:"list",model_class:"HistoryDatasetCollectionAssociation"}),initialize:function(t,e){o.prototype.initialize.call(this,t,e),s.initialize.call(this,t,e)},save:n(o.prototype.save),toString:function(){return["HistoryListDatasetCollection(",this.get("name"),")"].join("")}}),h=l.extend(s).extend({defaults:a.extend(a.clone(l.prototype.defaults),{history_content_type:"dataset_collection",collection_type:"paired",model_class:"HistoryDatasetCollectionAssociation"}),initialize:function(t,e){l.prototype.initialize.call(this,t,e),s.initialize.call(this,t,e)},save:n(l.prototype.save),toString:function(){return["HistoryPairDatasetCollection(",this.get("name"),")"].join("")}}),u=r.extend(s).extend({defaults:a.extend(a.clone(r.prototype.defaults),{history_content_type:"dataset_collection",collection_type:"list:paired",model_class:"HistoryDatasetCollectionAssociation"}),initialize:function(t,e){r.prototype.initialize.call(this,t,e),s.initialize.call(this,t,e)},save:n(r.prototype.save),toString:function(){return["HistoryListPairedDatasetCollection(",this.get("name"),")"].join("")}}),p=c.extend(s).extend({defaults:a.extend(a.clone(c.prototype.defaults),{history_content_type:"dataset_collection",collection_type:"list:list",model_class:"HistoryDatasetCollectionAssociation"}),initialize:function(t,e){c.prototype.initialize.call(this,t,e),s.initialize.call(this,t,e)},save:n(c.prototype.save),toString:function(){return["HistoryListOfListsDatasetCollection(",this.get("name"),")"].join("")}});return{HistoryListDatasetCollection:d,HistoryPairDatasetCollection:h,HistoryListPairedDatasetCollection:u,HistoryListOfListsDatasetCollection:p}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(2))},function(t,e,i){var n,s;(function(a,o){n=[i(10),i(6),i(5)],s=function(t,e,i){"use strict";var n="history",s=function(t,e){return[t,e].join("-")},l={defaults:{history_id:null,history_content_type:null,hid:null,visible:!0},idAttribute:"type_id",constructor:function(t,e){t.type_id=s(t.history_content_type,t.id),this.debug("HistoryContentMixin.constructor:",t.type_id),a.Model.apply(this,arguments)},_typeIdStr:function(){return s(this.get("history_content_type"),this.get("id"))},initialize:function(t,e){this.on("change:id",this._createTypeId)},_createTypeId:function(){this.set("type_id",this._typeIdStr())},isNew:function(){return!this.get("id")},hidden:function(){return!this.get("visible")},isVisible:function(t,e){var i=!0;return t||!this.get("deleted")&&!this.get("purged")||(i=!1),e||this.get("visible")||(i=!1),i},urlRoot:Galaxy.root+"api/histories/",url:function(){var t=this.urlRoot+this.get("history_id")+"/contents/"+this.get("history_content_type")+"s/"+this.get("id");return t},hide:function(t){return this.get("visible")?this.save({visible:!1},t):o.when()},unhide:function(t){return this.get("visible")?o.when():this.save({visible:!0},t)},toString:function(){var t=this.get("id")||"";return this.get("name")&&(t=this.get("hid")+' :"'+this.get("name")+'",'+t),"HistoryContent("+t+")"}},r=a.Model.extend(e.LoggableMixin).extend(l).extend({_logNamespace:n});return{typeIdStr:s,HistoryContentMixin:l,HistoryContent:r}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1))},function(t,e,i){var n,s;(function(a,o,l){n=[i(40),i(73),i(39),i(10),i(6),i(5)],s=function(t,e,i,n,s,r){"use strict";var c="history",d=a.Collection.extend(s.LoggableMixin).extend({_logNamespace:c,model:function(t,n){if("dataset"===t.history_content_type)return new e.HistoryDatasetAssociation(t,n);if("dataset_collection"===t.history_content_type){switch(t.collection_type){case"list":return new i.HistoryListDatasetCollection(t,n);case"paired":return new i.HistoryPairDatasetCollection(t,n);case"list:paired":return new i.HistoryListPairedDatasetCollection(t,n);case"list:list":return new i.HistoryListOfListsDatasetCollection(t,n)}var s="Unknown collection_type: "+t.collection_type;return console.warn(s,t),{validationError:s}}return{validationError:"Unknown history_content_type: "+t.history_content_type}},initialize:function(t,e){e=e||{},this.historyId=e.historyId,this.model.prototype.idAttribute="type_id",this.on("all",function(){this.debug(this+".event:",arguments)})},urlRoot:Galaxy.root+"api/histories",url:function(){return this.urlRoot+"/"+this.historyId+"/contents"},ids:function(){return this.map(function(t){return t.get("id")})},notReady:function(){return this.filter(function(t){return!t.inReadyState()})},running:function(){function t(t){return!t.inReadyState()}return new d(this.filter(t))},getByHid:function(t){return o.first(this.filter(function(e){return e.get("hid")===t}))},getVisible:function(t,e,i){i=i||[],this.debug("checking isVisible");var n=new d(this.filter(function(i){return i.isVisible(t,e)}));return o.each(i,function(t){o.isFunction(t)&&(n=new d(n.filter(t)))}),n},hidden:function(){function t(t){return t.hidden()}return new d(this.filter(t))},deleted:function(){function t(t){return t.get("deleted")}return new d(this.filter(t))},visibleAndUndeleted:function(){function t(t){return t.get("visible")&&!t.get("deleted");
}return new d(this.filter(t))},haveDetails:function(){return this.all(function(t){return t.hasDetails()})},fetch:function(t){return t=t||{},t.data=o.defaults(t.data||{},{v:"dev"}),a.Collection.prototype.fetch.call(this,t)},fetchUpdated:function(t,e){return e=e||{},e.traditional=!0,e.data=[{name:"v",value:"dev"}],t&&(e.data=e.data.concat(this._filtersFromMap({"update_time-ge":t.toISOString()}))),e.merge=!0,e.remove=!1,this.fetch(e)},_filtersFromMap:function(t){var e=[];return o.each(t,function(t,i){e.push({name:"q",value:i}),e.push({name:"qv",value:t})}),e},fetchAllDetails:function(t){t=t||{};var e={details:"all"};return t.data=t.data?o.extend(t.data,e):e,this.fetch(t)},fetchCollectionCounts:function(t){return t=t||{},t.data=o.defaults({keys:["type_id","element_count"].join(","),q:"history_content_type",qv:"dataset_collection"},t.data||{}),t.merge=!0,t.remove=!1,this.fetch(t)},ajaxQueue:function(t,e){var i=l.Deferred(),n=this.length,s=[];if(!n)return i.resolve([]),i;var a=this.chain().reverse().map(function(o,l){return function(){var r=t.call(o,e);r.done(function(t){i.notify({curr:l,total:n,response:t,model:o})}),r.always(function(t){s.push(t),a.length?a.shift()():i.resolve(s)})}}).value();return a.shift()(),i},isCopyable:function(t){var e=["HistoryDatasetAssociation","HistoryDatasetCollectionAssociation"];return o.isObject(t)&&t.id&&o.contains(e,t.model_class)},copy:function(t){var e,i,n;o.isString(t)?(e=t,n="hda",i="dataset"):(e=t.id,n={HistoryDatasetAssociation:"hda",LibraryDatasetDatasetAssociation:"ldda",HistoryDatasetCollectionAssociation:"hdca"}[t.model_class]||"hda",i="hdca"===n?"dataset_collection":"dataset");var s=this,a=l.ajax(this.url(),{method:"POST",contentType:"application/json",data:JSON.stringify({content:e,source:n,type:i})}).done(function(t){s.add([t])}).fail(function(t,o,l){s.trigger("error",s,a,{},"Error copying contents",{type:i,id:e,source:n})});return a},matches:function(t){return this.filter(function(e){return e.matches(t)})},createHDCA:function(t,e,n,s){var a=this,o={list:i.HistoryListDatasetCollection,paired:i.HistoryPairDatasetCollection},l=new o[e]({history_id:this.historyId,name:n,element_identifiers:t});return l.save().done(function(t){a.add(l)}).fail(function(t,e,i){a.trigger("error",t,e,i)})},clone:function(){var t=a.Collection.prototype.clone.call(this);return t.historyId=this.historyId,t},print:function(){var t=this;t.each(function(e){t.debug(e),e.elements&&t.debug("\t elements:",e.elements)})},toString:function(){return["HistoryContents(",[this.historyId,this.length].join(),")"].join("")}});return{HistoryContents:d}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2),i(1))},function(t,e,i){var n,s;(function(a,o,l,r){n=[i(6),i(5)],s=function(t,e){"use strict";var i="list",n=a.View.extend(t.LoggableMixin).extend({_logNamespace:i,initialize:function(t){this.expanded=t.expanded||!1,this.log("\t expanded:",this.expanded),this.fxSpeed=void 0!==t.fxSpeed?t.fxSpeed:this.fxSpeed},fxSpeed:"fast",render:function(t){var e=this._buildNewRender();return this._setUpBehaviors(e),this._queueNewRender(e,t),this},_buildNewRender:function(){var t=o(this.templates.el(this.model.toJSON(),this));return this.expanded&&this.$details(t).replaceWith(this._renderDetails().show()),t},_queueNewRender:function(t,e){e=void 0===e?this.fxSpeed:e;var i=this;o(i).queue("fx",[function(t){this.$el.fadeOut(e,t)},function(e){i._swapNewRender(t),e()},function(t){this.$el.fadeIn(e,t)},function(t){this.trigger("rendered",i),t()}])},_swapNewRender:function(t){return this.$el.empty().attr("class",l.isFunction(this.className)?this.className():this.className).append(t.children())},_setUpBehaviors:function(t){t=t||this.$el,t.find("[title]").tooltip({placement:"bottom"})},$details:function(t){return t=t||this.$el,t.find("> .details")},_renderDetails:function(){var t=o(this.templates.details(this.model.toJSON(),this));return this._setUpBehaviors(t),t},toggleExpanded:function(t){return t=void 0===t?!this.expanded:t,t?this.expand():this.collapse(),this},expand:function(){var t=this;return t._fetchModelDetails().always(function(){t._expand()})},_fetchModelDetails:function(){return this.model.hasDetails()?r.when():this.model.fetch()},_expand:function(){var t=this,e=t._renderDetails();t.$details().replaceWith(e),t.expanded=!0,t.$details().slideDown({duration:t.fxSpeed,step:function(){t.trigger("expanding",t)},complete:function(){t.trigger("expanded",t)}})},collapse:function(){this.debug(this+"(ExpandableView).collapse");var t=this;t.expanded=!1,this.$details().slideUp({duration:t.fxSpeed,step:function(){t.trigger("collapsing",t)},complete:function(){t.trigger("collapsed",t)}})}}),s=n.extend(t.mixin(t.SelectableViewMixin,t.DraggableViewMixin,{tagName:"div",className:"list-item",initialize:function(e){n.prototype.initialize.call(this,e),t.SelectableViewMixin.initialize.call(this,e),t.DraggableViewMixin.initialize.call(this,e),this._setUpListeners()},_setUpListeners:function(){return this.on("selectable",function(t){t?this.$(".primary-actions").hide():this.$(".primary-actions").show()},this),this},_buildNewRender:function(){var t=n.prototype._buildNewRender.call(this);return t.children(".warnings").replaceWith(this._renderWarnings()),t.children(".title-bar").replaceWith(this._renderTitleBar()),t.children(".primary-actions").append(this._renderPrimaryActions()),t.find("> .title-bar .subtitle").replaceWith(this._renderSubtitle()),t},_swapNewRender:function(t){return n.prototype._swapNewRender.call(this,t),this.selectable&&this.showSelector(0),this.draggable&&this.draggableOn(),this.$el},_renderWarnings:function(){var t=this,e=o('<div class="warnings"></div>'),i=t.model.toJSON();return l.each(t.templates.warnings,function(n){e.append(o(n(i,t)))}),e},_renderTitleBar:function(){return o(this.templates.titleBar(this.model.toJSON(),this))},_renderPrimaryActions:function(){return[]},_renderSubtitle:function(){return o(this.templates.subtitle(this.model.toJSON(),this))},events:{"click .title-bar":"_clickTitleBar","keydown .title-bar":"_keyDownTitleBar","click .selector":"toggleSelect"},_clickTitleBar:function(t){t.stopPropagation(),t.altKey?(this.toggleSelect(t),this.selectable||this.showSelector()):this.toggleExpanded()},_keyDownTitleBar:function(t){var e=32,i=13;return!t||"keydown"!==t.type||t.keyCode!==e&&t.keyCode!==i||(this.toggleExpanded(),t.stopPropagation(),!1)},toString:function(){var t=this.model?this.model+"":"(no model)";return"ListItemView("+t+")"}}));s.prototype.templates=function(){var e=t.wrapTemplate(['<div class="list-element">','<div class="warnings"></div>','<div class="selector">','<span class="fa fa-2x fa-square-o"></span>',"</div>",'<div class="primary-actions"></div>','<div class="title-bar"></div>','<div class="details"></div>',"</div>"]),i={},n=t.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<span class="state-icon"></span>','<div class="title">','<span class="name"><%- element.name %></span>',"</div>",'<div class="subtitle"></div>',"</div>"],"element"),s=t.wrapTemplate(['<div class="subtitle"></div>']),a=t.wrapTemplate(['<div class="details"></div>']);return{el:e,warnings:i,titleBar:n,subtitle:s,details:a}}();var c=s.extend({foldoutStyle:"foldout",foldoutPanelClass:null,initialize:function(t){"drilldown"===this.foldoutStyle&&(this.expanded=!1),this.foldoutStyle=t.foldoutStyle||this.foldoutStyle,this.foldoutPanelClass=t.foldoutPanelClass||this.foldoutPanelClass,s.prototype.initialize.call(this,t),this.foldout=this._createFoldoutPanel()},_renderDetails:function(){if("drilldown"===this.foldoutStyle)return o();var t=s.prototype._renderDetails.call(this);return this._attachFoldout(this.foldout,t)},_createFoldoutPanel:function(){var t=this.model,e=this._getFoldoutPanelClass(t),i=this._getFoldoutPanelOptions(t),n=new e(l.extend(i,{model:t}));return n},_getFoldoutPanelClass:function(){return this.foldoutPanelClass},_getFoldoutPanelOptions:function(){return{foldoutStyle:this.foldoutStyle,fxSpeed:this.fxSpeed}},_attachFoldout:function(t,e){return e=e||this.$("> .details"),this.foldout=t.render(0),t.$("> .controls").hide(),e.append(t.$el)},expand:function(){var t=this;return t._fetchModelDetails().always(function(){"foldout"===t.foldoutStyle?t._expand():"drilldown"===t.foldoutStyle&&t._expandByDrilldown()})},_expandByDrilldown:function(){var t=this;t.listenTo(t.foldout,"close",function(){t.trigger("collapsed:drilldown",t,t.foldout)}),t.trigger("expanded:drilldown",t,t.foldout)}});return c.prototype.templates=function(){var e=t.wrapTemplate(['<div class="details">',"</div>"],"collection");return l.extend({},s.prototype.templates,{details:e})}(),{ExpandableView:n,ListItemView:s,FoldoutListItemView:c}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1),i(2),i(1))},function(t,e,i){var n,s;(function(a,o){n=[i(4),i(56),i(7),i(38),i(18),i(28)],s=function(t,e,i,n,s,l){return n.extend({initialize:function(t){var i=this;n.prototype.initialize.call(this,t),this.deferred=new e,t.inputs?this._buildForm(t):this.deferred.execute(function(e){i._buildModel(e,t,!0)})},remove:function(){var t=this;this.$el.hide(),this.deferred.execute(function(){n.prototype.remove.call(t),Galaxy.emit.debug("tool-form-base::remove()","Destroy view.")})},_buildForm:function(e){var i=this;this.options=t.merge(e,this.options),this.options=t.merge({icon:e.icon,title:"<b>"+e.name+"</b> "+e.description+" (Galaxy Version "+e.version+")",operations:this._operations(),onchange:function(){i.deferred.reset(),i.deferred.execute(function(t){i._updateModel(t)})}},this.options),this.options.customize&&this.options.customize(this.options),this.render(),this.options.collapsible||this.$el.append(a("<div/>").addClass("ui-margin-top-large").append(this._footer()))},_buildModel:function(e,n,s){var o=this;this.options.id=n.id,this.options.version=n.version;var l="",r={};n.job_id?l=Galaxy.root+"api/jobs/"+n.job_id+"/build_for_rerun":(l=Galaxy.root+"api/tools/"+n.id+"/build",Galaxy.params&&Galaxy.params.tool_id==n.id&&(r=a.extend({},Galaxy.params),n.version&&(r.tool_version=n.version))),t.get({url:l,data:r,success:function(t){return t=t.tool_model||t,t.display?(o._buildForm(t),!s&&o.message.update({status:"success",message:"Now you are using '"+o.options.name+"' version "+o.options.version+", id '"+o.options.id+"'.",persistent:!1}),Galaxy.emit.debug("tool-form-base::initialize()","Initial tool model ready.",t),void e.resolve()):void(window.location=Galaxy.root)},error:function(t,n){var s=t&&t.err_msg||"Uncaught error.";401==n.status?window.location=Galaxy.root+"user/login?"+a.param({redirect:Galaxy.root+"?tool_id="+o.options.id}):o.$el.is(":empty")?o.$el.prepend(new i.Message({message:s,status:"danger",persistent:!0,large:!0}).$el):Galaxy.modal&&Galaxy.modal.show({title:"Tool request failed",body:s,buttons:{Close:function(){Galaxy.modal.hide()}}}),Galaxy.emit.debug("tool-form::initialize()","Initial tool model request failed.",t),e.reject()}})},_updateModel:function(e){var i=this,n=this.options.update_url||Galaxy.root+"api/tools/"+this.options.id+"/build",s={tool_id:this.options.id,tool_version:this.options.version,inputs:a.extend(!0,{},i.data.create())};this.wait(!0),Galaxy.emit.debug("tool-form-base::_updateModel()","Sending current state.",s),t.request({type:"POST",url:n,data:s,success:function(t){i.update(t.tool_model||t),i.options.update&&i.options.update(t),i.wait(!1),Galaxy.emit.debug("tool-form-base::_updateModel()","Received new model.",t),e.resolve()},error:function(t){Galaxy.emit.debug("tool-form-base::_updateModel()","Refresh request failed.",t),e.reject()}})},_operations:function(){var t=this,e=this.options,n=new i.ButtonMenu({icon:"fa-cubes",title:!e.narrow&&"Versions"||null,tooltip:"Select another tool version"});if(!e.sustain_version&&e.versions&&e.versions.length>1)for(var s in e.versions){var a=e.versions[s];a!=e.version&&n.addMenu({title:"Switch to "+a,version:a,icon:"fa-cube",onclick:function(){var i=e.id.replace(e.version,this.version),n=this.version;t.deferred.reset(),t.deferred.execute(function(e){t._buildModel(e,{id:i,version:n})})}})}else n.$el.hide();var o=new i.ButtonMenu({icon:"fa-caret-down",title:!e.narrow&&"Options"||null,tooltip:"View available options"});return e.biostar_url&&(o.addMenu({icon:"fa-question-circle",title:"Question?",tooltip:"Ask a question about this tool (Biostar)",onclick:function(){window.open(e.biostar_url+"/p/new/post/")}}),o.addMenu({icon:"fa-search",title:"Search",tooltip:"Search help for this tool (Biostar)",onclick:function(){window.open(e.biostar_url+"/local/search/page/?q="+e.name)}})),o.addMenu({icon:"fa-share",title:"Share",tooltip:"Share this tool",onclick:function(){prompt("Copy to clipboard: Ctrl+C, Enter",window.location.origin+Galaxy.root+"root?tool_id="+e.id)}}),Galaxy.user&&Galaxy.user.get("is_admin")&&o.addMenu({icon:"fa-download",title:"Download",tooltip:"Download this tool",onclick:function(){window.location.href=Galaxy.root+"api/tools/"+e.id+"/download"}}),e.requirements&&e.requirements.length>0&&o.addMenu({icon:"fa-info-circle",title:"Requirements",tooltip:"Display tool requirements",onclick:function(){!this.visible||t.portlet.collapsed?(this.visible=!0,t.portlet.expand(),t.message.update({persistent:!0,message:t._templateRequirements(e),status:"info"})):(this.visible=!1,t.message.update({message:""}))}}),e.sharable_url&&o.addMenu({icon:"fa-external-link",title:"See in Tool Shed",tooltip:"Access the repository",onclick:function(){window.open(e.sharable_url)}}),{menu:o,versions:n}},_footer:function(){var t=this.options,e=a("<div/>").append(this._templateHelp(t));if(t.citations){var i=a("<div/>"),n=new s.ToolCitationCollection;n.tool_id=t.id;var o=new l.CitationListView({el:i,collection:n});o.render(),n.fetch(),e.append(i)}return e},_templateHelp:function(t){var e=a("<div/>").addClass("ui-form-help").append(t.help);return e.find("a").attr("target","_blank"),e},_templateRequirements:function(t){var e=t.requirements.length;if(e>0){var i="This tool requires ";o.each(t.requirements,function(t,n){i+=t.name+(t.version?" (Version "+t.version+")":"")+(n<e-2?", ":n==e-2?" and ":"")});var n=a("<a/>").attr("target","_blank").attr("href","https://wiki.galaxyproject.org/Tools/Requirements").text("here");return a("<span/>").append(i+". Click ").append(n).append(" for more information.")}return"No requirements found."}})}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(1),i(2))},function(t,e,i){var n,s;(function(a,o){n=[i(2),i(17),i(12),i(19)],s=function(t,e,i,n){"use strict";var s={hidden:!1,show:function(){this.set("hidden",!1)},hide:function(){this.set("hidden",!0)},toggle:function(){this.set("hidden",!this.get("hidden"))},is_visible:function(){return!this.attributes.hidden}},l=a.Model.extend({defaults:{name:null,label:null,type:null,value:null,html:null,num_samples:5},initialize:function(t){this.attributes.html=unescape(this.attributes.html)},copy:function(){return new l(this.toJSON())},set_value:function(t){this.set("value",t||"")}}),r=a.Collection.extend({model:l}),c=l.extend({}),d=l.extend({set_value:function(t){this.set("value",parseInt(t,10))},get_samples:function(){return d3.scale.linear().domain([this.get("min"),this.get("max")]).ticks(this.get("num_samples"))}}),h=d.extend({set_value:function(t){this.set("value",parseFloat(t))}}),u=l.extend({get_samples:function(){return t.map(this.get("options"),function(t){return t[0]})}});l.subModelTypes={integer:d,"float":h,data:c,select:u};var p=a.Model.extend({defaults:{id:null,name:null,description:null,target:null,inputs:[],outputs:[]},urlRoot:Galaxy.root+"api/tools",initialize:function(e){this.set("inputs",new r(t.map(e.inputs,function(t){var e=l.subModelTypes[t.type]||l;return new e(t)})))},toJSON:function(){var t=a.Model.prototype.toJSON.call(this);return t.inputs=this.get("inputs").map(function(t){return t.toJSON()}),t},remove_inputs:function(t){var e=this,i=e.get("inputs").filter(function(e){return t.indexOf(e.get("type"))!==-1});e.get("inputs").remove(i)},copy:function(t){var e=new p(this.toJSON());if(t){var i=new a.Collection;e.get("inputs").each(function(t){t.get_samples()&&i.push(t)}),e.set("inputs",i)}return e},apply_search_results:function(e){return t.indexOf(e,this.attributes.id)!==-1?this.show():this.hide(),this.is_visible()},set_input_value:function(t,e){this.get("inputs").find(function(e){return e.get("name")===t}).set("value",e)},set_input_values:function(e){var i=this;t.each(t.keys(e),function(t){i.set_input_value(t,e[t])})},run:function(){return this._run()},rerun:function(t,e){return this._run({action:"rerun",target_dataset_id:t.id,regions:e})},get_inputs_dict:function(){var t={};return this.get("inputs").each(function(e){t[e.get("name")]=e.get("value")}),t},_run:function(n){var s=t.extend({tool_id:this.id,inputs:this.get_inputs_dict()},n),a=o.Deferred(),l=new e.ServerStateDeferred({ajax_settings:{url:this.urlRoot,data:JSON.stringify(s),dataType:"json",contentType:"application/json",type:"POST"},interval:2e3,success_fn:function(t){return"pending"!==t}});return o.when(l.go()).then(function(t){a.resolve(new i.DatasetCollection(t))}),a}});t.extend(p.prototype,s);var g=(a.View.extend({}),a.Collection.extend({model:p})),f=a.Model.extend(s),m=a.Model.extend({defaults:{elems:[],open:!1},clear_search_results:function(){t.each(this.attributes.elems,function(t){t.show()}),this.show(),this.set("open",!1)},apply_search_results:function(e){var i,n=!0;t.each(this.attributes.elems,function(t){t instanceof f?(i=t,i.hide()):t instanceof p&&t.apply_search_results(e)&&(n=!1,i&&i.show())}),n?this.hide():(this.show(),this.set("open",!0))}});t.extend(m.prototype,s);var v=a.Model.extend({defaults:{search_hint_string:"search tools",min_chars_for_search:3,clear_btn_url:"",search_url:"",visible:!0,query:"",results:null,clear_key:27},urlRoot:Galaxy.root+"api/tools",initialize:function(){this.on("change:query",this.do_search)},do_search:function(){var t=this.attributes.query;if(t.length<this.attributes.min_chars_for_search)return void this.set("results",null);var e=t;this.timer&&clearTimeout(this.timer),o("#search-clear-btn").hide(),o("#search-spinner").show();var i=this;this.timer=setTimeout(function(){"undefined"!=typeof ga&&ga("send","pageview",Galaxy.root+"?q="+e),o.get(i.urlRoot,{q:e},function(t){i.set("results",t),o("#search-spinner").hide(),o("#search-clear-btn").show()},"json")},400)},clear_search:function(){this.set("query",""),this.set("results",null)}});t.extend(v.prototype,s);var _=a.Model.extend({initialize:function(t){this.attributes.tool_search=t.tool_search,this.attributes.tool_search.on("change:results",this.apply_search_results,this),this.attributes.tools=t.tools,this.attributes.layout=new a.Collection(this.parse(t.layout))},parse:function(e){var i=this,n=function(e){var s=e.model_class;if(s.indexOf("Tool")===s.length-4)return i.attributes.tools.get(e.id);if("ToolSection"===s){var a=t.map(e.elems,n);return e.elems=a,new m(e)}return"ToolSectionLabel"===s?new f(e):void 0};return t.map(e,n)},clear_search_results:function(){this.get("layout").each(function(t){t instanceof m?t.clear_search_results():t.show()})},apply_search_results:function(){var t=this.get("tool_search").get("results");if(null===t)return void this.clear_search_results();var e=null;this.get("layout").each(function(i){i instanceof f?(e=i,e.hide()):i instanceof p?i.apply_search_results(t)&&e&&e.show():(e=null,i.apply_search_results(t))})}}),y=a.View.extend({initialize:function(){this.model.on("change:hidden",this.update_visible,this),this.update_visible()},update_visible:function(){this.model.attributes.hidden?this.$el.hide():this.$el.show()}}),b=y.extend({tagName:"div",render:function(){var t=o("<div/>");t.append(S.tool_link(this.model.toJSON()));var e=this.model.get("form_style",null);if("upload1"===this.model.id)t.find("a").on("click",function(t){t.preventDefault(),Galaxy.upload.show()});else if("regular"===e){var i=this;t.find("a").on("click",function(t){t.preventDefault();var e=new n.View({id:i.model.id,version:i.model.get("version")});e.deferred.execute(function(){Galaxy.app.display(e)})})}return this.$el.append(t),this}}),w=y.extend({tagName:"div",className:"toolPanelLabel",render:function(){return this.$el.append(o("<span/>").text(this.model.attributes.text)),this}}),x=y.extend({tagName:"div",className:"toolSectionWrapper",initialize:function(){y.prototype.initialize.call(this),this.model.on("change:open",this.update_open,this)},render:function(){this.$el.append(S.panel_section(this.model.toJSON()));var e=this.$el.find(".toolSectionBody");return t.each(this.model.attributes.elems,function(t){if(t instanceof p){var i=new b({model:t,className:"toolTitle"});i.render(),e.append(i.$el)}else if(t instanceof f){var n=new w({model:t});n.render(),e.append(n.$el)}}),this},events:{"click .toolSectionTitle > a":"toggle"},toggle:function(){this.model.set("open",!this.model.attributes.open)},update_open:function(){this.model.attributes.open?this.$el.children(".toolSectionBody").slideDown("fast"):this.$el.children(".toolSectionBody").slideUp("fast")}}),C=a.View.extend({tagName:"div",id:"tool-search",className:"bar",events:{click:"focus_and_select","keyup :input":"query_changed","click #search-clear-btn":"clear"},render:function(){return this.$el.append(S.tool_search(this.model.toJSON())),this.model.is_visible()||this.$el.hide(),this.$el.find("[title]").tooltip(),this},focus_and_select:function(){this.$el.find(":input").focus().select()},clear:function(){return this.model.clear_search(),this.$el.find(":input").val(""),this.focus_and_select(),!1},query_changed:function(t){return this.model.attributes.clear_key&&this.model.attributes.clear_key===t.which?(this.clear(),!1):void this.model.set("query",this.$el.find(":input").val())}}),$=a.View.extend({tagName:"div",className:"toolMenu",initialize:function(){this.model.get("tool_search").on("change:results",this.handle_search_results,this)},render:function(){var t=this,e=new C({model:this.model.get("tool_search")});return e.render(),t.$el.append(e.$el),this.model.get("layout").each(function(e){if(e instanceof m){var i=new x({model:e});i.render(),t.$el.append(i.$el)}else if(e instanceof p){var n=new b({model:e,className:"toolTitleNoSection"});n.render(),t.$el.append(n.$el)}else if(e instanceof f){var s=new w({model:e});s.render(),t.$el.append(s.$el)}}),t.$el.find("a.tool-link").click(function(e){var i=o(this).attr("class").split(/\s+/)[0],n=t.model.get("tools").get(i);t.trigger("tool_link_click",e,n)}),this},handle_search_results:function(){var t=this.model.get("tool_search").get("results");t&&0===t.length?o("#search-no-results").show():o("#search-no-results").hide()}}),E=a.View.extend({className:"toolForm",render:function(){this.$el.children().remove(),this.$el.append(S.tool_form(this.model.toJSON()))}}),S=(a.View.extend({className:"toolMenuAndView",initialize:function(){this.tool_panel_view=new $({collection:this.collection}),this.tool_form_view=new E},render:function(){this.tool_panel_view.render(),this.tool_panel_view.$el.css("float","left"),this.$el.append(this.tool_panel_view.$el),this.tool_form_view.$el.hide(),this.$el.append(this.tool_form_view.$el);var t=this;this.tool_panel_view.on("tool_link_click",function(e,i){e.preventDefault(),t.show_tool(i)})},show_tool:function(t){var e=this;t.fetch().done(function(){e.tool_form_view.model=t,e.tool_form_view.render(),e.tool_form_view.$el.show(),o("#left").width("650px")})}}),{tool_search:t.template(['<input id="tool-search-query" class="search-query parent-width" name="query" ','placeholder="<%- search_hint_string %>" autocomplete="off" type="text" />','<a id="search-clear-btn" title="clear search (esc)"> </a>','<span id="search-spinner" class="search-spinner fa fa-spinner fa-spin"></span>'].join("")),panel_section:t.template(['<div class="toolSectionTitle" id="title_<%- id %>">','<a href="javascript:void(0)"><span><%- name %></span></a>',"</div>",'<div id="<%- id %>" class="toolSectionBody" style="display: none;">','<div class="toolSectionBg"></div>',"<div>"].join("")),tool_link:t.template(['<span class="labels">',"<% _.each( labels, function( label ){ %>",'<span class="label label-default label-<%- label %>">',"<%- label %>","</span>","<% }); %>","</span>",'<a class="<%- id %> tool-link" href="<%= link %>" target="<%- target %>" minsizehint="<%- min_width %>">',"<%- name %>","</a>"," <%- description %>"].join("")),tool_form:t.template(['<div class="toolFormTitle"><%- tool.name %> (version <%- tool.version %>)</div>','<div class="toolFormBody">',"<% _.each( tool.inputs, function( input ){ %>",'<div class="form-row">','<label for="<%- input.name %>"><%- input.label %>:</label>','<div class="form-row-input">',"<%= input.html %>","</div>",'<div class="toolParamHelp" style="clear: both;">',"<%- input.help %>","</div>",'<div style="clear: both;"></div>',"</div>","<% }); %>","</div>",'<div class="form-row form-actions">','<input type="submit" class="btn btn-primary" name="runtool_btn" value="Execute" />',"</div>",'<div class="toolHelp">','<div class="toolHelpBody"><% tool.help %></div>',"</div>"].join(""),{variable:"tool"})});return{ToolParameter:l,IntegerToolParameter:d,SelectToolParameter:u,Tool:p,ToolCollection:g,ToolSearch:v,ToolPanel:_,ToolPanelView:$,ToolFormView:E}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1))},,function(t,e,i){var n,s;(function(i,a,o,l){n=[],s=function(){var t=i.View.extend({initialize:function(t,e){this.$button=t,this.$button.length||(this.$button=a("<div/>")),this.options=e||[],this.$button.data("popupmenu",this);var i=this;this.$button.click(function(t){return a(".popmenu-wrapper").remove(),i._renderAndShow(t),!1})},_renderAndShow:function(t){this.render(),this.$el.appendTo("body").css(this._getShownPosition(t)).show(),this._setUpCloseBehavior()},render:function(){if(this.$el.addClass("popmenu-wrapper").hide().css({position:"absolute"}).html(this.template(this.$button.attr("id"),this.options)),this.options.length){var t=this;this.$el.find("li").each(function(e,i){var n=t.options[e];n.func&&a(this).children("a.popupmenu-option").click(function(e){n.func.call(t,e,n),e.preventDefault()})})}return this},template:function(t,e){return['<ul id="',t,'-menu" class="dropdown-menu">',this._templateOptions(e),"</ul>"].join("")},_templateOptions:function(t){return t.length?o.map(t,function(t){if(t.divider)return'<li class="divider"></li>';if(t.header)return['<li class="head"><a href="javascript:void(0);">',t.html,"</a></li>"].join("");var e=t.href||"javascript:void(0);",i=t.target?' target="'+t.target+'"':"",n=t.checked?'<span class="fa fa-check"></span>':"";return['<li><a class="popupmenu-option" href="',e,'"',i,">",n,t.html,"</a></li>"].join("")}).join(""):"<li>(no options)</li>"},_getShownPosition:function(t){var e=this.$el.width(),i=t.pageX-e/2;return i=Math.min(i,a(document).scrollLeft()+a(window).width()-e-5),i=Math.max(i,a(document).scrollLeft()+5),{top:t.pageY,left:i}},_setUpCloseBehavior:function(){function t(t){if(a(document).off("click.close_popup"),window&&window.parent!==window)try{a(window.parent.document).off("click.close_popup")}catch(i){}else try{a("iframe#galaxy_main").contents().off("click.close_popup")}catch(i){}e.remove()}var e=this;if(a("html").one("click.close_popup",t),window&&window.parent!==window)try{a(window.parent.document).find("html").one("click.close_popup",t)}catch(i){}else try{a("iframe#galaxy_main").contents().one("click.close_popup",t)}catch(i){}},addItem:function(t,e){return e=e>=0?e:this.options.length,this.options.splice(e,0,t),this},removeItem:function(t){return t>=0&&this.options.splice(t,1),this},findIndexByHtml:function(t){for(var e=0;e<this.options.length;e++)if(o.has(this.options[e],"html")&&this.options[e].html===t)return e;return null},findItemByHtml:function(t){return this.options[this.findIndexByHtml(t)]},toString:function(){return"PopupMenu"}});return t.create=function(e,i){return new t(e,i)},t.make_popupmenu=function(e,i){var n=[];return o.each(i,function(t,e){var i={html:e};null===t?i.header=!0:"function"===l.type(t)&&(i.func=t),n.push(i)}),new t(a(e),n)},t.convertLinksToOptions=function(t,e){t=a(t),e=e||"a";var i=[];return t.find(e).each(function(t,e){var n={},s=a(t);if(n.html=s.text(),s.attr("href")){var o=s.attr("href"),l=s.attr("target"),r=s.attr("confirm");n.func=function(){if(!r||confirm(r))switch(l){case"_parent":window.parent.location=o;break;case"_top":window.top.location=o;break;default:window.location=o}}}i.push(n)}),i},t.fromExistingDom=function(e,i,n){e=a(e),i=a(i);var s=t.convertLinksToOptions(i,n);return i.remove(),new t(e,s)},t.make_popup_menus=function(e,i,n){e=e||document,i=i||"div[popupmenu]",n=n||function(t,e){return"#"+t.attr("popupmenu")};var s=[];return a(e).find(i).each(function(){var i=a(this),o=a(e).find(n(i,e));s.push(t.fromDom(o,i)),o.addClass("popup")}),s},t}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1),i(2),i(1))},function(t,e,i){var n,s;(function(a,o){n=[i(4)],s=function(t){return a.View.extend({colors:{standard:["c00000","ff0000","ffc000","ffff00","92d050","00b050","00b0f0","0070c0","002060","7030a0"],base:["ffffff","000000","eeece1","1f497d","4f81bd","c0504d","9bbb59","8064a2","4bacc6","f79646"],theme:[["f2f2f2","7f7f7f","ddd9c3","c6d9f0","dbe5f1","f2dcdb","ebf1dd","e5e0ec","dbeef3","fdeada"],["d8d8d8","595959","c4bd97","8db3e2","b8cce4","e5b9b7","d7e3bc","ccc1d9","b7dde8","fbd5b5"],["bfbfbf","3f3f3f","938953","548dd4","95b3d7","d99694","c3d69b","b2a2c7","92cddc","fac08f"],["a5a5a5","262626","494429","17365d","366092","953734","76923c","5f497a","31859b","e36c09"],["7f7f7e","0c0c0c","1d1b10","0f243e","244061","632423","4f6128","3f3151","205867","974806"]]},initialize:function(e){this.options=t.merge(e,{}),this.setElement(this._template()),this.$panel=this.$(".ui-color-picker-panel"),this.$view=this.$(".ui-color-picker-view"),this.$value=this.$(".ui-color-picker-value"),this.$header=this.$(".ui-color-picker-header"),this._build(),this.visible=!1,this.value(this.options.value),this.$boxes=this.$(".ui-color-picker-box");var i=this;this.$boxes.on("click",function(){i.value(o(this).css("background-color")),i.$header.trigger("click")}),this.$header.on("click",function(){i.visible=!i.visible,i.visible?i.$view.fadeIn("fast"):i.$view.fadeOut("fast")})},value:function(t){return void 0!==t&&null!==t&&(this.$value.css("background-color",t),this.$(".ui-color-picker-box").empty(),this.$(this._getValue()).html(this._templateCheck()),this.options.onchange&&this.options.onchange(t)),this._getValue()},_getValue:function(){function t(t){return("0"+parseInt(t).toString(16)).slice(-2)}var e=this.$value.css("background-color");return e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),e?"#"+t(e[1])+t(e[2])+t(e[3]):null},_build:function(){this._content({label:"Theme Colors",colors:this.colors.base,padding:10});for(var t in this.colors.theme){var e={};0==t?e.bottom=!0:t!=this.colors.theme.length-1?(e.top=!0,e.bottom=!0):(e.top=!0,e.padding=5),e.colors=this.colors.theme[t],this._content(e)}this._content({label:"Standard Colors",colors:this.colors.standard,padding:5})},_content:function(t){var e=(t.label,t.colors),i=t.padding,n=t.top,s=t.bottom,a=o(this._templateContent()),l=a.find(".label");t.label?l.html(t.label):l.hide();var r=a.find(".line");this.$panel.append(a);for(var c in e){var d=o(this._templateBox(e[c]));n&&(d.css("border-top","none"),d.css("border-top-left-radius","0px"),d.css("border-top-right-radius","0px")),s&&(d.css("border-bottom","none"),d.css("border-bottom-left-radius","0px"),d.css("border-bottom-right-radius","0px")),r.append(d)}return i&&r.css("padding-bottom",i),a},_templateCheck:function(){return'<div class="ui-color-picker-check fa fa-check"/>'},_templateContent:function(){return'<div class="ui-color-picker-content"><div class="label"/><div class="line"/></div>'},_templateBox:function(t){return'<div id="'+t+'" class="ui-color-picker-box" style="background-color: #'+t+';"/>'},_template:function(){return'<div class="ui-color-picker"><div class="ui-color-picker-header"><div class="ui-color-picker-value"/><div class="ui-color-picker-label">Select a color</div></div><div class="ui-color-picker-view ui-input"><div class="ui-color-picker-panel"/></div>';
}})}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1))},function(t,e,n){var s,a;(function(o,l){s=[n(4),n(21)],a=function(t,e){var n=e.BaseIcons.extend({initialize:function(t){t.type=t.display||"checkbox",t.multiple="checkbox"==t.type,e.BaseIcons.prototype.initialize.call(this,t)},_setValue:function(t){if(e.BaseIcons.prototype._setValue.call(this,t),void 0!==t&&null!==t&&this.header_index){var i=this,n=o.isArray(t)?t:[t];l.each(n,function(t){var e=i.header_index[t];l.each(e,function(t){i._setState(t,!0)})})}},_setState:function(t,e){var i=this.$(".button-"+t),n=this.$(".subgroup-"+t);i.data("is_expanded",e),e?(n.show(),i.removeClass("fa-plus-square").addClass("fa-minus-square")):(n.hide(),i.removeClass("fa-minus-square").addClass("fa-plus-square"))},_templateOptions:function(){function e(t,e){var i=t.find(".button-"+e);i.on("click",function(){s._setState(e,!i.data("is_expanded"))})}function n(a,l,r){r=r||[];for(i in l){var c=l[i],d=c.options&&c.options.length>0,h=r.slice(0);s.header_index[c.value]=h.slice(0);var u=o("<div/>");if(d){var p=t.uid(),g=o("<span/>").addClass("button-"+p).addClass("ui-drilldown-button fa fa-plus-square"),f=o("<div/>").addClass("subgroup-"+p).addClass("ui-drilldown-subgroup");u.append(o("<div/>").append(g).append(s._templateOption({label:c.name,value:c.value}))),h.push(p),n(f,c.options,h),u.append(f),e(u,p)}else u.append(s._templateOption({label:c.name,value:c.value}));a.append(u)}}var s=this;this.header_index={};var a=o("<div/>");return n(a,this.model.get("data")),a},_template:function(){return o("<div/>").addClass("ui-options-list drilldown-container").attr("id",this.model.id)}});return{View:n}}.apply(e,s),!(void 0!==a&&(t.exports=a))}).call(e,n(1),n(2))},function(t,e,i){var n,s;(function(a,o,l){n=[i(4),i(7),i(22)],s=function(t,e,i){var n={DISABLED:"disabled",ENABLED:"enabled",LINKED:"linked"},s={data:[{src:"hda",icon:"fa-file-o",tooltip:"Single dataset",multiple:!1,batch:n.DISABLED},{src:"hda",icon:"fa-files-o",tooltip:"Multiple datasets",multiple:!0,batch:n.LINKED},{src:"hdca",icon:"fa-folder-o",tooltip:"Dataset collection",multiple:!1,batch:n.LINKED}],data_multiple:[{src:"hda",icon:"fa-files-o",tooltip:"Multiple datasets",multiple:!0,batch:n.DISABLED},{src:"hdca",icon:"fa-folder-o",tooltip:"Dataset collection",multiple:!1,batch:n.DISABLED}],data_collection:[{src:"hdca",icon:"fa-folder-o",tooltip:"Dataset collection",multiple:!1,batch:n.DISABLED}],workflow_data:[{src:"hda",icon:"fa-file-o",tooltip:"Single dataset",multiple:!1,batch:n.DISABLED}],workflow_data_multiple:[{src:"hda",icon:"fa-files-o",tooltip:"Multiple datasets",multiple:!0,batch:n.DISABLED}],workflow_data_collection:[{src:"hdca",icon:"fa-folder-o",tooltip:"Dataset collection",multiple:!1,batch:n.DISABLED}],module_data:[{src:"hda",icon:"fa-file-o",tooltip:"Single dataset",multiple:!1,batch:n.DISABLED},{src:"hda",icon:"fa-files-o",tooltip:"Multiple datasets",multiple:!0,batch:n.ENABLED}],module_data_collection:[{src:"hdca",icon:"fa-folder-o",tooltip:"Dataset collection",multiple:!1,batch:n.DISABLED},{src:"hdca",icon:"fa-folder",tooltip:"Multiple collections",multiple:!0,batch:n.ENABLED}]},r=a.View.extend({initialize:function(t){var i=this;this.model=t&&t.model||new a.Model({src_labels:{hda:"dataset",hdca:"dataset collection"},pagelimit:100}).set(t),this.setElement(o("<div/>").addClass("ui-select-content")),this.button_product=new e.RadioButton.View({value:"false",data:[{icon:"fa fa-chain",value:"false",tooltip:"Linked inputs will be run in matched order with other datasets e.g. use this for matching forward and reverse reads."},{icon:"fa fa-chain-broken",value:"true",tooltip:"Unlinked dataset inputs will be run against *all* other inputs."}]});var n=o("<div/>").addClass("ui-form-info").append(o("<i/>").addClass("fa fa-sitemap")).append(o("<span/>").html("This is a batch mode input field. Separate jobs will be triggered for each dataset selection."));this.$batch={linked:n.clone(),enabled:n.clone().append(o("<div/>").append(o("<div/>").addClass("ui-form-title").html("Batch options:")).append(this.button_product.$el)).append(o("<div/>").css("clear","both"))},this.history={},this.listenTo(this.model,"change:data",this._changeData,this),this.listenTo(this.model,"change:wait",this._changeWait,this),this.listenTo(this.model,"change:current",this._changeCurrent,this),this.listenTo(this.model,"change:value",this._changeValue,this),this.listenTo(this.model,"change:type change:optional change:multiple change:extensions",this._changeType,this),this.render(),this.on("change",function(){t.onchange&&t.onchange(i.value())})},render:function(){this._changeType(),this._changeValue(),this._changeWait()},wait:function(){this.model.set("wait",!0)},unwait:function(){this.model.set("wait",!1)},update:function(t){this.model.set("data",t)},value:function(t){void 0!==t&&this.model.set("value",t);var e=this.model.get("current");if(this.config[e]){var i=this.fields[e].value();if(null!==i&&(i=o.isArray(i)?i:[i],i.length>0)){var n=this._batch({values:[]});for(var s in i){var a=this.history[i[s]+"_"+this.config[e].src];if(!a)return Galaxy.emit.debug("ui-select-content::value()","Requested details not found for '"+i[s]+"'."),null;n.values.push(a)}return n.values.sort(function(t,e){return t.hid-e.hid}),n}}else Galaxy.emit.debug("ui-select-content::value()","Invalid value/source '"+t+"'.");return null},_changeCurrent:function(){var t=this;l.each(this.fields,function(e,i){t.model.get("current")==i?(e.$el.show(),l.each(t.$batch,function(e,n){e[t.config[i].batch==n?"show":"hide"]()}),t.button_type.value(i)):e.$el.hide()})},_changeType:function(){var n=this,a=(this.model.get("flavor")?this.model.get("flavor")+"_":"")+String(this.model.get("type"))+(this.model.get("multiple")?"_multiple":"");s[a]?this.config=s[a]:(this.config=s.data,Galaxy.emit.debug("ui-select-content::_changeType()","Invalid configuration/type id '"+a+"'."));var o=n.model.get("data"),r=t.textify(this.model.get("extensions")),c=this.model.get("src_labels");this.fields=[],this.button_data=[],l.each(this.config,function(t,e){n.button_data.push({value:e,icon:t.icon,tooltip:t.tooltip}),n.fields.push(new i.View({optional:n.model.get("optional"),multiple:t.multiple,searchable:!t.multiple||o&&o[t.src]&&o[t.src].length>n.model.get("pagelimit"),selectall:!1,error_text:"No "+(r?r+" ":"")+(c[t.src]||"content")+" available.",onchange:function(){n.trigger("change")}}))}),this.button_type=new e.RadioButton.View({value:this.model.get("current"),data:this.button_data,onchange:function(t){n.model.set("current",t),n.trigger("change")}}),this.$el.empty();var d=0;this.fields.length>1&&(this.$el.append(this.button_type.$el),d=Math.max(0,35*this.fields.length)+"px"),l.each(this.fields,function(t){n.$el.append(t.$el.css({"margin-left":d}))}),l.each(this.$batch,function(t,e){n.$el.append(t.css({"margin-left":d}))}),this.model.set("current",0),this._changeCurrent(),this._changeData()},_changeWait:function(){var t=this;l.each(this.fields,function(e){e[t.model.get("wait")?"wait":"unwait"]()})},_changeData:function(){var t=this.model.get("data"),e=this,i={};l.each(t,function(t,n){i[n]=[],l.each(t,function(t){i[n].push({hid:t.hid,label:t.hid+": "+t.name,value:t.id}),e.history[t.id+"_"+n]=t})}),l.each(this.config,function(t,n){i[t.src]&&e.fields[n].add(i[t.src],function(t,e){return e.hid-t.hid})})},_changeValue:function(){var t=this.model.get("value");if(t&&t.values&&t.values.length>0){var e=[];l.each(t.values,function(t){e.push(t.id)});for(var i=t.values[0].src,n=t.values.length>1,s=0;s<this.config.length;s++){var a=this.fields[s],o=this.config[s];if(o.src==i&&[n,!0].indexOf(o.multiple)!==-1){this.model.set("current",s),a.value(e);break}}}else l.each(this.fields,function(t){t.value(null)})},_batch:function(t){t.batch=!1;var e=this.model.get("current"),i=this.config[e];if("hdca"==i.src&&!i.multiple){var s=this.history[this.fields[e].value()+"_hdca"];s&&s.map_over_type&&(t.batch=!0)}return i.batch!=n.LINKED&&i.batch!=n.ENABLED||(t.batch=!0,i.batch==n.ENABLED&&"true"===this.button_product.value()&&(t.product=!0)),t}});return{View:r}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1),i(2))},function(t,e,i){var n,s;(function(a){n=[i(4),i(20)],s=function(t,e){var i=a.View.extend({initialize:function(i){var n=this;this.ftpfile_list=new e.View({name:"file",optional:i.optional,multiple:i.multiple,onchange:function(){i.onchange&&i.onchange(n.value())}}),this.setElement(this.ftpfile_list.$el),t.get({url:Galaxy.root+"api/remote_files",success:function(t){var e=[];for(var i in t)e.push({value:t[i].path,label:t[i].path});n.ftpfile_list.update(e)}})},value:function(t){return this.ftpfile_list.value(t)}});return{View:i}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3))},function(t,e,i){var n,s;(function(a){n=[i(4),i(7),i(14),i(20)],s=function(t,e,i,n){var s=a.Collection.extend({url:Galaxy.root+"api/libraries?deleted=false"}),o=a.Collection.extend({initialize:function(){var t=this;this.config=new a.Model({library_id:null}),this.config.on("change",function(){t.fetch({reset:!0})})},url:function(){return Galaxy.root+"api/libraries/"+this.config.get("library_id")+"/contents"}}),l=a.View.extend({initialize:function(t){var i=this;this.libraries=new s,this.datasets=new o,this.options=t,this.library_select=new e.Select.View({onchange:function(t){i.datasets.config.set("library_id",t)}}),this.dataset_list=new n.View({name:"dataset",optional:t.optional,multiple:t.multiple,onchange:function(){i.trigger("change")}}),this.libraries.on("reset",function(){var t=[];i.libraries.each(function(e){t.push({value:e.id,label:e.get("name")})}),i.library_select.update(t)}),this.datasets.on("reset",function(){var t=[],e=i.library_select.text();null!==e&&i.datasets.each(function(e){"file"===e.get("type")&&t.push({value:e.id,label:e.get("name")})}),i.dataset_list.update(t)}),this.on("change",function(){t.onchange&&t.onchange(i.value())}),this.setElement(this._template()),this.$(".library-select").append(this.library_select.$el),this.$el.append(this.dataset_list.$el),this.libraries.fetch({reset:!0,success:function(){i.library_select.trigger("change"),void 0!==i.options.value&&i.value(i.options.value)}})},value:function(t){return this.dataset_list.value(t)},_template:function(){return'<div class="ui-select-library"><div class="library ui-margin-bottom"><span class="library-title">Select Library</span><span class="library-select"/></div></div>'}});return{View:l}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3))},function(t,e,i){var n,s;(function(a,o){n=[i(4)],s=function(t){var e=a.View.extend({initialize:function(e){var i=this;this.options=t.merge(e,{id:t.uid(),min:null,max:null,step:null,precise:!1,split:1e4}),this.setElement(this._template(this.options)),this.useslider=null!==this.options.max&&null!==this.options.min&&this.options.max>this.options.min,null===this.options.step&&(this.options.step=1,this.options.precise&&this.useslider&&(this.options.step=(this.options.max-this.options.min)/this.options.split)),this.useslider?(this.$slider=this.$("#slider"),this.$slider.slider(this.options),this.$slider.on("slide",function(t,e){i.value(e.value)})):this.$(".ui-form-slider-text").css("width","100%"),this.$text=this.$("#text"),void 0!==this.options.value&&this.value(this.options.value);var n=[];this.$text.on("change",function(){i.value(o(this).val())}),this.$text.on("keyup",function(t){n[t.which]=!1,i.options.onchange&&i.options.onchange(o(this).val())}),this.$text.on("keydown",function(t){var e=t.which;n[e]=!0,i.options.is_workflow&&n[16]&&52==e?(i.value("$"),event.preventDefault()):8==e||9==e||13==e||37==e||39==e||e>=48&&e<=57&&!n[16]||e>=96&&e<=105||(190==e||110==e)&&o(this).val().indexOf(".")==-1&&i.options.precise||(189==e||109==e)&&o(this).val().indexOf("-")==-1||i._isParameter(o(this).val())||n[91]||n[17]||event.preventDefault()})},value:function(t){return void 0!==t&&(null===t||""===t||this._isParameter(t)||(isNaN(t)&&(t=0),null!==this.options.max&&(t=Math.min(t,this.options.max)),null!==this.options.min&&(t=Math.max(t,this.options.min))),this.$slider&&this.$slider.slider("value",t),this.$text.val(t),this.options.onchange&&this.options.onchange(t)),this.$text.val()},_isParameter:function(t){return this.options.is_workflow&&"$"===String(t).substring(0,1)},_template:function(t){return'<div id="'+t.id+'" class="ui-form-slider"><input id="text" type="text" class="ui-form-slider-text"/><div id="slider" class="ui-form-slider-element"/></div>'}});return{View:e}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1))},function(t,e,i){var n,s;(function(i){n=[],s=function(){var t=i.Model.extend({defaults:{extension:"auto",genome:"?",url_paste:"",status:"init",info:null,file_name:"",file_mode:"",file_size:0,file_type:null,file_path:"",file_data:null,percentage:0,space_to_tab:!1,to_posix_lines:!0,enabled:!0},reset:function(t){this.clear().set(this.defaults).set(t)}}),e=i.Collection.extend({model:t});return{Model:t,Collection:e}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3))},,,function(t,e,i){var n,s;(function(a,o){n=[i(4)],s=function(t){return a.Model.extend({initialize:function(){this.active={},this.last=null},execute:function(e){var i=this,n=t.uid(),s=e.length>0;this.active[n]=!0;var a=o.Deferred();a.promise().always(function(){delete i.active[n],s&&Galaxy.emit.debug("deferred::execute()",this.state().charAt(0).toUpperCase()+this.state().slice(1)+" "+n)}),o.when(this.last).always(function(){i.active[n]?(s&&Galaxy.emit.debug("deferred::execute()","Running "+n),e(a),!s&&a.resolve()):a.reject()}),this.last=a.promise()},reset:function(){Galaxy.emit.debug("deferred::execute()","Reset");for(var t in this.active)this.active[t]=!1},ready:function(){return o.isEmptyObject(this.active)}})}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1))},,,,,,,,,,,,function(t,e,i){var n,s;(function(a,o){n=[i(6),i(5),i(16)],s=function(t,e){var i=a.View.extend(t.LoggableMixin).extend(t.HiddenUntilActivatedViewMixin).extend({tagName:"div",className:"annotation-display",initialize:function(t){t=t||{},this.tooltipConfig=t.tooltipConfig||{placement:"bottom"},this.listenTo(this.model,"change:annotation",function(){this.render()}),this.hiddenUntilActivated(t.$activator,t)},render:function(){var t=this;return this.$el.html(this._template()),this.$el.find("[title]").tooltip(this.tooltipConfig),this.$annotation().make_text_editable({use_textarea:!0,on_finish:function(e){t.$annotation().text(e),t.model.save({annotation:e},{silent:!0}).fail(function(){t.$annotation().text(t.model.previous("annotation"))})}}),this},_template:function(){var t=this.model.get("annotation");return['<label class="prompt">',e("Annotation"),"</label>",'<div class="annotation" title="',e("Edit annotation"),'">',o.escape(t),"</div>"].join("")},$annotation:function(){return this.$el.find(".annotation")},remove:function(){this.$annotation.off(),this.stopListening(this.model),a.View.prototype.remove.call(this)},toString:function(){return["AnnotationEditor(",this.model+"",")"].join("")}});return{AnnotationEditor:i}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2))},function(t,e,i){var n,s;(function(a){n=[i(76),i(30),i(29),i(6),i(5)],s=function(t,e,i,n,s){"use strict";var o="collections",l=t.ModelListPanel,r=l.extend({_logNamespace:o,className:l.prototype.className+" dataset-collection-panel",DatasetDCEViewClass:i.DatasetDCEListItemView,NestedDCDCEViewClass:i.NestedDCDCEListItemView,modelCollectionKey:"elements",initialize:function(t){l.prototype.initialize.call(this,t),this.linkTarget=t.linkTarget||"_blank",this.hasUser=t.hasUser,this.panelStack=[],this.parentName=t.parentName,this.foldoutStyle=t.foldoutStyle||"foldout"},_filterCollection:function(){return this.model.getVisibleContents()},_getItemViewClass:function(t){switch(t.get("element_type")){case"hda":return this.DatasetDCEViewClass;case"dataset_collection":return this.NestedDCDCEViewClass}throw new TypeError("Unknown element type:",t.get("element_type"))},_getItemViewOptions:function(t){var e=l.prototype._getItemViewOptions.call(this,t);return a.extend(e,{linkTarget:this.linkTarget,hasUser:this.hasUser,foldoutStyle:this.foldoutStyle})},_setUpItemViewListeners:function(t){var e=this;return l.prototype._setUpItemViewListeners.call(e,t),e.listenTo(t,{"expanded:drilldown":function(t,e){this._expandDrilldownPanel(e)},"collapsed:drilldown":function(t,e){this._collapseDrilldownPanel(e)}}),this},_expandDrilldownPanel:function(t){this.panelStack.push(t),this.$("> .controls").add(this.$list()).hide(),t.parentName=this.model.get("name"),this.$el.append(t.render().$el)},_collapseDrilldownPanel:function(t){this.panelStack.pop(),this.render()},events:{"click .navigation .back":"close"},close:function(t){this.$el.remove(),this.trigger("close")},toString:function(){return"CollectionView("+(this.model?this.model.get("name"):"")+")"}});r.prototype.templates=function(){var t=n.wrapTemplate(['<div class="controls">','<div class="navigation">','<a class="back" href="javascript:void(0)">','<span class="fa fa-icon fa-angle-left"></span>',s("Back to "),"<%- view.parentName %>","</a>","</div>",'<div class="title">','<div class="name"><%- collection.name || collection.element_identifier %></div>','<div class="subtitle">','<% if( collection.collection_type === "list" ){ %>',s("a list of datasets"),'<% } else if( collection.collection_type === "paired" ){ %>',s("a pair of datasets"),'<% } else if( collection.collection_type === "list:paired" ){ %>',s("a list of paired datasets"),'<% } else if( collection.collection_type === "list:list" ){ %>',s("a list of dataset lists"),"<% } %>","</div>","</div>","</div>"],"collection");return a.extend(a.clone(l.prototype.templates),{controls:t})}();var c=r.extend({DatasetDCEViewClass:i.DatasetDCEListItemView,toString:function(){return"ListCollectionView("+(this.model?this.model.get("name"):"")+")"}}),d=c.extend({toString:function(){return"PairCollectionView("+(this.model?this.model.get("name"):"")+")"}}),h=r.extend({NestedDCDCEViewClass:i.NestedDCDCEListItemView.extend({foldoutPanelClass:d}),toString:function(){return"ListOfPairsCollectionView("+(this.model?this.model.get("name"):"")+")"}}),u=r.extend({NestedDCDCEViewClass:i.NestedDCDCEListItemView.extend({foldoutPanelClass:d}),toString:function(){return"ListOfListsCollectionView("+(this.model?this.model.get("name"):"")+")"}});return{CollectionView:r,ListCollectionView:c,PairCollectionView:d,ListOfPairsCollectionView:h,ListOfListsCollectionView:u}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(2))},function(t,e,i){var n,s;(function(a,o){n=[i(10),i(32),i(77),i(68),i(23),i(6),i(5)],s=function(t,e,n,s,l,r,c){"use strict";var d=e.DatasetListItemView,h=d.extend({initialize:function(t){d.prototype.initialize.call(this,t),this.hasUser=t.hasUser,this.purgeAllowed=t.purgeAllowed||!1,this.tagsEditorShown=t.tagsEditorShown||!1,this.annotationEditorShown=t.annotationEditorShown||!1},_renderPrimaryActions:function(){var e=d.prototype._renderPrimaryActions.call(this);return this.model.get("state")===t.NOT_VIEWABLE?e:d.prototype._renderPrimaryActions.call(this).concat([this._renderEditButton(),this._renderDeleteButton()])},_renderEditButton:function(){if(this.model.get("state")===t.DISCARDED||!this.model.get("accessible"))return null;var e=this.model.get("purged"),i=this.model.get("deleted"),n={title:c("Edit attributes"),href:this.model.urls.edit,target:this.linkTarget,faIcon:"fa-pencil",classes:"edit-btn"};return i||e?(n.disabled=!0,e?n.title=c("Cannot edit attributes of datasets removed from disk"):i&&(n.title=c("Undelete dataset to edit attributes"))):a.contains([t.UPLOAD,t.NEW],this.model.get("state"))&&(n.disabled=!0,n.title=c("This dataset is not yet editable")),l(n)},_renderDeleteButton:function(){if(!this.model.get("accessible"))return null;var t=this,e=this.model.isDeletedOrPurged();return l({title:c(e?"Dataset is already deleted":"Delete"),disabled:e,faIcon:"fa-times",classes:"delete-btn",onclick:function(){t.$el.find(".icon-btn.delete-btn").trigger("mouseout"),t.model["delete"]()}})},_renderDetails:function(){var e=d.prototype._renderDetails.call(this),i=this.model.get("state");return!this.model.isDeletedOrPurged()&&a.contains([t.OK,t.FAILED_METADATA],i)&&(this._renderTags(e),this._renderAnnotation(e),this._makeDbkeyEditLink(e)),this._setUpBehaviors(e),e},_renderSecondaryActions:function(){var e=d.prototype._renderSecondaryActions.call(this);switch(this.model.get("state")){case t.UPLOAD:case t.NOT_VIEWABLE:return e;case t.ERROR:return e.unshift(this._renderErrButton()),e.concat([this._renderRerunButton()]);case t.OK:case t.FAILED_METADATA:return e.concat([this._renderRerunButton(),this._renderVisualizationsButton()])}return e.concat([this._renderRerunButton()])},_renderErrButton:function(){return l({title:c("View or report this error"),href:this.model.urls.report_error,classes:"report-error-btn",target:this.linkTarget,faIcon:"fa-bug"})},_renderRerunButton:function(){var t=this.model.get("creating_job");if(this.model.get("rerunnable"))return l({title:c("Run this job again"),href:this.model.urls.rerun,classes:"rerun-btn",target:this.linkTarget,faIcon:"fa-refresh",onclick:function(e){e.preventDefault(),!function(){var e=[i(19)];(function(e){var i=new e.View({job_id:t});i.deferred.execute(function(){Galaxy.app.display(i)})}).apply(null,e)}()}})},_renderVisualizationsButton:function(){var t=this.model.get("visualizations");if(this.model.isDeletedOrPurged()||!this.hasUser||!this.model.hasData()||a.isEmpty(t))return null;if(!a.isObject(t[0]))return this.warn("Visualizations have been switched off"),null;var e=o(this.templates.visualizations(t,this));return e.find('[target="galaxy_main"]').attr("target",this.linkTarget),this._addScratchBookFn(e.find(".visualization-link").addBack(".visualization-link")),e},_addScratchBookFn:function(t){t.click(function(t){Galaxy.frame&&Galaxy.frame.active&&(Galaxy.frame.add({title:"Visualization",url:o(this).attr("href")}),t.preventDefault(),t.stopPropagation())})},_renderTags:function(t){if(this.hasUser){var e=this;this.tagsEditor=new n.TagsEditor({model:this.model,el:t.find(".tags-display"),onshowFirstTime:function(){this.render()},onshow:function(){e.tagsEditorShown=!0},onhide:function(){e.tagsEditorShown=!1},$activator:l({title:c("Edit dataset tags"),classes:"tag-btn",faIcon:"fa-tags"}).appendTo(t.find(".actions .right"))}),this.tagsEditorShown&&this.tagsEditor.toggle(!0)}},_renderAnnotation:function(t){if(this.hasUser){var e=this;this.annotationEditor=new s.AnnotationEditor({model:this.model,el:t.find(".annotation-display"),onshowFirstTime:function(){this.render()},onshow:function(){e.annotationEditorShown=!0},onhide:function(){e.annotationEditorShown=!1},$activator:l({title:c("Edit dataset annotation"),classes:"annotate-btn",faIcon:"fa-comment"}).appendTo(t.find(".actions .right"))}),this.annotationEditorShown&&this.annotationEditor.toggle(!0)}},_makeDbkeyEditLink:function(t){if("?"===this.model.get("metadata_dbkey")&&!this.model.isDeletedOrPurged()){var e=o('<a class="value">?</a>').attr("href",this.model.urls.edit).attr("target",this.linkTarget);t.find(".dbkey .value").replaceWith(e)}},events:a.extend(a.clone(d.prototype.events),{"click .undelete-link":"_clickUndeleteLink","click .purge-link":"_clickPurgeLink","click .edit-btn":function(t){this.trigger("edit",this,t)},"click .delete-btn":function(t){this.trigger("delete",this,t)},"click .rerun-btn":function(t){this.trigger("rerun",this,t)},"click .report-err-btn":function(t){this.trigger("report-err",this,t)},"click .visualization-btn":function(t){this.trigger("visualize",this,t)},"click .dbkey a":function(t){this.trigger("edit",this,t)}}),_clickUndeleteLink:function(t){return this.model.undelete(),!1},_clickPurgeLink:function(t){return this.model.purge(),!1},toString:function(){var t=this.model?this.model+"":"(no model)";return"HDAEditView("+t+")"}});return h.prototype.templates=function(){var t=a.extend({},d.prototype.templates.warnings,{failed_metadata:r.wrapTemplate(['<% if( dataset.state === "failed_metadata" ){ %>','<div class="failed_metadata-warning warningmessagesmall">',c("An error occurred setting the metadata for this dataset"),'<br /><a href="<%- dataset.urls.edit %>" target="<%- view.linkTarget %>">',c("Set it manually or retry auto-detection"),"</a>","</div>","<% } %>"],"dataset"),deleted:r.wrapTemplate(["<% if( dataset.deleted && !dataset.purged ){ %>",'<div class="deleted-msg warningmessagesmall">',c("This dataset has been deleted"),'<br /><a class="undelete-link" href="javascript:void(0);">',c("Undelete it"),"</a>","<% if( view.purgeAllowed ){ %>",'<br /><a class="purge-link" href="javascript:void(0);">',c("Permanently remove it from disk"),"</a>","<% } %>","</div>","<% } %>"],"dataset")}),e=r.wrapTemplate(["<% if( visualizations.length === 1 ){ %>",'<a class="visualization-btn visualization-link icon-btn" href="<%- visualizations[0].href %>"',' target="<%- visualizations[0].target %>" title="',c("Visualize in"),' <%- visualizations[0].html %>">','<span class="fa fa-bar-chart-o"></span>',"</a>","<% } else { %>",'<div class="visualizations-dropdown dropdown">','<a class="visualization-btn icon-btn" data-toggle="dropdown" title="',c("Visualize"),'">','<span class="fa fa-bar-chart-o"></span>',"</a>",'<ul class="dropdown-menu" role="menu">',"<% _.each( visualizations, function( visualization ){ %>",'<li><a class="visualization-link" href="<%- visualization.href %>"',' target="<%- visualization.target %>">',"<%- visualization.html %>","</a></li>","<% }); %>","</ul>","</div>","<% } %>"],"visualizations");return a.extend({},d.prototype.templates,{warnings:t,visualizations:e})}(),{DatasetListItemEdit:h}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(2),i(1))},function(t,e,i){var n,s;(function(a,o,l){n=[i(10),i(6),i(5)],s=function(t,e,i){"use strict";var n="dataset",s=e.SearchableModelMixin,r=a.Model.extend(e.LoggableMixin).extend(e.mixin(s,{_logNamespace:n,defaults:{state:t.NEW,deleted:!1,purged:!1,name:"(unnamed dataset)",accessible:!0,data_type:"",file_ext:"",file_size:0,meta_files:[],misc_blurb:"",misc_info:"",tags:[]},initialize:function(e,i){this.debug(this+"(Dataset).initialize",e,i),
//!! this state is not in trans.app.model.Dataset.states - set it here -
this.get("accessible")||this.set("state",t.NOT_VIEWABLE),this.urls=this._generateUrls(),this._setUpListeners()},_generateUrls:function(){var t=this.get("id");if(!t)return{};var e={purge:"datasets/"+t+"/purge_async",display:"datasets/"+t+"/display/?preview=True",edit:"datasets/"+t+"/edit",download:"datasets/"+t+"/display?to_ext="+this.get("file_ext"),report_error:"dataset/errors?id="+t,rerun:"tool_runner/rerun?id="+t,show_params:"datasets/"+t+"/show_params",visualization:"visualization",meta_download:"dataset/get_metadata_file?hda_id="+t+"&metadata_name="};return o.each(e,function(t,i){e[i]=Galaxy.root+t}),this.urls=e,e},_setUpListeners:function(){this.on("change:state",function(t,e){this.log(this+" has changed state:",t,e),this.inReadyState()&&this.trigger("state:ready",t,e,this.previous("state"))}),this.on("change:id change:file_ext",function(t){this._generateUrls()})},toJSON:function(){var t=a.Model.prototype.toJSON.call(this);return o.extend(t,{urls:this.urls})},isDeletedOrPurged:function(){return this.get("deleted")||this.get("purged")},inReadyState:function(){var e=o.contains(t.READY_STATES,this.get("state"));return this.isDeletedOrPurged()||e},hasDetails:function(){return!this.get("accessible")||o.has(this.attributes,"genome_build")},hasData:function(){return this.get("file_size")>0},fetch:function(t){var e=this;return a.Model.prototype.fetch.call(this,t).always(function(){e._generateUrls()})},"delete":function(t){return this.get("deleted")?l.when():this.save({deleted:!0},t)},undelete:function(t){return!this.get("deleted")||this.get("purged")?l.when():this.save({deleted:!1},t)},purge:function(t){if(this.get("purged"))return l.when();t=t||{},t.url=this.urls.purge;var e=this,n=l.ajax(t);return n.done(function(t,i,n){e.set({deleted:!0,purged:!0})}),n.fail(function(n,s,a){var o=i("Unable to purge dataset"),l="Removal of datasets by users is not allowed in this Galaxy instance";n.responseJSON&&n.responseJSON.error?o=n.responseJSON.error:n.responseText.indexOf(l)!==-1&&(o=l),n.responseText=o,e.trigger("error",e,n,t,i(o),{error:o})}),n},searchAttributes:["name","file_ext","genome_build","misc_blurb","misc_info","annotation","tags"],searchAliases:{title:"name",format:"file_ext",database:"genome_build",blurb:"misc_blurb",description:"misc_blurb",info:"misc_info",tag:"tags"},toString:function(){var t=this.get("id")||"";return this.get("name")&&(t='"'+this.get("name")+'",'+t),"Dataset("+t+")"}})),c=a.Collection.extend(e.LoggableMixin).extend({_logNamespace:n,model:r,urlRoot:Galaxy.root+"api/datasets",url:function(){return this.urlRoot},ids:function(){return this.map(function(t){return t.get("id")})},notReady:function(){return this.filter(function(t){return!t.inReadyState()})},haveDetails:function(){return this.all(function(t){return t.hasDetails()})},ajaxQueue:function(t,e){var i=l.Deferred(),n=this.length,s=[];if(!n)return i.resolve([]),i;var a=this.chain().reverse().map(function(o,l){return function(){var r=t.call(o,e);r.done(function(t){i.notify({curr:l,total:n,response:t,model:o})}),r.always(function(t){s.push(t),a.length?a.shift()():i.resolve(s)})}}).value();return a.shift()(),i},matches:function(t){return this.filter(function(e){return e.matches(t)})},toString:function(){return["DatasetAssociationCollection(",this.length,")"].join("")}});return{DatasetAssociation:r,DatasetAssociationCollection:c}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2),i(1))},function(t,e,i){var n,s;(function(a){n=[i(32),i(6),i(5)],s=function(t,e,i){"use strict";var n=t.DatasetListItemView,s=n.extend({className:n.prototype.className+" history-content",initialize:function(t,e){n.prototype.initialize.call(this,t,e)},toString:function(){var t=this.model?this.model+"":"(no model)";return"HDAListItemView("+t+")"}});return s.prototype.templates=function(){var t=e.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<span class="state-icon"></span>','<div class="title">','<span class="hid"><%- dataset.hid %></span> ','<span class="name"><%- dataset.name %></span>',"</div>","</div>"],"dataset"),s=a.extend({},n.prototype.templates.warnings,{hidden:e.wrapTemplate(["<% if( !dataset.visible ){ %>",'<div class="hidden-msg warningmessagesmall">',i("This dataset has been hidden"),"</div>","<% } %>"],"dataset")});return a.extend({},n.prototype.templates,{titleBar:t,warnings:s})}(),{HDAListItemView:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(2))},function(t,e,i){var n,s;(function(a){n=[i(71),i(40),i(6),i(5)],s=function(t,e,i,n){"use strict";var s=t.DatasetAssociation,o=e.HistoryContentMixin,l=s.extend(i.mixin(o,{constructor:function(t,e){o.constructor.call(this,t,e)},defaults:a.extend({},s.prototype.defaults,o.defaults,{model_class:"HistoryDatasetAssociation"}),initialize:function(t,e){s.prototype.initialize.call(this,t,e),o.initialize.call(this,t,e)},toString:function(){var t=this.get("id")||"";return this.get("name")&&(t=this.get("hid")+' :"'+this.get("name")+'",'+t),"HDA("+t+")"}}));return{HistoryDatasetAssociation:l}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(2))},function(t,e,i){var n,s;(function(a){n=[i(10),i(29),i(69),i(6),i(5)],s=function(t,e,i,n,s){"use strict";var o=e.DCListItemView,l=o.extend({className:o.prototype.className+" history-content",_setUpListeners:function(){o.prototype._setUpListeners.call(this),this.listenTo(this.model,{"change:populated change:visible":function(t,e){this.render()}})},_getFoldoutPanelClass:function(){switch(this.model.get("collection_type")){case"list":return i.ListCollectionView;case"paired":return i.PairCollectionView;case"list:paired":return i.ListOfPairsCollectionView;case"list:list":return i.ListOfListsCollectionView}throw new TypeError("Uknown collection_type: "+this.model.get("collection_type"))},_swapNewRender:function(e){o.prototype._swapNewRender.call(this,e);var i=this.model.get("populated")?t.OK:t.RUNNING;return this.$el.addClass("state-"+i),this.$el},toString:function(){var t=this.model?this.model+"":"(no model)";return"HDCAListItemView("+t+")"}});return l.prototype.templates=function(){var t=a.extend({},o.prototype.templates.warnings,{hidden:n.wrapTemplate(["<% if( !collection.visible ){ %>",'<div class="hidden-msg warningmessagesmall">',s("This collection has been hidden"),"</div>","<% } %>"],"collection")}),e=n.wrapTemplate(['<div class="title-bar clear" tabindex="0">','<span class="state-icon"></span>','<div class="title">','<span class="hid"><%- collection.hid %></span> ','<span class="name"><%- collection.name %></span>',"</div>",'<div class="subtitle"></div>',"</div>"],"collection");return a.extend({},o.prototype.templates,{warnings:t,titleBar:e})}(),{HDCAListItemView:l}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(2))},function(t,e,i){var n,s;(function(a,o,l,r){n=[i(41),i(4),i(6),i(5)],s=function(t,e,i,n){"use strict";var s="history",c=a.Model.extend(i.LoggableMixin).extend(i.mixin(i.SearchableModelMixin,{_logNamespace:s,defaults:{model_class:"History",id:null,name:"Unnamed History",state:"new",deleted:!1},urlRoot:Galaxy.root+"api/histories",initialize:function(e,i,n){n=n||{},this.logger=n.logger||null,this.log(this+".initialize:",e,i,n),this.log("creating history contents:",i),this.contents=new t.HistoryContents(i||[],{historyId:this.get("id")}),this._setUpListeners(),this.updateTimeoutId=null},_setUpListeners:function(){this.on("error",function(t,e,i,n,s){this.errorHandler(t,e,i,n,s)}),this.contents&&this.listenTo(this.contents,"error",function(){this.trigger.apply(this,["error:contents"].concat(o.makeArray(arguments)))}),this.on("change:id",function(t,e){this.contents&&(this.contents.historyId=e)})},errorHandler:function(t,e,i,n,s){this.clearUpdateTimeout()},nice_size:function(){return e.bytesToString(this.get("size"),!0,2)},toJSON:function(){return l.extend(a.Model.prototype.toJSON.call(this),{nice_size:this.nice_size()})},get:function(t){return"nice_size"===t?this.nice_size():a.Model.prototype.get.apply(this,arguments)},ownedByCurrUser:function(){return!(!Galaxy||!Galaxy.user)&&(!Galaxy.user.isAnonymous()&&Galaxy.user.id===this.get("user_id"))},contentsCount:function(){return l.reduce(l.values(this.get("state_details")),function(t,e){return t+e},0)},numOfUnfinishedJobs:function(){var t=this.get("non_ready_jobs");return t?t.length:0},numOfUnfinishedShownContents:function(){var t=this.contents.running().visibleAndUndeleted();return t?t.length:0},searchAttributes:["name","annotation","tags"],searchAliases:{title:"name",tag:"tags"},_getSizeAndRunning:function(){return this.fetch({data:r.param({keys:"size,non_ready_jobs"})})},refresh:function(t){t=t||{};var e=this,i=e.lastUpdateTime;return e.contents.fetchUpdated(i).done(function(i,n,s){var a;try{a=new Date(s.getResponseHeader("Date"))}catch(o){}e.lastUpdateTime=a||new Date,e.checkForUpdates(t)})},checkForUpdates:function(t){function e(){n.clearUpdateTimeout(),n.updateTimeoutId=setTimeout(function(){n.refresh(t)},i)}t=t||{};var i=c.UPDATE_DELAY,n=this;this.numOfUnfinishedShownContents()>0?e():n._getSizeAndRunning().done(function(t){n.numOfUnfinishedJobs()>0?e():n.trigger("ready")})},clearUpdateTimeout:function(){this.updateTimeoutId&&(clearTimeout(this.updateTimeoutId),this.updateTimeoutId=null)},_delete:function(t){return this.get("deleted")?o.when():this.save({deleted:!0},t)},purge:function(t){return this.get("purged")?o.when():this.save({deleted:!0,purged:!0},t)},undelete:function(t){return this.get("deleted")?this.save({deleted:!1},t):o.when()},copy:function(t,e,i){if(t=void 0===t||t,!this.id)throw new Error("You must set the history ID before copying it.");var n={history_id:this.id};t&&(n.current=!0),e&&(n.name=e),i||(n.all_datasets=!1);var s=this,a=o.post(this.urlRoot,n);return t?a.then(function(t){var e=new c(t);return e.setAsCurrent().done(function(){s.trigger("copied",s,t)})}):a.done(function(t){s.trigger("copied",s,t)})},setAsCurrent:function(){var t=this,e=o.getJSON(Galaxy.root+"history/set_as_current?id="+this.id);return e.done(function(){t.trigger("set-as-current",t)}),e},toString:function(){return"History("+this.get("id")+","+this.get("name")+")"}}));c.UPDATE_DELAY=4e3,c.getHistoryData=function(t,e){function i(e){return"current"===t?o.getJSON(Galaxy.root+"history/current_history_json"):o.ajax(Galaxy.root+"api/histories/"+t)}function n(t){return t&&t.empty}function s(t){if(n(t))return[];l.isFunction(a)&&(a=a(t)),l.isFunction(r)&&(r=r(t));var e={v:"dev"};return a.length&&(e.details=a.join(",")),o.ajax(Galaxy.root+"api/histories/"+t.id+"/contents",{data:e})}e=e||{};var a=e.detailIdsFn||[],r=e.hdcaDetailIds||[],c=o.Deferred(),d=null,h=e.historyFn||i,u=e.contentsFn||s,p=h(t);p.done(function(t){d=t,c.notify({status:"history data retrieved",historyJSON:d})}),p.fail(function(t,e,i){c.reject(t,"loading the history")});var g=p.then(u);return g.then(function(t){c.notify({status:"contents data retrieved",historyJSON:d,contentsJSON:t}),c.resolve(d,t)}),g.fail(function(t,e,i){c.reject(t,"loading the contents",{history:d})}),c};var d={fetch:function(t){return t=t||{},t.data=t.data||this._buildFetchData(t),t.traditional=!0,a.Collection.prototype.fetch.call(this,t)},_fetchOptions:["order","limit","offset","view","keys"],_buildFetchData:function(t){var e={},i=this._fetchDefaults();t=l.defaults(t||{},i),e=l.pick(t,this._fetchOptions);var n=l.has(t,"filters")?t.filters:i.filters||{};return l.isEmpty(n)||l.extend(e,this._buildFetchFilters(n)),e},_fetchDefaults:function(){return{}},_buildFetchFilters:function(t){var e={q:[],qv:[]};return l.each(t,function(t,i){t===!0&&(t="True"),t===!1&&(t="False"),null===t&&(t="None"),e.q.push(i),e.qv.push(t)}),e}},h=a.Collection.extend(i.LoggableMixin).extend(d).extend({_logNamespace:s,model:c,DEFAULT_ORDER:"update_time",sortOrders:{update_time:{getter:function(t){return new Date(t.get("update_time"))},asc:!1},"update_time-asc":{getter:function(t){return new Date(t.get("update_time"))},asc:!0},name:{getter:function(t){return t.get("name")},asc:!0},"name-dsc":{getter:function(t){return t.get("name")},asc:!1},size:{getter:function(t){return t.get("size")},asc:!1},"size-asc":{getter:function(t){return t.get("size")},asc:!0}},initialize:function(t,e){e=e||{},this.log("HistoryCollection.initialize",arguments),this.includeDeleted=e.includeDeleted||!1,this.setOrder(e.order||this.DEFAULT_ORDER),this.currentHistoryId=e.currentHistoryId,this.allFetched=e.allFetched||!1,this.setUpListeners()},urlRoot:Galaxy.root+"api/histories",url:function(){return this.urlRoot},_fetchDefaults:function(){var t={order:this.order,view:"detailed"};return this.includeDeleted?t.filters={deleted:null}:t.filters={deleted:!1,purged:!1},t},setUpListeners:function(){this.on({"change:deleted":function(t){this.debug("change:deleted",this.includeDeleted,t.get("deleted")),!this.includeDeleted&&t.get("deleted")&&this.remove(t)},copied:function(t,e){this.setCurrent(new c(e,[]))},"set-as-current":function(t){var e=this.currentHistoryId;this.trigger("no-longer-current",e),this.currentHistoryId=t.id}})},sort:function(t){return t=t||{},this.setOrder(t.order),a.Collection.prototype.sort.call(this,t)},setOrder:function(t){var e=this,i=this.sortOrders[t];if(!l.isUndefined(i))return e.order=t,e.comparator=function(t,n){var s=e.currentHistoryId;return t.id===s?-1:n.id===s?1:(t=i.getter(t),n=i.getter(n),i.asc?t===n?0:t>n?1:-1:t===n?0:t>n?-1:1)},e.trigger("changed-order",e.order,e),e},fetch:function(t){if(t=t||{},this.allFetched)return o.when({});var e=this,i=l.defaults(t,{remove:!1,offset:e.length>=1?e.length-1:0,order:e.order}),n=t.limit;return l.isUndefined(n)||(i.limit=n),d.fetch.call(this,i).done(function(t){var i=l.isArray(t)?t.length:0;(!n||i<n)&&(e.allFetched=!0,e.trigger("all-fetched",e))})},create:function(t,e,i,n){var s=this,a=o.getJSON(Galaxy.root+"history/create_new_current");return a.done(function(t){s.setCurrent(new c(t,[],i||{}))})},setCurrent:function(t,e){return e=e||{},this.unshift(t,e),this.currentHistoryId=t.get("id"),e.silent||this.trigger("new-current",t,this),this},reset:function(t,e){return this.allFetched=!1,a.Collection.prototype.reset.call(this,t,e)},toString:function(){return"HistoryCollection("+this.length+")"}});return{History:c,HistoryCollection:h}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1),i(2),i(1))},function(t,e,i){var n,s;(function(a,o,l){n=[i(42),i(119),i(6),i(5),i(83)],s=function(t,e,i,n){"use strict";var s="list",r=a.View.extend(i.LoggableMixin).extend({_logNamespace:s,viewClass:t.ListItemView,collectionClass:a.Collection,tagName:"div",className:"list-panel",fxSpeed:"fast",emptyMsg:n("This list is empty"),noneFoundMsg:n("No matching items found"),searchPlaceholder:n("search"),initialize:function(t,i){t=t||{},t.logger&&(this.logger=t.logger),this.log(this+".initialize:",t),this.fxSpeed=o.has(t,"fxSpeed")?t.fxSpeed:this.fxSpeed,this.filters=[],this.searchFor=t.searchFor||"",this.indicator=new e(this.$el),this.selecting=void 0===t.selecting||t.selecting,this.selected=t.selected||[],this.lastSelected=null,this.dragItems=t.dragItems||!1,this.viewClass=t.viewClass||this.viewClass,this.views=[],this.collection=t.collection||new this.collectionClass([]),this.filters=t.filters||[],this.$scrollContainer=t.$scrollContainer||this.$scrollContainer,this.title=t.title||"",this.subtitle=t.subtitle||"",this._setUpListeners()},freeViews:function(){return o.each(this.views,function(t){t.off()}),this.views=[],this},_setUpListeners:function(){return this.off(),this.on({error:function(t,e,i,n,s){console.error(t,e,i,n,s)},loading:function(){this._showLoadingIndicator("loading...",40)},"loading-done":function(){this._hideLoadingIndicator(40)}}),this.once("rendered",function(){this.trigger("rendered:initial",this)}),this.logger&&this.on("all",function(t){this.log(this+"",arguments)}),this._setUpCollectionListeners(),this._setUpViewListeners(),this},_setUpCollectionListeners:function(){return this.log(this+"._setUpCollectionListeners",this.collection),this.collection.off(),this.listenTo(this.collection,{error:function(t,e,i,n,s){this.trigger("error",t,e,i,n,s)},reset:function(){this.renderItems()},add:this.addItemView,remove:this.removeItemView}),this.logger&&this.listenTo(this.collection,"all",function(t){this.info(this+"(collection)",arguments)}),this},_setUpViewListeners:function(){this.log(this+"._setUpViewListeners"),this.on({"view:selected":function(t,e){if(e&&e.shiftKey&&this.lastSelected){var i=this.viewFromModelId(this.lastSelected);i&&this.selectRange(t,i)}else e&&e.altKey&&!this.selecting&&this.showSelectors();this.selected.push(t.model.id),this.lastSelected=t.model.id},"view:de-selected":function(t,e){this.selected=o.without(this.selected,t.model.id)}})},render:function(t){this.log(this+".render",t);var e=this._buildNewRender();return this._setUpBehaviors(e),this._queueNewRender(e,t),this},_buildNewRender:function(){this.debug(this+"(ListPanel)._buildNewRender");var t=l(this.templates.el({},this));return this._renderControls(t),this._renderTitle(t),this._renderSubtitle(t),this._renderSearch(t),this.renderItems(t),t},_renderControls:function(t){this.debug(this+"(ListPanel)._renderControls");var e=l(this.templates.controls({},this));return t.find(".controls").replaceWith(e),e},_renderTitle:function(t){},_renderSubtitle:function(t){},_queueNewRender:function(t,e){e=void 0===e?this.fxSpeed:e;var i=this;i.log("_queueNewRender:",t,e),l(i).queue("fx",[function(t){this.$el.fadeOut(e,t)},function(e){i._swapNewRender(t),e()},function(t){this.$el.fadeIn(e,t)},function(t){i.trigger("rendered",i),t()}])},_swapNewRender:function(t){return this.$el.empty().attr("class",this.className).append(t.children()),this.selecting&&this.showSelectors(0),this},_setUpBehaviors:function(t){return t=t||this.$el,t.find(".controls [title]").tooltip({placement:"bottom"}),this._renderMultiselectActionMenu(t),this},_renderMultiselectActionMenu:function(t){t=t||this.$el;var e=t.find(".list-action-menu"),i=this.multiselectActions();if(!i.length)return e.empty();var s=l(['<div class="list-action-menu btn-group">','<button class="list-action-menu-btn btn btn-default dropdown-toggle" data-toggle="dropdown">',n("For all selected"),"...","</button>",'<ul class="dropdown-menu pull-right" role="menu">',"</ul>","</div>"].join("")),a=i.map(function(t){var e=['<li><a href="javascript:void(0);">',t.html,"</a></li>"].join("");return l(e).click(function(e){return e.preventDefault(),t.func(e)})});return s.find("ul").append(a),e.replaceWith(s),s},multiselectActions:function(){return[]},$scrollContainer:function(){return this.$el.parent().parent()},$list:function(t){return(t||this.$el).find("> .list-items")},$messages:function(t){return(t||this.$el).find("> .controls .messages")},$emptyMessage:function(t){return(t||this.$el).find("> .empty-message")},renderItems:function(t){t=t||this.$el;var e=this;e.log(this+".renderItems",t);var i=e.$list(t);return e.views=e._filterCollection().map(function(t){return e._createItemView(t).render(0)}),i.empty(),e.views.length?(e._attachItems(t),e.$emptyMessage(t).hide()):e._renderEmptyMessage(t).show(),e.trigger("views:ready",e.views),e.views},_filterCollection:function(){var t=this;return t.collection.filter(o.bind(t._filterItem,t))},_filterItem:function(t){var e=this;return o.every(e.filters.map(function(e){return e.call(t)}))&&(!e.searchFor||t.matchesAll(e.searchFor))},_createItemView:function(t){var e=this._getItemViewClass(t),i=o.extend(this._getItemViewOptions(t),{model:t}),n=new e(i);return this._setUpItemViewListeners(n),n},_getItemViewClass:function(t){return this.viewClass},_getItemViewOptions:function(t){return{fxSpeed:this.fxSpeed,expanded:!1,selectable:this.selecting,selected:o.contains(this.selected,t.id),draggable:this.dragItems}},_setUpItemViewListeners:function(t){var e=this;return this.listenTo(t,"all",function(){var t=Array.prototype.slice.call(arguments,0);t[0]="view:"+t[0],e.trigger.apply(e,t)}),this.listenTo(t,"draggable:dragstart",function(t,e){var i={},n=this.getSelectedModels();i=n.length?n.toJSON():[e.model.toJSON()],t.dataTransfer.setData("text",JSON.stringify(i))},this),e},_attachItems:function(t){return this.$list(t).append(this.views.map(function(t){return t.$el})),this},_renderEmptyMessage:function(t){this.debug("_renderEmptyMessage",t,this.searchFor);var e=this.searchFor?this.noneFoundMsg:this.emptyMsg;return this.$emptyMessage(t).text(e)},expandAll:function(){o.each(this.views,function(t){t.expand()})},collapseAll:function(){o.each(this.views,function(t){t.collapse()})},addItemView:function(t,e,i){this.log(this+".addItemView:",t);var n=this;if(n._filterItem(t)){var s=n._createItemView(t);return l(s).queue("fx",[function(t){n.$emptyMessage().fadeOut(n.fxSpeed,t)},function(t){n._attachView(s),t()}]),s}},_attachView:function(t){var e=this;e.views.push(t),e.$list().append(t.render(0).$el.hide()),e.trigger("view:attached",t),t.$el.slideDown(e.fxSpeed,function(){e.trigger("view:attached:rendered")})},removeItemView:function(t,e,i){this.log(this+".removeItemView:",t);var n=this,s=n.viewFromModel(t);if(s)return n.views=o.without(n.views,s),n.trigger("view:removed",s),l({}).queue("fx",[function(t){s.$el.fadeOut(n.fxSpeed,t)},function(t){s.remove(),n.trigger("view:removed:rendered"),n.views.length?t():n._renderEmptyMessage().fadeIn(n.fxSpeed,t)}]),s},viewFromModelId:function(t){for(var e=0;e<this.views.length;e++)if(this.views[e].model.id===t)return this.views[e]},viewFromModel:function(t){if(t)return this.viewFromModelId(t.id)},viewsWhereModel:function(t){return this.views.filter(function(e){var i=e.model.toJSON();for(var n in t)if(t.hasOwnProperty(n)&&i[n]!==t[n])return!1;return!0})},viewRange:function(t,e){if(t===e)return t?[t]:[];var i=this.views.indexOf(t),n=this.views.indexOf(e);return i===-1||n===-1?i===n?[]:i===-1?[e]:[t]:i<n?this.views.slice(i,n+1):this.views.slice(n,i+1)},_renderSearch:function(t){return t.find(".controls .search-input").searchInput({placeholder:this.searchPlaceholder,initialVal:this.searchFor,onfirstsearch:o.bind(this._firstSearch,this),onsearch:o.bind(this.searchItems,this),onclear:o.bind(this.clearSearch,this)}),t},_firstSearch:function(t){return this.log("onFirstSearch",t),this.searchItems(t)},searchItems:function(t){return this.searchFor=t,this.trigger("search:searching",t,this),this.renderItems(),this.$("> .controls .search-query").val(t),this},clearSearch:function(t){return this.searchFor="",this.trigger("search:clear",this),this.$("> .controls .search-query").val(""),this.renderItems(),this},THROTTLE_SELECTORS_AT:20,showSelectors:function(t){t=void 0!==t?t:this.fxSpeed,this.selecting=!0,this.$(".list-actions").slideDown(t),t=this.views.length>=this.THROTTLE_SELECTORS_AT?0:t,o.each(this.views,function(e){e.showSelector(t)})},hideSelectors:function(t){t=void 0!==t?t:this.fxSpeed,this.selecting=!1,this.$(".list-actions").slideUp(t),t=this.views.length>=this.THROTTLE_SELECTORS_AT?0:t,o.each(this.views,function(e){e.hideSelector(t)}),this.selected=[],this.lastSelected=null},toggleSelectors:function(){this.selecting?this.hideSelectors():this.showSelectors()},selectAll:function(t){o.each(this.views,function(e){e.select(t)})},deselectAll:function(t){this.lastSelected=null,o.each(this.views,function(e){e.deselect(t)})},selectRange:function(t,e){var i=this.viewRange(t,e);return o.each(i,function(t){t.select()}),i},getSelectedViews:function(){return o.filter(this.views,function(t){return t.selected})},getSelectedModels:function(){return new this.collection.constructor(o.map(this.getSelectedViews(),function(t){return t.model}))},_showLoadingIndicator:function(t,i,n){this.debug("_showLoadingIndicator",this.indicator,t,i,n),i=void 0!==i?i:this.fxSpeed,this.indicator||(this.indicator=new e(this.$el,this.$el.parent()),this.debug("\t created",this.indicator)),this.$el.is(":visible")?(this.$el.fadeOut(i),this.indicator.show(t,i,n)):this.indicator.show(0,n)},_hideLoadingIndicator:function(t,e){this.debug("_hideLoadingIndicator",this.indicator,t,e),t=void 0!==t?t:this.fxSpeed,this.indicator&&this.indicator.hide(t,e)},scrollPosition:function(){return this.$scrollContainer().scrollTop()},scrollTo:function(t,e){return e=e||0,this.$scrollContainer().animate({scrollTop:t},e),this},scrollToTop:function(t){return this.scrollTo(0,t)},scrollToItem:function(t,e){if(!t)return this;var i=t.el.offsetTop;return this.scrollTo(i,e)},scrollToId:function(t,e){return this.scrollToItem(this.viewFromModelId(t),e)},events:{"click .select-all":"selectAll","click .deselect-all":"deselectAll"},toString:function(){return"ListPanel("+this.collection+")"}});r.prototype.templates=function(){var t=i.wrapTemplate(["<div>",'<div class="controls"></div>','<div class="list-items"></div>','<div class="empty-message infomessagesmall"></div>',"</div>"]),e=i.wrapTemplate(['<div class="controls">','<div class="title">','<div class="name"><%- view.title %></div>',"</div>",'<div class="subtitle"><%- view.subtitle %></div>','<div class="actions"></div>','<div class="messages"></div>','<div class="search">','<div class="search-input"></div>',"</div>",'<div class="list-actions">','<div class="btn-group">','<button class="select-all btn btn-default"','data-mode="select">',n("All"),"</button>",'<button class="deselect-all btn btn-default"','data-mode="select">',n("None"),"</button>","</div>",'<div class="list-action-menu btn-group">',"</div>","</div>","</div>"]);return{el:t,controls:e}}();var c=r.extend({modelCollectionKey:"contents",initialize:function(t){r.prototype.initialize.call(this,t),this.selecting=void 0!==t.selecting&&t.selecting,this.setModel(this.model,t)},setModel:function(t,e){if(e=e||{},this.debug(this+".setModel:",t,e),this.freeModel(),this.freeViews(),t){var i=this.model?this.model.get("id"):null;this.model=t,this.logger&&(this.model.logger=this.logger),this._setUpModelListeners(),this.collection.off(),this.collection=this.model[this.modelCollectionKey]?this.model[this.modelCollectionKey]:e.collection||new this.collectionClass([]),this._setUpCollectionListeners(),i&&t.get("id")!==i&&this.trigger("new-model",this)}return this},freeModel:function(){return this.model&&this.stopListening(this.model),this},_setUpModelListeners:function(){return this.log(this+"._setUpModelListeners",this.model),this.listenTo(this.model,"error",function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("error"),this.trigger.apply(this,t)},this),this},_renderControls:function(t){this.debug(this+"(ListPanel)._renderControls");var e=this.model?this.model.toJSON():{},i=l(this.templates.controls(e,this));return t.find(".controls").replaceWith(i),i},toString:function(){return"ModelListPanel("+this.model+")"}});return c.prototype.templates=function(){var t=i.wrapTemplate(['<div class="controls">','<div class="title">','<div class="name"><%- model.name %></div>',"</div>",'<div class="subtitle"><%- view.subtitle %></div>','<div class="actions"></div>','<div class="messages"></div>','<div class="search">','<div class="search-input"></div>',"</div>",'<div class="list-actions">','<div class="btn-group">','<button class="select-all btn btn-default"','data-mode="select">',n("All"),"</button>",'<button class="deselect-all btn btn-default"','data-mode="select">',n("None"),"</button>","</div>",'<div class="list-action-menu btn-group">',"</div>","</div>","</div>"]);return o.extend(o.clone(r.prototype.templates),{controls:t})}(),{ListPanel:r,ModelListPanel:c}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2),i(1))},function(t,e,i){var n,s;(function(a,o){n=[i(6),i(5)],s=function(t,e){var i=a.View.extend(t.LoggableMixin).extend(t.HiddenUntilActivatedViewMixin).extend({tagName:"div",className:"tags-display",initialize:function(t){this.listenTo(this.model,"change:tags",function(){this.render()}),this.hiddenUntilActivated(t.$activator,t)},render:function(){var t=this;return this.$el.html(this._template()),this.$input().select2({placeholder:"Add tags",width:"100%",tags:function(){return t._getTagsUsed()}}),this._setUpBehaviors(),this},_template:function(){return['<label class="prompt">',e("Tags"),"</label>",'<input class="tags-input" value="',this.tagsToCSV(),'" />'].join("")},tagsToCSV:function(){var t=this.model.get("tags");return!o.isArray(t)||o.isEmpty(t)?"":t.map(function(t){return o.escape(t)}).sort().join(",")},$input:function(){return this.$el.find("input.tags-input")},_getTagsUsed:function(){return Galaxy.user.get("tags_used")},_setUpBehaviors:function(){var t=this;this.$input().on("change",function(e){t.model.save({tags:e.val},{silent:!0}),e.added&&t._addNewTagToTagsUsed(e.added.text+"")})},_addNewTagToTagsUsed:function(t){var e=Galaxy.user.get("tags_used");o.contains(e,t)||(e.push(t),e.sort(),Galaxy.user.set("tags_used",e))},remove:function(){this.$input.off(),this.stopListening(this.model),a.View.prototype.remove.call(this)},toString:function(){return["TagsEditor(",this.model+"",")"].join("")}});return{TagsEditor:i}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2))},function(t,e,i){var n,s;(function(a,o){n=[i(4)],s=function(t){return a.View.extend({initialize:function(e){this.options=t.merge(e,{class_add:"upload-icon-button fa fa-square-o",class_remove:"upload-icon-button fa fa-check-square-o",class_partial:"upload-icon-button fa fa-minus-square-o",collection:null,onchange:function(){},onadd:function(){},onremove:function(){}});var i=this;this.collection=this.options.collection,this.setElement(this._template()),this.rows=[],t.get({url:Galaxy.root+"api/remote_files",success:function(t){i._fill(t)},error:function(){i._fill()}})},_fill:function(e){if(e&&e.length>0){this.$el.find("#upload-ftp-content").html(o(this._templateTable()));var i=0;for(index in e)this.rows.push(this._add(e[index])),i+=e[index].size;if(this.$el.find("#upload-ftp-number").html(e.length+" files"),this.$el.find("#upload-ftp-disk").html(t.bytesToString(i,!0)),this.collection){var n=this;this.$("._has_collection").show(),this.$select_all=o("#upload-selectall"),this.$select_all.addClass(this.options.class_add),this.$select_all.on("click",function(){var t=n.$select_all.hasClass(n.options.class_add);for(index in e){var i=e[index],s=n._find(i);(!s&&t||s&&!t)&&n.rows[index].trigger("click")}}),this._refresh()}}else this.$el.find("#upload-ftp-content").html(o(this._templateInfo()));this.$el.find("#upload-ftp-wait").hide()},_add:function(t){var e=this,i=o(this._templateRow(t)),n=i.find(".icon");if(o(this.el).find("tbody").append(i),this.collection){var s="";s=this._find(t)?this.options.class_remove:this.options.class_add,n.addClass(s),i.on("click",function(){var i=e._find(t);n.removeClass(),i?(e.options.onremove(i),n.addClass(e.options.class_add)):(e.options.onadd(t),n.addClass(e.options.class_remove)),e._refresh()})}else i.on("click",function(){e.options.onchange(t)});return i},_refresh:function(){var t=this.collection.where({file_mode:"ftp",enabled:!0});this.$select_all.removeClass(),0==t.length?this.$select_all.addClass(this.options.class_add):t.length==this.rows.length?this.$select_all.addClass(this.options.class_remove):this.$select_all.addClass(this.options.class_partial)},_find:function(t){var e=this.collection.findWhere({file_path:t.path,file_mode:"ftp",enabled:!0});return e&&e.get("id")},_templateRow:function(e){return'<tr class="upload-ftp-row"><td class="_has_collection" style="display: none;"><div class="icon"/></td><td class="ftp-name">'+e.path+'</td><td class="ftp-size">'+t.bytesToString(e.size)+'</td><td class="ftp-time">'+e.ctime+"</td></tr>"},_templateTable:function(){return'<span style="whitespace: nowrap; float: left;">Available files: </span><span style="whitespace: nowrap; float: right;"><span class="upload-icon fa fa-file-text-o"/><span id="upload-ftp-number"/>&nbsp;&nbsp;<span class="upload-icon fa fa-hdd-o"/><span id="upload-ftp-disk"/></span><table class="grid" style="float: left;"><thead><tr><th class="_has_collection" style="display: none;"><div id="upload-selectall"></th><th>Name</th><th>Size</th><th>Created</th></tr></thead><tbody/></table>'},_templateInfo:function(){return'<div class="upload-ftp-warning warningmessage">Your FTP directory does not contain any files.</div>'},_template:function(){
return'<div class="upload-ftp"><div id="upload-ftp-wait" class="upload-ftp-wait fa fa-spinner fa-spin"/><div class="upload-ftp-help">This Galaxy server allows you to upload files via FTP. To upload some files, log in to the FTP server at <strong>'+this.options.ftp_upload_site+'</strong> using your Galaxy credentials (email address and password).</div><div id="upload-ftp-content"/><div>'}})}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1))},function(t,e,i){var n,s;(function(a,o,l){n=[i(4)],s=function(t){return a.View.extend({options:{class_check:"fa-check-square-o",class_uncheck:"fa-square-o",parameters:[{id:"space_to_tab",title:"Convert spaces to tabs"},{id:"to_posix_lines",title:"Use POSIX standard"}]},initialize:function(t){this.model=t.model,this.setElement(o("<div/>").addClass("upload-settings")),this.$el.append(o("<div/>").addClass("upload-settings-cover")),this.$el.append(o("<table/>").addClass("upload-settings-table ui-table-striped").append("<tbody/>")),this.$cover=this.$(".upload-settings-cover"),this.$table=this.$(".upload-settings-table > tbody"),this.listenTo(this.model,"change",this.render,this),this.model.trigger("change")},render:function(){var t=this;this.$table.empty(),l.each(this.options.parameters,function(e){var i=o("<div/>").addClass("upload-"+e.id+" upload-icon-button fa").addClass(t.model.get(e.id)&&t.options.class_check||t.options.class_uncheck).on("click",function(){t.model.get("enabled")&&t.model.set(e.id,!t.model.get(e.id))});t.$table.append(o("<tr/>").append(o("<td/>").append(i)).append(o("<td/>").append(e.title)))}),this.$cover[this.model.get("enabled")&&"hide"||"show"]()}})}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1),i(2))},,,function(t,e,i){var n,s,a;(function(i,o){!function(i){s=[],n=i,a="function"==typeof n?n.apply(e,s):n,!(void 0!==a&&(t.exports=a))}(function(){i.fn.extend({hoverhighlight:function(t,e){return t=t||"body",this.length?(o(this).each(function(){var i=o(this),n=i.data("target");n&&i.mouseover(function(i){o(n,t).css({background:e})}).mouseout(function(t){o(n).css({background:""})})}),this):this}})})}).call(e,i(1),i(1))},function(t,e,i){var n,s,a;(function(i,o){!function(i){s=[],n=i,a="function"==typeof n?n.apply(e,s):n,!(void 0!==a&&(t.exports=a))}(function(){function t(t,n){function s(t){var e=i(this).parent().children("input");e.focus().val("").trigger("clear:searchInput"),n.onclear()}function a(t,e){i(this).trigger("search:searchInput",e),"function"==typeof n.onfirstsearch&&f?(f=!1,n.onfirstsearch(e)):n.onsearch(e)}function l(){return['<input type="text" name="',n.name,'" placeholder="',n.placeholder,'" ','class="search-query ',n.classes,'" ',"/>"].join("")}function r(){return i(l()).focus(function(t){i(this).select()}).keyup(function(t){if(t.preventDefault(),t.stopPropagation(),i(this).val()||i(this).blur(),t.which===u&&n.escWillClear)s.call(this,t);else{var e=i(this).val();t.which===p||n.minSearchLen&&e.length>=n.minSearchLen?a.call(this,t,e):e.length||s.call(this,t)}}).on("change",function(t){a.call(this,t,i(this).val())}).val(n.initialVal)}function c(){return i(['<span class="search-clear fa fa-times-circle" ','title="',e("clear search (esc)"),'"></span>'].join("")).tooltip({placement:"bottom"}).click(function(t){s.call(this,t)})}function d(){return i(['<span class="search-loading fa fa-spinner fa-spin" ','title="',e("loading..."),'"></span>'].join("")).hide().tooltip({placement:"bottom"})}function h(){g.find(".search-loading").toggle(),g.find(".search-clear").toggle()}var u=27,p=13,g=i(t),f=!0,m={initialVal:"",name:"search",placeholder:"search",classes:"",onclear:function(){},onfirstsearch:null,onsearch:function(t){},minSearchLen:0,escWillClear:!0,oninit:function(){}};return"string"===o.type(n)?("toggle-loading"===n&&h(),g):("object"===o.type(n)&&(n=o.extend(!0,{},m,n)),g.addClass("search-input").prepend([r(),c(),d()]))}var e=window._l||function(t){return t};o.fn.extend({searchInput:function(e){return this.each(function(){return t(this,e)})}})})}).call(e,i(1),i(1))},,function(t,e,i){var n,s;n=[],s=function(){function t(t,e){var i=/(-?[0-9\.]+)/g,n=t.toString().toLowerCase()||"",s=e.toString().toLowerCase()||"",a=String.fromCharCode(0),o=n.replace(i,a+"$1"+a).split(a),l=s.replace(i,a+"$1"+a).split(a),r=new Date(n).getTime(),c=r?new Date(s).getTime():null;if(c){if(r<c)return-1;if(r>c)return 1}for(var d,h,u=0,p=Math.max(o.length,l.length);u<p;u++){if(d=parseFloat(o[u])||o[u],h=parseFloat(l[u])||l[u],d<h)return-1;if(d>h)return 1}return 0}return t}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){(function(t,e){!function(i){t.event.props.push("dataTransfer"),i.uploadpost=function(e){var n=i.extend({},{data:{},success:function(){},error:function(){},progress:function(){},url:null,maxfilesize:2048,error_filesize:"File exceeds 2GB. Please use a FTP client.",error_default:"Please make sure the file is available.",error_server:"Upload request failed.",error_login:"Uploads require you to log in."},e),s=n.data;if(s.error_message)return void n.error(s.error_message);var a=new FormData;for(var o in s.payload)a.append(o,s.payload[o]);var l=0;for(var o in s.files){var r=s.files[o];a.append(r.name,r.file,r.file.name),l+=r.file.size}return l>1048576*n.maxfilesize?void n.error(n.error_filesize):(xhr=new XMLHttpRequest,xhr.open("POST",n.url,!0),xhr.setRequestHeader("Accept","application/json"),xhr.setRequestHeader("Cache-Control","no-cache"),xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr.onreadystatechange=function(){if(xhr.readyState==xhr.DONE){var e=null;if(xhr.responseText)try{e=t.parseJSON(xhr.responseText)}catch(i){e=xhr.responseText}if(xhr.status<200||xhr.status>299){var s=xhr.statusText;403==xhr.status?s=n.error_login:0==xhr.status?s=n.error_server:s||(s=n.error_default),n.error(s+" ("+xhr.status+")")}else n.success(e)}},xhr.upload.addEventListener("progress",function(t){t.lengthComputable&&n.progress(Math.round(100*t.loaded/t.total))},!1),Galaxy.emit.debug("uploadbox::uploadpost()","Posting following data.",n),void xhr.send(a))},i.fn.uploadinput=function(t){var e=this,n=i.extend({},{ondragover:function(){},ondragleave:function(){},onchange:function(){},multiple:!1},t),s=i('<input type="file" style="display: none" '+(n.multiple&&"multiple"||"")+"/>");return e.append(s.change(function(t){n.onchange(t.target.files),i(this).val("")})),e.on("drop",function(t){n.ondragleave(t),t.dataTransfer&&(n.onchange(t.dataTransfer.files),t.preventDefault())}),e.on("dragover",function(t){t.preventDefault(),n.ondragover(t)}),e.on("dragleave",function(t){t.stopPropagation(),n.ondragleave(t)}),{dialog:function(){s.trigger("click")}}},i.fn.uploadbox=function(t){function n(t){if(t&&t.length&&!m){var i=g;return e.each(t,function(t,i){"new"!==t.mode&&e.filter(p,function(e){return e.name===t.name&&e.size===t.size}).length&&(t.duplicate=!0)}),e.each(t,function(t){if(!t.duplicate){var e=String(g++);p[e]=t,u.announce(e,p[e]),f++}}),i}}function s(t){p[t]&&(delete p[t],f--)}function a(){if(0==f||v)return v=!1,m=!1,void u.complete();m=!0;var t=-1;for(var e in p){t=e;break}p[t];s(t),i.uploadpost({url:u.url,data:u.initialize(t),success:function(e){u.success(t,e),a()},error:function(e){u.error(t,e),a()},progress:function(e){u.progress(t,e)}})}function o(){_.dialog()}function l(t){for(t in p)s(t)}function r(){m||(m=!0,a())}function c(){v=!0}function d(t){return u=i.extend({},u,t)}function h(){return window.File&&window.FormData&&window.XMLHttpRequest&&window.FileList}var u=i.extend({},{dragover:function(){},dragleave:function(){},announce:function(t){},initialize:function(t){},progress:function(t,e){},success:function(t,e){},error:function(t,e){alert(e)},complete:function(){}},t),p={},g=0,f=0,m=!1,v=!1,_=i(this).uploadinput({multiple:!0,onchange:function(t){n(t)},ondragover:t.ondragover,ondragleave:t.ondragleave});return{select:o,add:n,remove:s,start:r,stop:c,reset:l,configure:d,compatible:h}}}(t)}).call(e,i(1),i(2))},function(t,e,i){var n=i(11).RightPanel,s=i(7),a=i(108);CurrentHistoryView=i(105).CurrentHistoryView,_l=i(5);var o=n.extend({title:_l("History"),initialize:function(t){n.prototype.initialize.call(this,t);var e=this;this.refreshButton=new s.ButtonLink({id:"history-refresh-button",title:_l("Refresh history"),cls:"panel-header-button",icon:"fa fa-refresh",onclick:function(){e.historyView.loadCurrentHistory()}}),this.optionsButton=new s.ButtonLink({id:"history-options-button",title:_l("History options"),cls:"panel-header-button",icon:"fa fa-cog"}),this.viewMultiButton=null,t.userIsAnonymous||(this.viewMultiButton=new s.ButtonLink({id:"history-view-multi-button",title:_l("View all histories"),cls:"panel-header-button",icon:"fa fa-columns",href:t.galaxyRoot+"history/view_multiple"})),this.optionsMenu=a(this.optionsButton.$el,{anonymous:t.userIsAnonymous,purgeAllowed:t.allow_user_dataset_purge,root:t.galaxyRoot}),this.historyView=new CurrentHistoryView({purgeAllowed:t.allow_user_dataset_purge,linkTarget:"galaxy_main",$scrollContainer:function(){return this.$el.parent()}})},render:function(){n.prototype.render.call(this),this.$(".unified-panel-header").addClass("history-panel-header"),this.$(".panel-header-buttons").append([this.refreshButton.$el,this.optionsButton.$el,this.viewMultiButton?this.viewMultiButton.$el:null]),this.historyView.setElement(this.$(".history-panel"))},_templateBody:function(t){return['<div class="unified-panel-body unified-panel-body-background">','<div id="current-history-panel" class="history-panel"/>',"</div>"].join("")},toString:function(){return"HistoryPanel"}});t.exports=o},function(t,e,i){(function(e,n){var s=i(11).LeftPanel,a=i(44),o=i(115),l=i(5),r=s.extend({title:l("Tools"),initialize:function(t){s.prototype.initialize.call(this,t),this.log(this+".initialize:",t),this.stored_workflow_menu_entries=t.stored_workflow_menu_entries||[];var e=new a.ToolSearch({search_url:t.search_url,hidden:!1}),i=new a.ToolCollection(t.toolbox);this.tool_panel=new a.ToolPanel({tool_search:e,tools:i,layout:t.toolbox_in_panel}),this.tool_panel_view=new a.ToolPanelView({model:this.tool_panel}),this.uploadButton=new o({nginx_upload_path:t.nginx_upload_path,ftp_upload_site:t.ftp_upload_site,default_genome:t.default_genome,default_extension:t.default_extension})},render:function(){var t=this;s.prototype.render.call(t),t.$(".panel-header-buttons").append(t.uploadButton.$el),t.tool_panel.get("layout").size()>0&&(t.tool_panel_view.render(),t.$(".toolMenu").show()),t.$(".toolMenuContainer").prepend(t.tool_panel_view.$el),t._renderWorkflowMenu(),t.$("a[minsizehint]").click(function(){parent.handle_minwidth_hint&&parent.handle_minwidth_hint(e(t).attr("minsizehint"))})},_renderWorkflowMenu:function(){var t=this;t.$("#internal-workflows").append(t._templateTool({title:l("All workflows"),href:"workflow/list_for_run"})),n.each(t.stored_workflow_menu_entries,function(e){t.$("#internal-workflows").append(t._templateTool({title:e.stored_workflow.name,href:"workflow/run?id="+e.encoded_stored_workflow_id}))})},_templateTool:function(t){return['<div class="toolTitle">','<a href="',Galaxy.root,t.href,'" target="galaxy_main">',t.title,"</a>","</div>"].join("")},_templateBody:function(){return['<div class="unified-panel-body unified-panel-body-background">','<div class="toolMenuContainer">','<div class="toolMenu" style="display: none">','<div id="search-no-results" style="display: none; padding-top: 5px">',"<em><strong>",l("Search did not match any tools."),"</strong></em>","</div>","</div>",'<div class="toolSectionPad"/>','<div class="toolSectionPad"/>','<div class="toolSectionTitle" id="title_XXinternalXXworkflow">',"<span>",l("Workflows"),"</span>","</div>",'<div id="internal-workflows" class="toolSectionBody">','<div class="toolSectionBg"/>',"</div>","</div>","</div>"].join("")},toString:function(){return"ToolPanel"}});t.exports=r}).call(e,i(1),i(2))},,,,,,,,,,function(t,e,i){var n,s;(function(a,o){n=[i(29),i(70),i(6),i(5)],s=function(t,e,i,n){"use strict";var s=t.DCListItemView,l=s.extend({initialize:function(t){s.prototype.initialize.call(this,t)},toString:function(){var t=this.model?this.model+"":"(no model)";return"DCListItemEdit("+t+")"}}),r=t.DCEListItemView,c=r.extend({initialize:function(t){r.prototype.initialize.call(this,t)},toString:function(){var t=this.model?this.model+"":"(no model)";return"DCEListItemEdit("+t+")"}}),d=e.DatasetListItemEdit.extend({initialize:function(t){e.DatasetListItemEdit.prototype.initialize.call(this,t)},_fetchModelDetails:function(){var t=this;return t.model.inReadyState()&&!t.model.hasDetails()?t.model.fetch({silent:!0}):a.when()},_renderDeleteButton:function(){return null},toString:function(){var t=this.model?this.model+"":"(no model)";return"DatasetDCEListItemEdit("+t+")"}});d.prototype.templates=function(){return o.extend({},e.DatasetListItemEdit.prototype.templates,{titleBar:t.DatasetDCEListItemView.prototype.templates.titleBar})}();var h=t.NestedDCDCEListItemView.extend({toString:function(){var t=this.model?this.model+"":"(no model)";return"NestedDCDCEListItemEdit("+t+")"}});return{DCListItemEdit:l,DCEListItemEdit:c,DatasetDCEListItemEdit:d,NestedDCDCEListItemEdit:h}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(1),i(2))},function(t,e,i){var n,s;n=[i(69),i(30),i(98),i(6),i(5),i(16)],s=function(t,e,i,n,s){"use strict";var a=t.CollectionView,o=a.extend({DatasetDCEViewClass:i.DatasetDCEListItemEdit,NestedDCDCEViewClass:i.NestedDCDCEListItemEdit,initialize:function(t){a.prototype.initialize.call(this,t)},_setUpBehaviors:function(t){if(t=t||this.$el,a.prototype._setUpBehaviors.call(this,t),this.model&&Galaxy.user&&!Galaxy.user.isAnonymous()){var e=this,i="> .controls .name";t.find(i).attr("title",s("Click to rename collection")).tooltip({placement:"bottom"}).make_text_editable({on_finish:function(t){var n=e.model.get("name");t&&t!==n?(e.$el.find(i).text(t),e.model.save({name:t}).fail(function(){e.$el.find(i).text(e.model.previous("name"))})):e.$el.find(i).text(n)}})}},toString:function(){return"CollectionViewEdit("+(this.model?this.model.get("name"):"")+")"}}),l=o.extend({DatasetDCEViewClass:i.DatasetDCEListItemEdit,toString:function(){return"ListCollectionViewEdit("+(this.model?this.model.get("name"):"")+")"}}),r=l.extend({toString:function(){return"PairCollectionViewEdit("+(this.model?this.model.get("name"):"")+")"}}),c=r.extend({_setUpBehaviors:function(t){a.prototype._setUpBehaviors.call(this,t)},toString:function(){return"NestedPairCollectionViewEdit("+(this.model?this.model.get("name"):"")+")"}}),d=o.extend({NestedDCDCEViewClass:i.NestedDCDCEListItemEdit.extend({foldoutPanelClass:c}),toString:function(){return"ListOfPairsCollectionViewEdit("+(this.model?this.model.get("name"):"")+")"}}),h=o.extend({NestedDCDCEViewClass:i.NestedDCDCEListItemEdit.extend({foldoutPanelClass:c}),toString:function(){return"ListOfListsCollectionViewEdit("+(this.model?this.model.get("name"):"")+")"}});return{CollectionViewEdit:o,ListCollectionViewEdit:l,PairCollectionViewEdit:r,ListOfPairsCollectionViewEdit:d,ListOfListsCollectionViewEdit:h}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;(function(a,o,l,r){n=[i(122),i(85),i(31),i(6),i(5),i(82)],s=function(t,e,i,n,s){"use strict";function c(t){function e(){return i.length||(i=[new RegExp(this.filters[0]),new RegExp(this.filters[1])]),i}t=t||{},t.createPair=t.createPair||function(t){t=t||{};var e=t.listA.splice(t.indexA,1)[0],i=t.listB.splice(t.indexB,1)[0],n=t.listB.indexOf(e),s=t.listA.indexOf(i);return n!==-1&&t.listB.splice(n,1),s!==-1&&t.listA.splice(s,1),this._pair(e,i,{silent:!0})};var i=[];return t.preprocessMatch=t.preprocessMatch||function(t){var i=e.call(this);return o.extend(t,{matchTo:t.matchTo.name.replace(i[0],""),possible:t.possible.name.replace(i[1],"")})},function(e){this.debug("autopair _strategy ---------------------------"),e=e||{};var i,n=e.listA,s=e.listB,a=0,o={score:0,index:null},l=[];for(this.debug("starting list lens:",n.length,s.length),this.debug("bestMatch (starting):",JSON.stringify(o,null,"  "));a<n.length;){var r=n[a];for(o.score=0,i=0;i<s.length;i++){var c=s[i];if(this.debug(a+":"+r.name),this.debug(i+":"+c.name),n[a]!==s[i]&&(o=t.match.call(this,t.preprocessMatch.call(this,{matchTo:r,possible:c,index:i,bestMatch:o})),this.debug("bestMatch:",JSON.stringify(o,null,"  ")),1===o.score)){this.debug("breaking early due to perfect match");break}}var d=t.scoreThreshold.call(this);if(this.debug("scoreThreshold:",d),this.debug("bestMatch.score:",o.score),o.score>=d?l.push(t.createPair.call(this,{listA:n,indexA:a,listB:s,indexB:o.index})):a+=1,!n.length||!s.length)return l}return this.debug("paired:",JSON.stringify(l,null,"  ")),this.debug("autopair _strategy ---------------------------"),l}}function d(t){var e=t.toJSON();return g(e,{historyId:t.historyId})}var h="collections",u=a.View.extend(n.LoggableMixin).extend({_logNamespace:h,tagName:"li",className:"dataset paired",initialize:function(t){this.pair=t.pair||{}},template:o.template(['<span class="forward-dataset-name flex-column"><%- pair.forward.name %></span>','<span class="pair-name-column flex-column">','<span class="pair-name"><%- pair.name %></span>',"</span>",'<span class="reverse-dataset-name flex-column"><%- pair.reverse.name %></span>'].join("")),render:function(){return this.$el.attr("draggable",!0).data("pair",this.pair).html(this.template({pair:this.pair})).addClass("flex-column-container"),this},events:{dragstart:"_dragstart",dragend:"_dragend",dragover:"_sendToParent",drop:"_sendToParent"},_dragstart:function(t){t.currentTarget.style.opacity="0.4",t.originalEvent&&(t=t.originalEvent),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",JSON.stringify(this.pair)),this.$el.parent().trigger("pair.dragstart",[this])},_dragend:function(t){t.currentTarget.style.opacity="1.0",this.$el.parent().trigger("pair.dragend",[this])},_sendToParent:function(t){this.$el.parent().trigger(t)},toString:function(){return"PairView("+this.pair.name+")"}}),p=a.View.extend(n.LoggableMixin).extend({_logNamespace:h,className:"list-of-pairs-collection-creator collection-creator flex-row-container",initialize:function(t){this.metric("PairedCollectionCreator.initialize",t),t=o.defaults(t,{datasets:[],filters:this.DEFAULT_FILTERS,automaticallyPair:!0,strategy:"lcs",matchPercentage:.9,twoPassAutopairing:!0}),this.initialList=t.datasets,this.historyId=t.historyId,this.filters=this.commonFilters[t.filters]||this.commonFilters[this.DEFAULT_FILTERS],o.isArray(t.filters)&&(this.filters=t.filters),this.automaticallyPair=t.automaticallyPair,this.strategy=this.strategies[t.strategy]||this.strategies[this.DEFAULT_STRATEGY],o.isFunction(t.strategy)&&(this.strategy=t.strategy),this.matchPercentage=t.matchPercentage,this.twoPassAutopairing=t.twoPassAutopairing,this.removeExtensions=!0,this.oncancel=t.oncancel,this.oncreate=t.oncreate,this.autoscrollDist=t.autoscrollDist||24,this.unpairedPanelHidden=!1,this.pairedPanelHidden=!1,this.$dragging=null,this.blocking=!1,this._setUpBehaviors(),this._dataSetUp()},commonFilters:{illumina:["_1","_2"],Rs:["_R1","_R2"]},DEFAULT_FILTERS:"illumina",strategies:{simple:"autopairSimple",lcs:"autopairLCS",levenshtein:"autopairLevenshtein"},DEFAULT_STRATEGY:"lcs",_dataSetUp:function(){this.paired=[],this.unpaired=[],this.selectedIds=[],this._sortInitialList(),this._ensureIds(),this.unpaired=this.initialList.slice(0),this.automaticallyPair&&(this.autoPair(),this.once("rendered:initial",function(){this.trigger("autopair")}))},_sortInitialList:function(){this._sortDatasetList(this.initialList)},_sortDatasetList:function(t){return t.sort(function(t,i){return e(t.name,i.name)}),t},_ensureIds:function(){return this.initialList.forEach(function(t){t.hasOwnProperty("id")||(t.id=o.uniqueId())}),this.initialList},_splitByFilters:function(){function t(t,e){return e.test(t.name)}var e=this.filters.map(function(t){return new RegExp(t)}),i=[[],[]];return this.unpaired.forEach(function(n){e.forEach(function(e,s){t(n,e)&&i[s].push(n)})}),i},_addToUnpaired:function(t){var i=function(n,s){if(n===s)return n;var a=Math.floor((s-n)/2)+n,o=e(t.name,this.unpaired[a].name);if(o<0)return i(n,a);if(o>0)return i(a+1,s);for(;this.unpaired[a]&&this.unpaired[a].name===t.name;)a++;return a}.bind(this);this.unpaired.splice(i(0,this.unpaired.length),0,t)},autoPair:function(t){var e=this._splitByFilters(),i=[];return this.twoPassAutopairing&&(i=this.autopairSimple({listA:e[0],listB:e[1]}),e=this._splitByFilters()),t=t||this.strategy,e=this._splitByFilters(),i=i.concat(this[t].call(this,{listA:e[0],listB:e[1]}))},autopairSimple:c({scoreThreshold:function(){return 1},match:function(t){return t=t||{},t.matchTo===t.possible?{index:t.index,score:1}:t.bestMatch}}),autopairLevenshtein:c({scoreThreshold:function(){return this.matchPercentage},match:function(e){e=e||{};var i=t(e.matchTo,e.possible),n=1-i/Math.max(e.matchTo.length,e.possible.length);return n>e.bestMatch.score?{index:e.index,score:n}:e.bestMatch}}),autopairLCS:c({scoreThreshold:function(){return this.matchPercentage},match:function(t){t=t||{};var e=this._naiveStartingAndEndingLCS(t.matchTo,t.possible).length,i=e/Math.max(t.matchTo.length,t.possible.length);return i>t.bestMatch.score?{index:t.index,score:i}:t.bestMatch}}),_naiveStartingAndEndingLCS:function(t,e){for(var i="",n="",s=0,a=0;s<t.length&&s<e.length&&t[s]===e[s];)i+=t[s],s+=1;if(s===t.length)return t;if(s===e.length)return e;for(s=t.length-1,a=e.length-1;s>=0&&a>=0&&t[s]===e[a];)n=[t[s],n].join(""),s-=1,a-=1;return i+n},_pair:function(t,e,i){i=i||{},this.debug("_pair:",t,e);var n=this._createPair(t,e,i.name);return this.paired.push(n),this.unpaired=o.without(this.unpaired,t,e),i.silent||this.trigger("pair:new",n),n},_createPair:function(t,e,i){if(!t||!e||t===e)throw new Error("Bad pairing: "+[JSON.stringify(t),JSON.stringify(e)]);return i=i||this._guessNameForPair(t,e),{forward:t,name:i,reverse:e}},_guessNameForPair:function(t,e,i){i=void 0!==i?i:this.removeExtensions;var n=t.name,s=e.name,a=this._naiveStartingAndEndingLCS(n.replace(new RegExp(this.filters[0]),""),s.replace(new RegExp(this.filters[1]),""));if(i){var o=a.lastIndexOf(".");if(o>0){var l=a.slice(o,a.length);a=a.replace(l,""),n=n.replace(l,""),s=s.replace(l,"")}}return a||n+" & "+s},_unpair:function(t,e){if(e=e||{},!t)throw new Error("Bad pair: "+JSON.stringify(t));return this.paired=o.without(this.paired,t),this._addToUnpaired(t.forward),this._addToUnpaired(t.reverse),e.silent||this.trigger("pair:unpair",[t]),t},unpairAll:function(){for(var t=[];this.paired.length;)t.push(this._unpair(this.paired[0],{silent:!0}));this.trigger("pair:unpair",t)},_pairToJSON:function(t,e){return e=e||"hda",{collection_type:"paired",src:"new_collection",name:t.name,element_identifiers:[{name:"forward",id:t.forward.id,src:e},{name:"reverse",id:t.reverse.id,src:e}]}},createList:function(t){var e=this,i=Galaxy.root+"api/histories/"+this.historyId+"/contents/dataset_collections",n={type:"dataset_collection",collection_type:"list:paired",name:o.escape(t||e.$(".collection-name").val()),element_identifiers:e.paired.map(function(t){return e._pairToJSON(t)})};return e.blocking=!0,l.ajax(i,{type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify(n)}).always(function(){e.blocking=!1}).fail(function(t,i,n){e._ajaxErrHandler(t,i,n)}).done(function(t,i,n){e.trigger("collection:created",t,i,n),e.metric("collection:created",t),"function"==typeof e.oncreate&&e.oncreate.call(this,t,i,n)})},_ajaxErrHandler:function(t,e,i){this.error(t,e,i);var n=s("An error occurred while creating this collection");t&&(n+=0===t.readyState&&0===t.status?": "+s("Galaxy could not be reached and may be updating.")+s(" Try again in a few minutes."):t.responseJSON?"<br /><pre>"+JSON.stringify(t.responseJSON)+"</pre>":": "+i),creator._showAlert(n,"alert-danger")},render:function(t,e){return this.$el.empty().html(p.templates.main()),this._renderHeader(t),this._renderMiddle(t),this._renderFooter(t),this._addPluginComponents(),this.trigger("rendered",this),this},_renderHeader:function(t,e){var i=this.$(".header").empty().html(p.templates.header()).find(".help-content").prepend(r(p.templates.helpContent()));return this._renderFilters(),i},_renderFilters:function(){return this.$(".forward-column .column-header input").val(this.filters[0]).add(this.$(".reverse-column .column-header input").val(this.filters[1]))},_renderMiddle:function(t,e){var i=this.$(".middle").empty().html(p.templates.middle());return this.unpairedPanelHidden?this.$(".unpaired-columns").hide():this.pairedPanelHidden&&this.$(".paired-columns").hide(),this._renderUnpaired(),this._renderPaired(),i},_renderUnpaired:function(t,e){var i,n,a=this,o=[],l=this._splitByFilters();return this.$(".forward-column .title").text([l[0].length,s("unpaired forward")].join(" ")),this.$(".forward-column .unpaired-info").text(this._renderUnpairedDisplayStr(this.unpaired.length-l[0].length)),this.$(".reverse-column .title").text([l[1].length,s("unpaired reverse")].join(" ")),this.$(".reverse-column .unpaired-info").text(this._renderUnpairedDisplayStr(this.unpaired.length-l[1].length)),this.$(".unpaired-columns .column-datasets").empty(),this.$(".autopair-link").toggle(0!==this.unpaired.length),0===this.unpaired.length?void this._renderUnpairedEmpty():(n=l[1].map(function(t,e){return void 0!==l[0][e]&&l[0][e]!==t&&o.push(a._renderPairButton()),a._renderUnpairedDataset(t)}),i=l[0].map(function(t){return a._renderUnpairedDataset(t)}),i.length||n.length?(this.$(".unpaired-columns .forward-column .column-datasets").append(i).add(this.$(".unpaired-columns .paired-column .column-datasets").append(o)).add(this.$(".unpaired-columns .reverse-column .column-datasets").append(n)),void this._adjUnpairedOnScrollbar()):void this._renderUnpairedNotShown())},_renderUnpairedDisplayStr:function(t){return["(",t," ",s("filtered out"),")"].join("")},_renderUnpairedDataset:function(t){return r("<li/>").attr("id","dataset-"+t.id).addClass("dataset unpaired").attr("draggable",!0).addClass(t.selected?"selected":"").append(r("<span/>").addClass("dataset-name").text(t.name)).data("dataset",t)},_renderPairButton:function(){return r("<li/>").addClass("dataset unpaired").append(r("<span/>").addClass("dataset-name").text(s("Pair these datasets")))},_renderUnpairedEmpty:function(){var t=r('<div class="empty-message"></div>').text("("+s("no remaining unpaired datasets")+")");return this.$(".unpaired-columns .paired-column .column-datasets").empty().prepend(t),t},_renderUnpairedNotShown:function(){var t=r('<div class="empty-message"></div>').text("("+s("no datasets were found matching the current filters")+")");return this.$(".unpaired-columns .paired-column .column-datasets").empty().prepend(t),t},_adjUnpairedOnScrollbar:function(){var t=this.$(".unpaired-columns").last(),e=this.$(".unpaired-columns .reverse-column .dataset").first();if(e.length){var i=t.offset().left+t.outerWidth(),n=e.offset().left+e.outerWidth(),s=Math.floor(i)-Math.floor(n);this.$(".unpaired-columns .forward-column").css("margin-left",s>0?s:0)}},_renderPaired:function(t,e){if(this.$(".paired-column-title .title").text([this.paired.length,s("paired")].join(" ")),this.$(".unpair-all-link").toggle(0!==this.paired.length),0===this.paired.length)return void this._renderPairedEmpty();this.$(".remove-extensions-link").show(),this.$(".paired-columns .column-datasets").empty();var i=this;this.paired.forEach(function(t,e){var n=new u({pair:t});i.$(".paired-columns .column-datasets").append(n.render().$el).append(['<button class="unpair-btn">','<span class="fa fa-unlink" title="',s("Unpair"),'"></span>',"</button>"].join(""))})},_renderPairedEmpty:function(){var t=r('<div class="empty-message"></div>').text("("+s("no paired datasets yet")+")");return this.$(".paired-columns .column-datasets").empty().prepend(t),t},_renderFooter:function(t,e){var i=this.$(".footer").empty().html(p.templates.footer());return this.$(".remove-extensions").prop("checked",this.removeExtensions),"function"==typeof this.oncancel&&this.$(".cancel-create.btn").show(),i},_addPluginComponents:function(){this._chooseFiltersPopover(".choose-filters-link"),this.$(".help-content i").hoverhighlight(".collection-creator","rgba( 64, 255, 255, 1.0 )")},_chooseFiltersPopover:function(t){function e(t,e){return['<button class="filter-choice btn" ','data-forward="',t,'" data-reverse="',e,'">',s("Forward"),": ",t,", ",s("Reverse"),": ",e,"</button>"].join("")}var i=r(o.template(['<div class="choose-filters">','<div class="help">',s("Choose from the following filters to change which unpaired reads are shown in the display"),":</div>",o.values(this.commonFilters).map(function(t){return e(t[0],t[1])}).join(""),"</div>"].join(""))({}));return this.$(t).popover({container:".collection-creator",placement:"bottom",html:!0,content:i})},_validationWarning:function(t,e){var i="validation-warning";"name"===t&&(t=this.$(".collection-name").add(this.$(".collection-name-prompt")),this.$(".collection-name").focus().select()),e?(t=t||this.$("."+i),t.removeClass(i)):t.addClass(i)},_setUpBehaviors:function(){return this.once("rendered",function(){this.trigger("rendered:initial",this)}),this.on("pair:new",function(){this._renderUnpaired(),this._renderPaired(),this.$(".paired-columns").scrollTop(8e6)}),this.on("pair:unpair",function(t){this._renderUnpaired(),this._renderPaired(),this.splitView()}),this.on("filter-change",function(){this.filters=[this.$(".forward-unpaired-filter input").val(),this.$(".reverse-unpaired-filter input").val()],this.metric("filter-change",this.filters),this._renderFilters(),this._renderUnpaired()}),this.on("autopair",function(){this._renderUnpaired(),this._renderPaired();var t,e=null;this.paired.length?(e="alert-success",t=this.paired.length+" "+s("pairs created"),this.unpaired.length||(t+=": "+s("all datasets have been successfully paired"),this.hideUnpaired(),this.$(".collection-name").focus())):t=s(["Could not automatically create any pairs from the given dataset names.","You may want to choose or enter different filters and try auto-pairing again.","Close this message using the X on the right to view more help."].join(" ")),this._showAlert(t,e)}),this},events:{"click .more-help":"_clickMoreHelp","click .less-help":"_clickLessHelp","click .header .alert button":"_hideAlert","click .forward-column .column-title":"_clickShowOnlyUnpaired","click .reverse-column .column-title":"_clickShowOnlyUnpaired","click .unpair-all-link":"_clickUnpairAll","change .forward-unpaired-filter input":function(t){this.trigger("filter-change")},"focus .forward-unpaired-filter input":function(t){r(t.currentTarget).select()},"click .autopair-link":"_clickAutopair","click .choose-filters .filter-choice":"_clickFilterChoice","click .clear-filters-link":"_clearFilters","change .reverse-unpaired-filter input":function(t){this.trigger("filter-change")},"focus .reverse-unpaired-filter input":function(t){r(t.currentTarget).select()},"click .forward-column .dataset.unpaired":"_clickUnpairedDataset","click .reverse-column .dataset.unpaired":"_clickUnpairedDataset","click .paired-column .dataset.unpaired":"_clickPairRow","click .unpaired-columns":"clearSelectedUnpaired","mousedown .unpaired-columns .dataset":"_mousedownUnpaired","click .paired-column-title":"_clickShowOnlyPaired","mousedown .flexible-partition-drag":"_startPartitionDrag","click .paired-columns .dataset.paired":"selectPair","click .paired-columns":"clearSelectedPaired","click .paired-columns .pair-name":"_clickPairName","click .unpair-btn":"_clickUnpair","dragover .paired-columns .column-datasets":"_dragoverPairedColumns","drop .paired-columns .column-datasets":"_dropPairedColumns","pair.dragstart .paired-columns .column-datasets":"_pairDragstart","pair.dragend   .paired-columns .column-datasets":"_pairDragend","change .remove-extensions":function(t){this.toggleExtensions()},"change .collection-name":"_changeName","keydown .collection-name":"_nameCheckForEnter","click .cancel-create":function(t){"function"==typeof this.oncancel&&this.oncancel.call(this)},"click .create-collection":"_clickCreate"
},_clickMoreHelp:function(t){this.$(".main-help").addClass("expanded"),this.$(".more-help").hide()},_clickLessHelp:function(t){this.$(".main-help").removeClass("expanded"),this.$(".more-help").show()},_showAlert:function(t,e){e=e||"alert-danger",this.$(".main-help").hide(),this.$(".header .alert").attr("class","alert alert-dismissable").addClass(e).show().find(".alert-message").html(t)},_hideAlert:function(t){this.$(".main-help").show(),this.$(".header .alert").hide()},_clickShowOnlyUnpaired:function(t){this.$(".paired-columns").is(":visible")?this.hidePaired():this.splitView()},_clickShowOnlyPaired:function(t){this.$(".unpaired-columns").is(":visible")?this.hideUnpaired():this.splitView()},hideUnpaired:function(t,e){this.unpairedPanelHidden=!0,this.pairedPanelHidden=!1,this._renderMiddle(t,e)},hidePaired:function(t,e){this.unpairedPanelHidden=!1,this.pairedPanelHidden=!0,this._renderMiddle(t,e)},splitView:function(t,e){return this.unpairedPanelHidden=this.pairedPanelHidden=!1,this._renderMiddle(t,e),this},_clickUnpairAll:function(t){this.metric("unpairAll"),this.unpairAll()},_clickAutopair:function(t){var e=this.autoPair();this.metric("autopair",e.length,this.unpaired.length),this.trigger("autopair")},_clickFilterChoice:function(t){var e=r(t.currentTarget);this.$(".forward-unpaired-filter input").val(e.data("forward")),this.$(".reverse-unpaired-filter input").val(e.data("reverse")),this._hideChooseFilters(),this.trigger("filter-change")},_hideChooseFilters:function(){this.$(".choose-filters-link").popover("hide"),this.$(".popover").css("display","none")},_clearFilters:function(t){this.$(".forward-unpaired-filter input").val(""),this.$(".reverse-unpaired-filter input").val(""),this.trigger("filter-change")},_clickUnpairedDataset:function(t){return t.stopPropagation(),this.toggleSelectUnpaired(r(t.currentTarget))},toggleSelectUnpaired:function(t,e){e=e||{};var i=t.data("dataset"),n=void 0!==e.force?e.force:!t.hasClass("selected");return t.length&&void 0!==i?(n?(t.addClass("selected"),e.waitToPair||this.pairAllSelected()):t.removeClass("selected"),t):t},pairAllSelected:function(t){t=t||{};var e=this,i=[],n=[],s=[];return e.$(".unpaired-columns .forward-column .dataset.selected").each(function(){i.push(r(this).data("dataset"))}),e.$(".unpaired-columns .reverse-column .dataset.selected").each(function(){n.push(r(this).data("dataset"))}),i.length=n.length=Math.min(i.length,n.length),i.forEach(function(t,i){try{s.push(e._pair(t,n[i],{silent:!0}))}catch(a){e.error(a)}}),s.length&&!t.silent&&this.trigger("pair:new",s),s},clearSelectedUnpaired:function(){this.$(".unpaired-columns .dataset.selected").removeClass("selected")},_mousedownUnpaired:function(t){if(t.shiftKey){var e=this,i=r(t.target).addClass("selected"),n=function(t){e.$(t.target).filter(".dataset").addClass("selected")};i.parent().on("mousemove",n),r(document).one("mouseup",function(t){i.parent().off("mousemove",n),e.pairAllSelected()})}},_clickPairRow:function(t){var e=r(t.currentTarget).index(),i=r(".unpaired-columns .forward-column .dataset").eq(e).data("dataset"),n=r(".unpaired-columns .reverse-column .dataset").eq(e).data("dataset");this._pair(i,n)},_startPartitionDrag:function(t){function e(t){n.$(".flexible-partition-drag").css("color",""),r("body").css("cursor","").unbind("mousemove",i)}function i(t){var e=t.pageY-s;n.adjPartition(e)||r("body").trigger("mouseup"),n._adjUnpairedOnScrollbar(),s+=e}var n=this,s=t.pageY;r("body").css("cursor","ns-resize"),n.$(".flexible-partition-drag").css("color","black"),r("body").mousemove(i),r("body").one("mouseup",e)},adjPartition:function(t){var e=this.$(".unpaired-columns"),i=this.$(".paired-columns"),n=parseInt(e.css("height"),10),s=parseInt(i.css("height"),10);n=Math.max(10,n+t),s-=t;var a=t<0;if(a){if(this.unpairedPanelHidden)return!1;if(n<=10)return this.hideUnpaired(),!1}else this.unpairedPanelHidden&&(e.show(),this.unpairedPanelHidden=!1);if(a)this.pairedPanelHidden&&(i.show(),this.pairedPanelHidden=!1);else{if(this.pairedPanelHidden)return!1;if(s<=15)return this.hidePaired(),!1}return e.css({height:n+"px",flex:"0 0 auto"}),!0},selectPair:function(t){t.stopPropagation(),r(t.currentTarget).toggleClass("selected")},clearSelectedPaired:function(t){this.$(".paired-columns .dataset.selected").removeClass("selected")},_clickPairName:function(t){t.stopPropagation();var e=r(t.currentTarget),i=e.parent().parent(),n=i.index(".dataset.paired"),s=this.paired[n],a=prompt("Enter a new name for the pair:",s.name);a&&(s.name=a,s.customizedName=!0,e.text(s.name))},_clickUnpair:function(t){var e=Math.floor(r(t.currentTarget).index(".unpair-btn"));this._unpair(this.paired[e])},_dragoverPairedColumns:function(t){t.preventDefault();var e=this.$(".paired-columns .column-datasets");this._checkForAutoscroll(e,t.originalEvent.clientY);var i=this._getNearestPairedDatasetLi(t.originalEvent.clientY);r(".element-drop-placeholder").remove();var n=r('<div class="element-drop-placeholder"></div>');i.length?i.before(n):e.append(n)},_checkForAutoscroll:function(t,e){var i=2,n=t.offset(),s=t.scrollTop(),a=e-n.top,o=n.top+t.outerHeight()-e;a>=0&&a<this.autoscrollDist?t.scrollTop(s-i):o>=0&&o<this.autoscrollDist&&t.scrollTop(s+i)},_getNearestPairedDatasetLi:function(t){for(var e=4,i=this.$(".paired-columns .column-datasets li").toArray(),n=0;n<i.length;n++){var s=r(i[n]),a=s.offset().top,o=Math.floor(s.outerHeight()/2)+e;if(a+o>t&&a-o<t)return s}return r()},_dropPairedColumns:function(t){t.preventDefault(),t.dataTransfer.dropEffect="move";var e=this._getNearestPairedDatasetLi(t.originalEvent.clientY);return e.length?this.$dragging.insertBefore(e):this.$dragging.insertAfter(this.$(".paired-columns .unpair-btn").last()),this._syncPairsToDom(),!1},_syncPairsToDom:function(){var t=[];this.$(".paired-columns .dataset.paired").each(function(){t.push(r(this).data("pair"))}),this.paired=t,this._renderPaired()},_pairDragstart:function(t,e){e.$el.addClass("selected");var i=this.$(".paired-columns .dataset.selected");this.$dragging=i},_pairDragend:function(t,e){r(".element-drop-placeholder").remove(),this.$dragging=null},toggleExtensions:function(t){var e=this;e.removeExtensions=void 0!==t?t:!e.removeExtensions,o.each(e.paired,function(t){t.customizedName||(t.name=e._guessNameForPair(t.forward,t.reverse))}),e._renderPaired(),e._renderFooter()},_changeName:function(t){this._validationWarning("name",!!this._getName())},_nameCheckForEnter:function(t){13!==t.keyCode||this.blocking||this._clickCreate()},_getName:function(){return o.escape(this.$(".collection-name").val())},_clickCreate:function(t){var e=this._getName();e?this.blocking||this.createList():this._validationWarning("name")},_printList:function(t){var e=this;o.each(t,function(i){t===e.paired&&e._printPair(i)})},_printPair:function(t){this.debug(t.forward.name,t.reverse.name,": ->",t.name)},toString:function(){return"PairedCollectionCreator"}});p.templates=p.templates||{main:o.template(['<div class="header flex-row no-flex"></div>','<div class="middle flex-row flex-row-container"></div>','<div class="footer flex-row no-flex">'].join("")),header:o.template(['<div class="main-help well clear">','<a class="more-help" href="javascript:void(0);">',s("More help"),"</a>",'<div class="help-content">','<a class="less-help" href="javascript:void(0);">',s("Less"),"</a>","</div>","</div>",'<div class="alert alert-dismissable">','<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>','<span class="alert-message"></span>',"</div>",'<div class="column-headers vertically-spaced flex-column-container">','<div class="forward-column flex-column column">','<div class="column-header">','<div class="column-title">','<span class="title">',s("Unpaired forward"),"</span>",'<span class="title-info unpaired-info"></span>',"</div>",'<div class="unpaired-filter forward-unpaired-filter pull-left">','<input class="search-query" placeholder="',s("Filter this list"),'" />',"</div>","</div>","</div>",'<div class="paired-column flex-column no-flex column">','<div class="column-header">','<a class="choose-filters-link" href="javascript:void(0)">',s("Choose filters"),"</a>",'<a class="clear-filters-link" href="javascript:void(0);">',s("Clear filters"),"</a><br />",'<a class="autopair-link" href="javascript:void(0);">',s("Auto-pair"),"</a>","</div>","</div>",'<div class="reverse-column flex-column column">','<div class="column-header">','<div class="column-title">','<span class="title">',s("Unpaired reverse"),"</span>",'<span class="title-info unpaired-info"></span>',"</div>",'<div class="unpaired-filter reverse-unpaired-filter pull-left">','<input class="search-query" placeholder="',s("Filter this list"),'" />',"</div>","</div>","</div>","</div>"].join("")),middle:o.template(['<div class="unpaired-columns flex-column-container scroll-container flex-row">','<div class="forward-column flex-column column">','<ol class="column-datasets"></ol>',"</div>",'<div class="paired-column flex-column no-flex column">','<ol class="column-datasets"></ol>',"</div>",'<div class="reverse-column flex-column column">','<ol class="column-datasets"></ol>',"</div>","</div>",'<div class="flexible-partition">','<div class="flexible-partition-drag" title="',s("Drag to change"),'"></div>','<div class="column-header">','<div class="column-title paired-column-title">','<span class="title"></span>',"</div>",'<a class="unpair-all-link" href="javascript:void(0);">',s("Unpair all"),"</a>","</div>","</div>",'<div class="paired-columns flex-column-container scroll-container flex-row">','<ol class="column-datasets"></ol>',"</div>"].join("")),footer:o.template(['<div class="attributes clear">','<div class="clear">','<label class="remove-extensions-prompt pull-right">',s("Remove file extensions from pair names"),"?",'<input class="remove-extensions pull-right" type="checkbox" />',"</label>","</div>",'<div class="clear">','<input class="collection-name form-control pull-right" ','placeholder="',s("Enter a name for your new list"),'" />','<div class="collection-name-prompt pull-right">',s("Name"),":</div>","</div>","</div>",'<div class="actions clear vertically-spaced">','<div class="other-options pull-left">','<button class="cancel-create btn" tabindex="-1">',s("Cancel"),"</button>",'<div class="create-other btn-group dropup">','<button class="btn btn-default dropdown-toggle" data-toggle="dropdown">',s("Create a different kind of collection"),' <span class="caret"></span>',"</button>",'<ul class="dropdown-menu" role="menu">','<li><a href="#">',s("Create a <i>single</i> pair"),"</a></li>",'<li><a href="#">',s("Create a list of <i>unpaired</i> datasets"),"</a></li>","</ul>","</div>","</div>",'<div class="main-options pull-right">','<button class="create-collection btn btn-primary">',s("Create list"),"</button>","</div>","</div>"].join("")),helpContent:o.template(["<p>",s(["Collections of paired datasets are ordered lists of dataset pairs (often forward and reverse reads). ","These collections can be passed to tools and workflows in order to have analyses done on each member of ","the entire group. This interface allows you to create a collection, choose which datasets are paired, ","and re-order the final collection."].join("")),"</p>","<p>",s(['Unpaired datasets are shown in the <i data-target=".unpaired-columns">unpaired section</i> ',"(hover over the underlined words to highlight below). ",'Paired datasets are shown in the <i data-target=".paired-columns">paired section</i>.',"<ul>To pair datasets, you can:","<li>Click a dataset in the ",'<i data-target=".unpaired-columns .forward-column .column-datasets,','.unpaired-columns .forward-column">forward column</i> ',"to select it then click a dataset in the ",'<i data-target=".unpaired-columns .reverse-column .column-datasets,','.unpaired-columns .reverse-column">reverse column</i>.',"</li>",'<li>Click one of the "Pair these datasets" buttons in the ','<i data-target=".unpaired-columns .paired-column .column-datasets,','.unpaired-columns .paired-column">middle column</i> ',"to pair the datasets in a particular row.","</li>",'<li>Click <i data-target=".autopair-link">"Auto-pair"</i> ',"to have your datasets automatically paired based on name.","</li>","</ul>"].join("")),"</p>","<p>",s(["<ul>You can filter what is shown in the unpaired sections by:","<li>Entering partial dataset names in either the ",'<i data-target=".forward-unpaired-filter input">forward filter</i> or ','<i data-target=".reverse-unpaired-filter input">reverse filter</i>.',"</li>","<li>Choosing from a list of preset filters by clicking the ",'<i data-target=".choose-filters-link">"Choose filters" link</i>.',"</li>","<li>Entering regular expressions to match dataset names. See: ",'<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions"',' target="_blank">MDN\'s JavaScript Regular Expression Tutorial</a>. ',"Note: forward slashes (\\) are not needed.","</li>","<li>Clearing the filters by clicking the ",'<i data-target=".clear-filters-link">"Clear filters" link</i>.',"</li>","</ul>"].join("")),"</p>","<p>",s(["To unpair individual dataset pairs, click the ",'<i data-target=".unpair-btn">unpair buttons ( <span class="fa fa-unlink"></span> )</i>. ','Click the <i data-target=".unpair-all-link">"Unpair all" link</i> to unpair all pairs.'].join("")),"</p>","<p>",s(['You can include or remove the file extensions (e.g. ".fastq") from your pair names by toggling the ','<i data-target=".remove-extensions-prompt">"Remove file extensions from pair names?"</i> control.'].join("")),"</p>","<p>",s(['Once your collection is complete, enter a <i data-target=".collection-name">name</i> and ','click <i data-target=".create-collection">"Create list"</i>. ',"(Note: you do not have to pair all unpaired datasets to finish.)"].join("")),"</p>"].join(""))};var g=function(t,e){var i,n=l.Deferred();if(e=o.defaults(e||{},{datasets:t,oncancel:function(){Galaxy.modal.hide(),n.reject("cancelled")},oncreate:function(t,e){Galaxy.modal.hide(),n.resolve(e)}}),!window.Galaxy||!Galaxy.modal)throw new Error("Galaxy or Galaxy.modal not found");return i=new p(e),Galaxy.modal.show({title:"Create a collection of paired datasets",body:i.$el,width:"80%",height:"800px",closing_events:!0}),i.render(),window.creator=i,n};return{PairedCollectionCreator:p,pairedCollectionCreatorModal:g,createListOfPairsCollection:d}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2),i(1),i(1))},function(t,e,i){var n,s;(function(a,o,l){n=[i(31),i(39),i(6),i(5)],s=function(t,e,i,n){"use strict";function s(t){var e=t.toJSON(),i=u(e,{creationFn:function(e,i){return e=[{name:"forward",src:"hda",id:e[0].id},{name:"reverse",src:"hda",id:e[1].id}],t.createHDCA(e,"paired",i)}});return i}var r="collections",c=a.View.extend(i.LoggableMixin).extend({_logNamespace:r,tagName:"li",className:"collection-element",initialize:function(t){this.element=t.element||{},this.identifier=t.identifier},render:function(){return this.$el.attr("data-element-id",this.element.id).html(this.template({identifier:this.identifier,element:this.element})),this},template:o.template(['<span class="identifier"><%- identifier %></span>','<span class="name"><%- element.name %></span>'].join("")),destroy:function(){this.off(),this.$el.remove()},toString:function(){return"DatasetCollectionElementView()"}}),d=t.ListCollectionCreator,h=d.extend({elementViewClass:c,collectionClass:e.HistoryPairDatasetCollection,className:"pair-collection-creator collection-creator flex-row-container",_mangleDuplicateNames:function(){},render:function(t,e){return 2===this.workingElements.length?d.prototype.render.call(this,t,e):this._renderInvalid(t,e)},_renderList:function(t,e){var i=this,n=l("<div/>"),s=i.$list();o.each(this.elementViews,function(t){t.destroy(),i.removeElementView(t)}),n.append(i._createForwardElementView().$el),n.append(i._createReverseElementView().$el),s.empty().append(n.children()),o.invoke(i.elementViews,"render")},_createForwardElementView:function(){return this._createElementView(this.workingElements[0],{identifier:"forward"})},_createReverseElementView:function(){return this._createElementView(this.workingElements[1],{identifier:"reverse"})},_createElementView:function(t,e){var i=new this.elementViewClass(o.extend(e,{element:t}));return this.elementViews.push(i),i},swap:function(){this.workingElements=[this.workingElements[1],this.workingElements[0]],this._renderList()},events:o.extend(o.clone(d.prototype.events),{"click .swap":"swap"}),templates:o.extend(o.clone(d.prototype.templates),{middle:o.template(['<div class="collection-elements-controls">','<a class="swap" href="javascript:void(0);" title="',n("Swap forward and reverse datasets"),'">',n("Swap"),"</a>","</div>",'<div class="collection-elements scroll-container flex-row">',"</div>"].join("")),helpContent:o.template(["<p>",n(["Pair collections are permanent collections containing two datasets: one forward and one reverse. ","Often these are forward and reverse reads. The pair collections can be passed to tools and ","workflows in order to have analyses done on both datasets. This interface allows ","you to create a pair, name it, and swap which is forward and which reverse."].join("")),"</p>","<ul>","<li>",n(['Click the <i data-target=".swap">"Swap"</i> link to make your forward dataset the reverse ',"and the reverse dataset forward."].join("")),"</li>","<li>",n(['Click the <i data-target=".cancel-create">"Cancel"</i> button to exit the interface.'].join("")),"</li>","</ul><br />","<p>",n(['Once your collection is complete, enter a <i data-target=".collection-name">name</i> and ','click <i data-target=".create-collection">"Create list"</i>.'].join("")),"</p>"].join("")),invalidInitial:o.template(['<div class="header flex-row no-flex">','<div class="alert alert-warning" style="display: block">','<span class="alert-message">',"<% if( _.size( problems ) ){ %>",n("The following selections could not be included due to problems"),"<ul><% _.each( problems, function( problem ){ %>","<li><b><%- problem.element.name %></b>: <%- problem.text %></li>","<% }); %></ul>","<% } else if( _.size( elements ) === 0 ){ %>",n("No datasets were selected"),".","<% } else if( _.size( elements ) === 1 ){ %>",n("Only one dataset was selected"),": <%- elements[0].name %>","<% } else if( _.size( elements ) > 2 ){ %>",n("Too many datasets were selected"),': <%- _.pluck( elements, "name" ).join( ", ") %>',"<% } %>","<br />",n("Two (and only two) elements are needed for the pair"),". ",n("You may need to "),'<a class="cancel-create" href="javascript:void(0)">',n("cancel"),"</a> ",n("and reselect new elements"),".","</span>","</div>","</div>",'<div class="footer flex-row no-flex">','<div class="actions clear vertically-spaced">','<div class="other-options pull-left">','<button class="cancel-create btn" tabindex="-1">',n("Cancel"),"</button>","</div>","</div>","</div>"].join(""))}),toString:function(){return"PairCollectionCreator"}}),u=function(e,i){return i=i||{},i.title=n("Create a collection from a pair of datasets"),t.collectionCreatorModal(e,i,h)};return{PairCollectionCreator:h,pairCollectionCreatorModal:u,createPairCollection:s}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2),i(1))},function(t,e,i){var n,s;(function(a,o,l){n=[i(8),i(5)],s=function(t,e){"use strict";var i={defaultName:a.template("Copy of '<%- name %>'"),title:a.template(e("Copying history")+' "<%- name %>"'),submitLabel:e("Copy"),errorMessage:e("History could not be copied"),progressive:e("Copying history"),activeLabel:e("Copy only the active, non-deleted datasets"),allLabel:e("Copy all datasets including deleted ones"),anonWarning:e("As an anonymous user, unless you login or register, you will lose your current history ")+e("after copying this history. "),_template:a.template(["<% if( isAnon ){ %>",'<div class="warningmessage">',"<%- anonWarning %>",e("You can"),' <a href="/user/login">',e("login here"),"</a> ",e("or")," ",' <a href="/user/create">',e("register here"),"</a>.","</div>","<% } %>","<form>",'<label for="copy-modal-title">',e("Enter a title for the new history"),":","</label><br />",'<input id="copy-modal-title" class="form-control" style="width: 100%" value="<%= name %>" />','<p class="invalid-title bg-danger" style="color: red; margin: 8px 0px 8px 0px; display: none">',e("Please enter a valid history title"),"</p>","<% if( allowAll ){ %>","<br />","<p>",e("Choose which datasets from the original history to include:"),"</p>",'<input name="copy-what" type="radio" id="copy-non-deleted" value="copy-non-deleted" ','<% if( copyWhat === "copy-non-deleted" ){ print( "checked" ); } %>/>','<label for="copy-non-deleted"> <%- activeLabel %></label>',"<br />",'<input name="copy-what" type="radio" id="copy-all" value="copy-all" ','<% if( copyWhat === "copy-all" ){ print( "checked" ); } %>/>','<label for="copy-all"> <%- allLabel %></label>',"<% } %>","</form>"].join("")),_showAjaxIndicator:function(){var t='<p><span class="fa fa-spinner fa-spin"></span> '+this.progressive+"...</p>";this.modal.$(".modal-body").empty().append(t).css({"margin-top":"8px"})},dialog:function(t,i,n){function s(){var n=t.$("#copy-modal-title").val();if(!n)return void t.$(".invalid-title").show();var s="copy-all"===t.$('input[name="copy-what"]:checked').val();t.$("button").prop("disabled",!0),r._showAjaxIndicator(),i.copy(!0,n,s).done(function(t){c.resolve(t)}).fail(function(){alert([r.errorMessage,e("Please contact a Galaxy administrator")].join(". ")),c.rejectWith(c,arguments)}).always(function(){g&&t.hide()})}n=n||{};var r=this,c=o.Deferred(),d=n.nameFn||this.defaultName,h=d({name:i.get("name")}),u=n.allDatasets?"copy-all":"copy-non-deleted",p=!!a.isUndefined(n.allowAll)||n.allowAll,g=!!a.isUndefined(n.autoClose)||n.autoClose;this.modal=t;var f=n.closing_callback;return t.show(a.extend(n,{title:this.title({name:i.get("name")}),body:l(r._template({name:h,isAnon:Galaxy.user.isAnonymous(),allowAll:p,copyWhat:u,activeLabel:this.activeLabel,allLabel:this.allLabel,anonWarning:this.anonWarning})),buttons:a.object([[e("Cancel"),function(){t.hide()}],[this.submitLabel,s]]),height:"auto",closing_events:!0,closing_callback:function(t){t&&c.reject({cancelled:!0}),f&&f(t)}})),t.$("#copy-modal-title").focus().select(),t.$("#copy-modal-title").on("keydown",function(t){13===t.keyCode&&(t.preventDefault(),s())}),c}},n=a.extend({},i,{defaultName:a.template("imported: <%- name %>"),title:a.template(e("Importing history")+' "<%- name %>"'),submitLabel:e("Import"),errorMessage:e("History could not be imported"),progressive:e("Importing history"),activeLabel:e("Import only the active, non-deleted datasets"),allLabel:e("Import all datasets including deleted ones"),anonWarning:e("As an anonymous user, unless you login or register, you will lose your current history ")+e("after importing this history. ")}),s=function(e,s){s=s||{};var a=window.parent.Galaxy.modal||new t.View({});return s.useImport?n.dialog(a,e,s):i.dialog(a,e,s)};return s}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(2),i(1),i(1))},function(t,e,i){var n,s;(function(a,o){n=[i(70),i(72),i(6),i(5)],s=function(t,e,i,n){"use strict";var s=t.DatasetListItemEdit,l=s.extend({className:s.prototype.className+" history-content",_fetchModelDetails:function(){var t=this;return t.model.inReadyState()&&!t.model.hasDetails()?t.model.fetch({silent:!0}):t.model.has("rerunnable")?a.when():t.model.fetch({silent:!0,data:{keys:["rerunnable","creating_job"].join(",")}})},events:o.extend(o.clone(s.prototype.events),{"click .unhide-link":function(t){return this.model.unhide(),!1}}),toString:function(){var t=this.model?this.model+"":"(no model)";return"HDAListItemEdit("+t+")"}});return l.prototype.templates=function(){var t=o.extend({},s.prototype.templates.warnings,{hidden:i.wrapTemplate(["<% if( !dataset.visible ){ %>",'<div class="hidden-msg warningmessagesmall">',n("This dataset has been hidden"),'<br /><a class="unhide-link" a href="javascript:void(0);">',n("Unhide it"),"</a>","</div>","<% } %>"],"dataset")});return o.extend({},s.prototype.templates,{titleBar:e.HDAListItemView.prototype.templates.titleBar,warnings:t})}(),{HDAListItemEdit:l}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(1),i(2))},function(t,e,i){var n,s;n=[i(74),i(99),i(23),i(5)],s=function(t,e,i,n){"use strict";var s=t.HDCAListItemView,a=s.extend({_getFoldoutPanelClass:function(){switch(this.model.get("collection_type")){case"list":return e.ListCollectionViewEdit;case"paired":return e.PairCollectionViewEdit;case"list:paired":return e.ListOfPairsCollectionViewEdit;case"list:list":return e.ListOfListsCollectionViewEdit}throw new TypeError("Uknown collection_type: "+this.model.get("collection_type"))},_renderPrimaryActions:function(){return this.log(this+"._renderPrimaryActions"),s.prototype._renderPrimaryActions.call(this).concat([this._renderDeleteButton()])},_renderDeleteButton:function(){var t=this,e=this.model.get("deleted");return i({title:n(e?"Dataset collection is already deleted":"Delete"),classes:"delete-btn",faIcon:"fa-times",disabled:e,onclick:function(){t.$el.find(".icon-btn.delete-btn").trigger("mouseout"),t.model["delete"]()}})},toString:function(){var t=this.model?this.model+"":"(no model)";return"HDCAListItemEdit("+t+")"}});return{HDCAListItemEdit:a}}.apply(e,n),!(void 0!==s&&(t.exports=s))},function(t,e,i){var n,s;(function(a,o,l){n=[i(75),i(106),i(6),i(5)],s=function(t,e,i,n){"use strict";var s=i.SessionStorageModel.extend({defaults:{tagsEditorShown:!1,annotationEditorShown:!1,scrollPosition:0},toString:function(){return"HistoryViewPrefs("+JSON.stringify(this.toJSON())+")"}});s.storageKey=function(){return"history-panel"};var r=e.HistoryViewEdit,c=r.extend({className:r.prototype.className+" current-history-panel",emptyMsg:n("This history is empty. Click 'Get Data' on the left tool menu to start"),noneFoundMsg:n("No matching datasets found"),HDCAViewClass:r.prototype.HDCAViewClass.extend({foldoutStyle:"drilldown"}),initialize:function(t){t=t||{},this.preferences=new s(a.extend({id:s.storageKey()},a.pick(t,a.keys(s.prototype.defaults)))),r.prototype.initialize.call(this,t),this.panelStack=[],this.currentContentId=t.currentContentId||null},_setUpListeners:function(){r.prototype._setUpListeners.call(this);var t=this;this.on("new-model",function(){t.preferences.set("scrollPosition",0)})},loadCurrentHistory:function(t){this.debug(this+".loadCurrentHistory");var e=this;return this.loadHistoryWithDetails("current",t).then(function(t,i){e.trigger("current-history",e)})},switchToHistory:function(t,e){var i=this,n=function(){return o.getJSON(Galaxy.root+"history/set_as_current?id="+t)};return this.loadHistoryWithDetails(t,e,n).then(function(t,e){i.trigger("switched-history",i)})},createNewHistory:function(t){if(!Galaxy||!Galaxy.user||Galaxy.user.isAnonymous())return this.displayMessage("error",n("You must be logged in to create histories")),l.when();var e=this,i=function(){return o.getJSON(Galaxy.root+"history/create_new_current")};return this.loadHistory(void 0,t,i).then(function(t,i){e.trigger("new-history",e)})},setModel:function(t,e,i){return r.prototype.setModel.call(this,t,e,i),this.model&&(this.log("checking for updates"),this.model.checkForUpdates()),this},_setUpCollectionListeners:function(){r.prototype._setUpCollectionListeners.call(this),this.listenTo(this.collection,"state:ready",function(t,e,i){t.get("visible")||this.storage.get("show_hidden")||this.removeItemView(t)})},_setUpModelListeners:function(){r.prototype._setUpModelListeners.call(this),this.listenTo(this.model,"change:nice_size change:size",function(){this.trigger("history-size-change",this,this.model,arguments)},this)},_setUpBehaviors:function(t){t=t||this.$el;var e=this;return r.prototype._setUpBehaviors.call(e,t),this._debouncedScrollCaptureHandler||(this._debouncedScrollCaptureHandler=a.debounce(function(){e.$el.is(":visible")&&e.preferences.set("scrollPosition",l(this).scrollTop())},40)),e.$scrollContainer().off("scroll",this._debouncedScrollCaptureHandler).on("scroll",this._debouncedScrollCaptureHandler),e},_buildNewRender:function(){if(!this.model)return l();var t=r.prototype._buildNewRender.call(this);return t.find(".search").prependTo(t.find(".controls")),this._renderQuotaMessage(t),t},_renderQuotaMessage:function(t){return t=t||this.$el,l(this.templates.quotaMsg({},this)).prependTo(t.find(".messages"))},_renderEmptyMessage:function(t){var e=this,i=e.$emptyMessage(t),s=l(".toolMenuContainer");return a.isEmpty(e.views)&&!e.searchFor&&Galaxy&&Galaxy.upload&&s.length?(i.empty(),i.html([n("This history is empty"),". ",n("You can "),'<a class="uploader-link" href="javascript:void(0)">',n("load your own data"),"</a>",n(" or "),'<a class="get-data-link" href="javascript:void(0)">',n("get data from an external source"),"</a>"].join("")),i.find(".uploader-link").click(function(t){Galaxy.upload.show(t)}),i.find(".get-data-link").click(function(t){s.parent().scrollTop(0),s.find('span:contains("Get Data")').click()}),i.show()):r.prototype._renderEmptyMessage.call(this,t)},_renderTags:function(t){var e=this;r.prototype._renderTags.call(e,t),e.preferences.get("tagsEditorShown")&&e.tagsEditor.toggle(!0),e.listenTo(e.tagsEditor,"hiddenUntilActivated:shown hiddenUntilActivated:hidden",function(t){e.preferences.set("tagsEditorShown",t.hidden)})},_renderAnnotation:function(t){var e=this;r.prototype._renderAnnotation.call(e,t),e.preferences.get("annotationEditorShown")&&e.annotationEditor.toggle(!0),e.listenTo(e.annotationEditor,"hiddenUntilActivated:shown hiddenUntilActivated:hidden",function(t){e.preferences.set("annotationEditorShown",t.hidden)})},_swapNewRender:function(t){r.prototype._swapNewRender.call(this,t);var e=this;return a.delay(function(){var t=e.preferences.get("scrollPosition");t&&e.scrollTo(t,0)},10),this},_attachItems:function(t){r.prototype._attachItems.call(this,t);var e=this;return e.currentContentId&&e._setCurrentContentById(e.currentContentId),this},addItemView:function(t,e,i){var n=r.prototype.addItemView.call(this,t,e,i);return n&&this.panelStack.length?this._collapseDrilldownPanel():n},_setUpItemViewListeners:function(t){var e=this;return r.prototype._setUpItemViewListeners.call(e,t),e.listenTo(t,"expanded:drilldown",function(t,e){this._expandDrilldownPanel(e)}),e.listenTo(t,"collapsed:drilldown",function(t,e){this._collapseDrilldownPanel(e)}),this},setCurrentContent:function(t){this.$(".history-content.current-content").removeClass("current-content"),t?(t.$el.addClass("current-content"),this.currentContentId=t.model.id):this.currentContentId=null},_setCurrentContentById:function(t){var e=this.viewFromModelId(t)||null;this.setCurrentContent(e)},_expandDrilldownPanel:function(t){this.panelStack.push(t),this.$("> .controls").add(this.$list()).hide(),t.parentName=this.model.get("name"),this.$el.append(t.render().$el)},_collapseDrilldownPanel:function(t){this.panelStack.pop(),this.render()},listenToGalaxy:function(t){this.listenTo(t,"galaxy_main:load",function(t){var e=t.fullpath,i={display:/datasets\/([a-f0-9]+)\/display/,edit:/datasets\/([a-f0-9]+)\/edit/,report_error:/dataset\/errors\?id=([a-f0-9]+)/,rerun:/tool_runner\/rerun\?id=([a-f0-9]+)/,show_params:/datasets\/([a-f0-9]+)\/show_params/},n=null,s=null;a.find(i,function(t,i){var a=e.match(t);return!(!a||2!=a.length)&&(n=a[1],s=i,!0)}),n="dataset-"+n,this._setCurrentContentById(n)})},connectToQuotaMeter:function(t){return t?(this.listenTo(t,"quota:over",this.showQuotaMessage),this.listenTo(t,"quota:under",this.hideQuotaMessage),this.on("rendered rendered:initial",function(){t&&t.isOverQuota()&&this.showQuotaMessage()}),this):this},clearMessages:function(t){var e=a.isUndefined(t)?this.$messages().children('[class$="message"]'):l(t.currentTarget);return e=e.not(".quota-message"),e.fadeOut(this.fxSpeed,function(){l(this).remove()}),this},showQuotaMessage:function(){var t=this.$(".quota-message");t.is(":hidden")&&t.slideDown(this.fxSpeed)},hideQuotaMessage:function(){var t=this.$(".quota-message");t.is(":hidden")||t.slideUp(this.fxSpeed);
},toString:function(){return"CurrentHistoryView("+(this.model?this.model.get("name"):"")+")"}});return c.prototype.templates=function(){var t=i.wrapTemplate(['<div class="quota-message errormessage">',n("You are over your disk quota"),". ",n("Tool execution is on hold until your disk usage drops below your allocated quota"),".","</div>"],"history");return a.extend(a.clone(r.prototype.templates),{quotaMsg:t})}(),{CurrentHistoryView:c}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(2),i(1),i(1))},function(t,e,i){var n,s;(function(a,o,l){n=[i(107),i(41),i(10),i(73),i(103),i(104),i(77),i(68),i(31),i(101),i(100),i(23),i(46),i(5),i(16)],s=function(t,e,i,n,s,r,c,d,h,u,p,g,f,m){"use strict";var v=t.HistoryView,_=v.extend({HDAViewClass:s.HDAListItemEdit,HDCAViewClass:r.HDCAListItemEdit,initialize:function(t){t=t||{},v.prototype.initialize.call(this,t),this.tagsEditor=null,this.annotationEditor=null,this.purgeAllowed=t.purgeAllowed||!1,this.annotationEditorShown=t.annotationEditorShown||!1,this.tagsEditorShown=t.tagsEditorShown||!1},_setUpListeners:function(){var t=this;v.prototype._setUpListeners.call(t),t.on("drop",function(e,i){t.dataDropped(i),t.dropTargetOff()}),t.on("view:attached view:removed",function(){t._renderCounts()})},_setUpCollectionListeners:function(){return v.prototype._setUpCollectionListeners.call(this),this.listenTo(this.collection,{"change:deleted":this._handleHdaDeletionChange,"change:visible":this._handleHdaVisibleChange,"change:purged":function(t){this.model.fetch()}}),this},_setUpModelListeners:function(){return v.prototype._setUpModelListeners.call(this),this.listenTo(this.model,"change:size",this.updateHistoryDiskSize),this},_buildNewRender:function(){var t=v.prototype._buildNewRender.call(this);return this.model?(Galaxy&&Galaxy.user&&Galaxy.user.id&&Galaxy.user.id===this.model.get("user_id")&&(this._renderTags(t),this._renderAnnotation(t)),t):t},renderItems:function(t){var e=v.prototype.renderItems.call(this,t);return this._renderCounts(t),e},_renderCounts:function(t){function e(t,e){return['<a class="',t,'" href="javascript:void(0);">',e,"</a>"].join("")}t=t||this.$el;var i=this.collection.where({deleted:!0}),n=this.collection.where({visible:!1}),s=[];return this.views.length&&s.push([this.views.length,m("shown")].join(" ")),i.length&&s.push(this.showDeleted?e("toggle-deleted-link",m("hide deleted")):[i.length,e("toggle-deleted-link",m("deleted"))].join(" ")),n.length&&s.push(this.showHidden?e("toggle-hidden-link",m("hide hidden")):[n.length,e("toggle-hidden-link",m("hidden"))].join(" ")),t.find("> .controls .subtitle").html(s.join(", "))},_renderTags:function(t){var e=this;this.tagsEditor=new c.TagsEditor({model:this.model,el:t.find(".controls .tags-display"),onshowFirstTime:function(){this.render()},onshow:function(){e.toggleHDATagEditors(!0,e.fxSpeed)},onhide:function(){e.toggleHDATagEditors(!1,e.fxSpeed)},$activator:g({title:m("Edit history tags"),classes:"history-tag-btn",faIcon:"fa-tags"}).appendTo(t.find(".controls .actions"))})},_renderAnnotation:function(t){var e=this;this.annotationEditor=new d.AnnotationEditor({model:this.model,el:t.find(".controls .annotation-display"),onshowFirstTime:function(){this.render()},onshow:function(){e.toggleHDAAnnotationEditors(!0,e.fxSpeed)},onhide:function(){e.toggleHDAAnnotationEditors(!1,e.fxSpeed)},$activator:g({title:m("Edit history annotation"),classes:"history-annotate-btn",faIcon:"fa-comment"}).appendTo(t.find(".controls .actions"))})},_setUpBehaviors:function(t){if(t=t||this.$el,v.prototype._setUpBehaviors.call(this,t),this.model&&Galaxy.user&&!Galaxy.user.isAnonymous()&&Galaxy.user.id===this.model.get("user_id")){var e=this,i="> .controls .name";t.find(i).attr("title",m("Click to rename history")).tooltip({placement:"bottom"}).make_text_editable({on_finish:function(t){var n=e.model.get("name");t&&t!==n?(e.$el.find(i).text(t),e.model.save({name:t}).fail(function(){e.$el.find(i).text(e.model.previous("name"))})):e.$el.find(i).text(n)}})}},multiselectActions:function(){var t=this,e=[{html:m("Hide datasets"),func:function(){var e=n.HistoryDatasetAssociation.prototype.hide;t.getSelectedModels().ajaxQueue(e)}},{html:m("Unhide datasets"),func:function(){var e=n.HistoryDatasetAssociation.prototype.unhide;t.getSelectedModels().ajaxQueue(e)}},{html:m("Delete datasets"),func:function(){var e=n.HistoryDatasetAssociation.prototype["delete"];t.getSelectedModels().ajaxQueue(e)}},{html:m("Undelete datasets"),func:function(){var e=n.HistoryDatasetAssociation.prototype.undelete;t.getSelectedModels().ajaxQueue(e)}}];return t.purgeAllowed&&e.push({html:m("Permanently delete datasets"),func:function(){if(confirm(m("This will permanently remove the data in your datasets. Are you sure?"))){var e=n.HistoryDatasetAssociation.prototype.purge;t.getSelectedModels().ajaxQueue(e)}}}),e=e.concat(t._collectionActions())},_collectionActions:function(){var t=this;return[{html:m("Build Dataset List"),func:function(){h.createListCollection(t.getSelectedModels()).done(function(){t.model.refresh()})}},{html:m("Build Dataset Pair"),func:function(){u.createPairCollection(t.getSelectedModels()).done(function(){t.model.refresh()})}},{html:m("Build List of Dataset Pairs"),func:function(){p.createListOfPairsCollection(t.getSelectedModels()).done(function(){t.model.refresh()})}}]},_attachItems:function(t){return this.$list(t).append(this.views.reverse().map(function(t){return t.$el})),this},_attachView:function(t){var e=this;e.views.unshift(t),e.$list().prepend(t.render(0).$el.hide()),e.trigger("view:attached",t),t.$el.slideDown(e.fxSpeed,function(){e.trigger("view:attached:rendered")})},_getItemViewOptions:function(t){var e=v.prototype._getItemViewOptions.call(this,t);return a.extend(e,{purgeAllowed:this.purgeAllowed,tagsEditorShown:this.tagsEditor&&!this.tagsEditor.hidden,annotationEditorShown:this.annotationEditor&&!this.annotationEditor.hidden}),e},_handleHdaDeletionChange:function(t){t.get("deleted")&&!this.showDeleted&&this.removeItemView(t),this._renderCounts()},_handleHdaVisibleChange:function(t){t.hidden()&&!this.showHidden&&this.removeItemView(t),this._renderCounts()},toggleHDATagEditors:function(t){var e=Array.prototype.slice.call(arguments,1);a.each(this.views,function(t){t.tagsEditor&&t.tagsEditor.toggle.apply(t.tagsEditor,e)})},toggleHDAAnnotationEditors:function(t){var e=Array.prototype.slice.call(arguments,1);a.each(this.views,function(t){t.annotationEditor&&t.annotationEditor.toggle.apply(t.annotationEditor,e)})},events:a.extend(a.clone(v.prototype.events),{"click .show-selectors-btn":"toggleSelectors","click .toggle-deleted-link":function(t){this.toggleShowDeleted()},"click .toggle-hidden-link":function(t){this.toggleShowHidden()}}),updateHistoryDiskSize:function(){this.$el.find(".history-size").text(this.model.get("nice_size"))},dropTargetOn:function(){if(this.dropTarget)return this;this.dropTarget=!0;var t={dragenter:a.bind(this.dragenter,this),dragover:a.bind(this.dragover,this),dragleave:a.bind(this.dragleave,this),drop:a.bind(this.drop,this)},e=this._renderDropTarget();this.$list().before([this._renderDropTargetHelp(),e]);for(var i in t)t.hasOwnProperty(i)&&e.on(i,t[i]);return this},_renderDropTarget:function(){return this.$(".history-drop-target").remove(),o("<div/>").addClass("history-drop-target").css({height:"64px",margin:"0px 10px 10px 10px",border:"1px dashed black","border-radius":"3px"})},_renderDropTargetHelp:function(){return this.$(".history-drop-target-help").remove(),o("<div/>").addClass("history-drop-target-help").css({margin:"10px 10px 4px 10px",color:"grey","font-size":"80%","font-style":"italic"}).text(m("Drag datasets here to copy them to the current history"))},dropTargetOff:function(){if(!this.dropTarget)return this;this.dropTarget=!1;var t=this.$(".history-drop-target").get(0);for(var e in this._dropHandlers)this._dropHandlers.hasOwnProperty(e)&&t.off(e,this._dropHandlers[e]);return this.$(".history-drop-target").remove(),this.$(".history-drop-target-help").remove(),this},dropTargetToggle:function(){return this.dropTarget?this.dropTargetOff():this.dropTargetOn(),this},dragenter:function(t){t.preventDefault(),t.stopPropagation(),this.$(".history-drop-target").css("border","2px solid black")},dragover:function(t){t.preventDefault(),t.stopPropagation()},dragleave:function(t){t.preventDefault(),t.stopPropagation(),this.$(".history-drop-target").css("border","1px dashed black")},drop:function(t){t.preventDefault();var e=t.originalEvent.dataTransfer;e.dropEffect="move";var i=this,n=e.getData("text");try{n=JSON.parse(n)}catch(s){this.warn("error parsing JSON from drop:",n)}return this.trigger("droptarget:drop",t,n,i),!1},dataDropped:function(t){var e=this;return a.isObject(t)&&"HistoryDatasetAssociation"===t.model_class&&t.id?e.model.contents.copy(t.id):l.when()},toString:function(){return"HistoryViewEdit("+(this.model?this.model.get("name"):"")+")"}});return{HistoryViewEdit:_}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(2),i(1),i(1))},function(t,e,i){var n,s;(function(a,o){n=[i(76),i(75),i(41),i(72),i(74),i(80),i(23),i(46),i(6),i(5),i(83)],s=function(t,e,i,n,s,l,r,c,d,h){"use strict";var u="history",p=d.SessionStorageModel.extend({defaults:{expandedIds:{},show_deleted:!1,show_hidden:!1},addExpanded:function(t){var e="expandedIds";this.save(e,a.extend(this.get(e),a.object([t.id],[t.get("id")])))},removeExpanded:function(t){var e="expandedIds";this.save(e,a.omit(this.get(e),t.id))},toString:function(){return"HistoryPrefs("+this.id+")"}});p.storageKeyPrefix="history:",p.historyStorageKey=function(t){if(!t)throw new Error("HistoryPrefs.historyStorageKey needs valid id: "+t);return p.storageKeyPrefix+t},p.get=function(t){return new p({id:p.historyStorageKey(t)})},p.clearAll=function(t){for(var e in sessionStorage)0===e.indexOf(p.storageKeyPrefix)&&sessionStorage.removeItem(e)};var g=t.ModelListPanel,f=g.extend({_logNamespace:u,HDAViewClass:n.HDAListItemView,HDCAViewClass:s.HDCAListItemView,collectionClass:i.HistoryContents,modelCollectionKey:"contents",tagName:"div",className:g.prototype.className+" history-panel",emptyMsg:h("This history is empty"),noneFoundMsg:h("No matching datasets found"),searchPlaceholder:h("search datasets"),initialize:function(t){g.prototype.initialize.call(this,t),this.linkTarget=t.linkTarget||"_blank"},freeModel:function(){return g.prototype.freeModel.call(this),this.model&&this.model.clearUpdateTimeout(),this},_setUpListeners:function(){g.prototype._setUpListeners.call(this),this.on({error:function(t,e,i,n,s){this.errorHandler(t,e,i,n,s)},"loading-done":function(){this.views.length||this.trigger("empty-history",this)},"views:ready view:attached view:removed":function(t){this._renderSelectButton()}})},loadHistoryWithDetails:function(t,e,i,n){this.info("loadHistoryWithDetails:",t,e,i,n);var s=function(t){return a.values(p.get(t.id).get("expandedIds"))};return this.loadHistory(t,e,i,n,s)},FETCH_COLLECTION_COUNTS_DELAY:2e3,loadHistory:function(t,i,n,s,o){this.info("loadHistory:",t,i,n,s,o);var l=this;i=i||{},l.trigger("loading",l);var r=e.History.getHistoryData(t,{historyFn:n,contentsFn:s,detailIdsFn:i.initiallyExpanded||o});return l._loadHistoryFromXHR(r,i).fail(function(e,n,s){l.trigger("error",l,e,i,h("An error was encountered while "+n),{historyId:t,history:s||{}})}).done(function(){a.delay(function(){l.model.contents.fetchCollectionCounts()},l.FETCH_COLLECTION_COUNTS_DELAY)}).always(function(){l.trigger("loading-done",l)})},_loadHistoryFromXHR:function(t,e){var i=this;return t.then(function(t,n){i.JSONToModel(t,n,e),i.render()}).fail(function(t,e){i.render()}),t},refreshContents:function(t){return this.model?this.model.refresh(t):o.when()},JSONToModel:function(t,i,n){this.log("JSONToModel:",t,i,n),n=n||{};var s=new e.History(t,i,n);return this.setModel(s),s},setModel:function(t,e){e=e||{},g.prototype.setModel.call(this,t,e),this.model&&this._setUpWebStorage(e.initiallyExpanded,e.show_deleted,e.show_hidden)},_setUpWebStorage:function(t,e,i){return this.storage&&this.stopListening(this.storage),this.storage=new p({id:p.historyStorageKey(this.model.get("id"))}),a.isObject(t)&&this.storage.set("expandedIds",t),a.isBoolean(e)&&this.storage.set("show_deleted",e),a.isBoolean(i)&&this.storage.set("show_hidden",i),this.trigger("new-storage",this.storage,this),this.log(this+" (init'd) storage:",this.storage.get()),this.listenTo(this.storage,{"change:show_deleted":function(t,e){this.showDeleted=e},"change:show_hidden":function(t,e){this.showHidden=e}},this),this.showDeleted=void 0!==e?e:this.storage.get("show_deleted"),this.showHidden=void 0!==i?i:this.storage.get("show_hidden"),this},_buildNewRender:function(){var t=g.prototype._buildNewRender.call(this);return this._renderSelectButton(t),t},_renderSelectButton:function(t){if(t=t||this.$el,!this.multiselectActions().length)return null;if(!this.views.length)return this.hideSelectors(),t.find(".controls .actions .show-selectors-btn").remove(),null;var e=t.find(".controls .actions .show-selectors-btn");return e.length?e:r({title:h("Operations on multiple datasets"),classes:"show-selectors-btn",faIcon:"fa-check-square-o"}).prependTo(t.find(".controls .actions"))},_getItemViewClass:function(t){var e=t.get("history_content_type");switch(e){case"dataset":return this.HDAViewClass;case"dataset_collection":return this.HDCAViewClass}throw new TypeError("Unknown history_content_type: "+e)},_filterItem:function(t){var e=this;return g.prototype._filterItem.call(e,t)&&(!t.hidden()||e.showHidden)&&(!t.isDeletedOrPurged()||e.showDeleted)},_getItemViewOptions:function(t){var e=g.prototype._getItemViewOptions.call(this,t);return a.extend(e,{linkTarget:this.linkTarget,expanded:!!this.storage.get("expandedIds")[t.id],hasUser:this.model.ownedByCurrUser()})},_setUpItemViewListeners:function(t){var e=this;return g.prototype._setUpItemViewListeners.call(e,t),e.listenTo(t,{expanded:function(t){e.storage.addExpanded(t.model)},collapsed:function(t){e.storage.removeExpanded(t.model)}}),this},getSelectedModels:function(){var t=g.prototype.getSelectedModels.call(this);return t.historyId=this.collection.historyId,t},events:a.extend(a.clone(g.prototype.events),{"click .show-selectors-btn":"toggleSelectors","click .messages [class$=message]":"clearMessages"}),toggleShowDeleted:function(t,e){return t=void 0!==t?t:!this.showDeleted,e=void 0===e||e,this.showDeleted=t,e&&this.storage.set("show_deleted",t),this.renderItems(),this.trigger("show-deleted",t),this.showDeleted},toggleShowHidden:function(t,e){return t=void 0!==t?t:!this.showHidden,e=void 0===e||e,this.showHidden=t,e&&this.storage.set("show_hidden",t),this.renderItems(),this.trigger("show-hidden",t),this.showHidden},_firstSearch:function(t){var e=this,i=".history-search-input";return this.log("onFirstSearch",t),e.model.contents.haveDetails()?void e.searchItems(t):(e.$el.find(i).searchInput("toggle-loading"),void e.model.contents.fetchAllDetails({silent:!0}).always(function(){e.$el.find(i).searchInput("toggle-loading")}).done(function(){e.searchItems(e.searchFor)}))},errorHandler:function(t,e,i,n,s){if(this.error(t,e,i,n,s),e&&0===e.status&&0===e.readyState);else if(e&&502===e.status);else{var a=this._parseErrorMessage(t,e,i,n,s);this.$messages().is(":visible")?this.displayMessage("error",a.message,a.details):this.once("rendered",function(){this.displayMessage("error",a.message,a.details)})}},_parseErrorMessage:function(t,e,i,n,s,o){var r=Galaxy.user,c={message:this._bePolite(n),details:{message:n,raven:window.Raven&&a.isFunction(Raven.lastEventId)?Raven.lastEventId():void 0,agent:navigator.userAgent,url:window.Galaxy?Galaxy.lastAjax.url:void 0,data:window.Galaxy?Galaxy.lastAjax.data:void 0,options:e?a.omit(i,"xhr"):i,xhr:e,source:a.isFunction(t.toJSON)?t.toJSON():t+"",user:r instanceof l.User?r.toJSON():r+""}};if(a.extend(c.details,s||{}),e&&a.isFunction(e.getAllResponseHeaders)){var d=e.getAllResponseHeaders();d=a.compact(d.split("\n")),d=a.map(d,function(t){return t.split(": ")}),c.details.xhr.responseHeaders=a.object(d)}return c},_bePolite:function(t){return t=t||h("An error occurred while getting updates from the server"),t+". "+h("Please contact a Galaxy administrator if the problem persists")+"."},displayMessage:function(t,e,i){var n=this;this.scrollToTop();var s=this.$messages(),l=o("<div/>").addClass(t+"message").html(e);if(!a.isEmpty(i)){var r=o('<a href="javascript:void(0)">Details</a>').click(function(){return Galaxy.modal.show(n._messageToModalOptions(t,e,i)),!1});l.append(" ",r)}return s.append(l)},_messageToModalOptions:function(t,e,i){var n=this,s={title:"Details"};if(a.isObject(i)){i=a.omit(i,a.functions(i));var l=JSON.stringify(i,null,"  "),r=o("<pre/>").text(l);s.body=o("<div/>").append(r)}else s.body=o("<div/>").html(i);return s.buttons={Ok:function(){Galaxy.modal.hide(),n.clearMessages()}},s},clearMessages:function(t){var e=a.isUndefined(t)?this.$messages().children('[class$="message"]'):o(t.currentTarget);return e.fadeOut(this.fxSpeed,function(){o(this).remove()}),this},scrollToHid:function(t){return this.scrollToItem(a.first(this.viewsWhereModel({hid:t})))},toString:function(){return"HistoryView("+(this.model?this.model.get("name"):"")+")"}});return f.prototype.templates=function(){var t=d.wrapTemplate(['<div class="controls">','<div class="title">','<div class="name"><%- history.name %></div>',"</div>",'<div class="subtitle"></div>','<div class="history-size"><%- history.nice_size %></div>','<div class="actions"></div>','<div class="messages">',"<% if( history.deleted && history.purged ){ %>",'<div class="deleted-msg warningmessagesmall">',h("This history has been purged and deleted"),"</div>","<% } else if( history.deleted ){ %>",'<div class="deleted-msg warningmessagesmall">',h("This history has been deleted"),"</div>","<% } else if( history.purged ){ %>",'<div class="deleted-msg warningmessagesmall">',h("This history has been purged"),"</div>","<% } %>","<% if( history.message ){ %>",'<div class="<%= history.message.level || "info" %>messagesmall">',"<%= history.message.text %>","</div>","<% } %>","</div>",'<div class="tags-display"></div>','<div class="annotation-display"></div>','<div class="search">','<div class="search-input"></div>',"</div>",'<div class="list-actions">','<div class="btn-group">','<button class="select-all btn btn-default"','data-mode="select">',h("All"),"</button>",'<button class="deselect-all btn btn-default"','data-mode="select">',h("None"),"</button>","</div>",'<div class="list-action-menu btn-group">',"</div>","</div>","</div>"],"history");return a.extend(a.clone(g.prototype.templates),{controls:t})}(),{HistoryView:f}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(2),i(1))},function(t,e,i){var n,s;(function(a,o){n=[i(46),i(102),i(6),i(5)],s=function(t,e,i,n){"use strict";function s(t,e,i){return o.clone(l).filter(function(n){return!(t&&!n.anon)&&(!(!e&&n.purge)&&(n.href&&(n.href=i+n.href,n.target="galaxy_main"),n.confirm&&(n.func=function(){confirm(n.confirm)&&(galaxy_main.location=n.href)}),!0))})}var l=[{html:n("History Lists"),header:!0},{html:n("Saved Histories"),href:"history/list"},{html:n("Histories Shared with Me"),href:"history/list_shared"},{html:n("History Actions"),header:!0,anon:!0},{html:n("Create New"),func:function(){Galaxy&&Galaxy.currHistoryPanel&&Galaxy.currHistoryPanel.createNewHistory()}},{html:n("Copy History"),func:function(){e(Galaxy.currHistoryPanel.model).done(function(){Galaxy.currHistoryPanel.loadCurrentHistory()})}},{html:n("Share or Publish"),href:"history/sharing"},{html:n("Show Structure"),href:"history/display_structured",anon:!0},{html:n("Extract Workflow"),href:"workflow/build_from_current_history"},{html:n("Delete"),confirm:n("Really delete the current history?"),href:"history/delete_current"},{html:n("Delete Permanently"),confirm:n("Really delete the current history permanently? This cannot be undone."),href:"history/delete_current?purge=True",purge:!0,anon:!0},{html:n("Dataset Actions"),header:!0,anon:!0},{html:n("Copy Datasets"),href:"dataset/copy_datasets"},{html:n("Dataset Security"),href:"root/history_set_default_permissions"},{html:n("Resume Paused Jobs"),href:"history/resume_paused_jobs?current=True",anon:!0},{html:n("Collapse Expanded Datasets"),func:function(){Galaxy&&Galaxy.currHistoryPanel&&Galaxy.currHistoryPanel.collapseAll()}},{html:n("Unhide Hidden Datasets"),anon:!0,func:function(){if(Galaxy&&Galaxy.currHistoryPanel&&confirm(n("Really unhide all hidden datasets?"))){var t=Galaxy.currHistoryPanel.model.contents.hidden();t.ajaxQueue(a.Model.prototype.save,{visible:!0}).done(function(){Galaxy.currHistoryPanel.renderItems()}).fail(function(){alert("There was an error unhiding the datasets"),console.error(arguments)})}}},{html:n("Delete Hidden Datasets"),anon:!0,func:function(){if(Galaxy&&Galaxy.currHistoryPanel&&confirm(n("Really delete all hidden datasets?"))){var t=Galaxy.currHistoryPanel.model.contents.hidden();t.ajaxQueue(a.Model.prototype.save,{deleted:!0,visible:!0}).done(function(){Galaxy.currHistoryPanel.renderItems()}).fail(function(){alert("There was an error deleting the datasets"),console.error(arguments)})}}},{html:n("Purge Deleted Datasets"),confirm:n("Really delete all deleted datasets permanently? This cannot be undone."),href:"history/purge_deleted_datasets",purge:!0,anon:!0},{html:n("Downloads"),header:!0},{html:n("Export Tool Citations"),href:"history/citations",anon:!0},{html:n("Export History to File"),href:"history/export_archive?preview=True",anon:!0},{html:n("Other Actions"),header:!0},{html:n("Import from File"),href:"history/import_archive"}],r=function(e,i){i=i||{};var n=void 0===i.anonymous||i.anonymous,a=i.purgeAllowed||!1,o=s(n,a,Galaxy.root);return new t(e,o)};return r}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2))},function(t,e,i){var n,s;(function(a,o,l){n=[i(4)],s=function(t){var e=a.View.extend({initialize:function(e){var i=this;this.visible=!1,this.$nav=null,this.$content=null,this.first_tab=null,this.current_id=null,this.list={},this.options=t.merge(e,{title_new:"",operations:null,onnew:null,max:null,onchange:null}),this.setElement(o(this._template(this.options))),this.$nav=this.$(".tab-navigation"),this.$content=this.$(".tab-content"),this.$operations=this.$nav.find(".tab-operations"),this.options.operations&&o.each(this.options.operations,function(t,e){e.$el.prop("id",t),i.$operations.append(e.$el)}),this.options.onnew&&this.$nav.append(o(this._template_tab_new(this.options)).tooltip({title:"Add a new tab",placement:"bottom",container:i.$el}).on("click",function(t){i.options.onnew()})),this.$tabnew=this.$nav.find(".tab-new"),this.$el.on("click",function(){o(".tooltip").hide()})},size:function(){return l.size(this.list)},current:function(){return this.$el.find(".tab-pane.active").attr("id")},add:function(t){var e=this,i=t.id,n=o(this._template_tab(t)),s=o("<div/>").attr("id",t.id).addClass("tab-pane");this.list[i]=!0,this.options.max&&this.size()>=this.options.max&&this.$tabnew.hide(),this.options.onnew?this.$tabnew.before(n):this.$nav.append(n),t.ondel?n.find(".tab-delete").tooltip({title:"Delete this tab",placement:"bottom",container:e.$el}).on("click",function(){t.ondel()}):n.tooltip({title:t.tooltip,placement:"bottom",container:e.$el}),n.on("click",function(n){n.preventDefault(),t.onclick?t.onclick():e.show(i)}),this.$content.append(s.append(t.$el)),1==this.size()&&(n.addClass("active"),s.addClass("active"),this.first_tab=i),this.current_id||(this.current_id=i)},del:function(t){this.$("#tab-"+t).remove(),this.$("#"+t).remove(),this.first_tab=this.first_tab==t?null:this.first_tab,null!=this.first_tab&&this.show(this.first_tab),this.list[t]&&delete this.list[t],this.size()<this.options.max&&this.$el.find(".ui-tabs-new").show()},delRemovable:function(){for(var t in this.list)this.del(t)},show:function(t){this.$el.fadeIn("fast"),this.visible=!0,t&&(this.$("#tab-"+this.current_id).removeClass("active"),this.$("#"+this.current_id).removeClass("active"),this.$("#tab-"+t).addClass("active"),this.$("#"+t).addClass("active"),this.current_id=t),this.options.onchange&&this.options.onchange(t)},hide:function(){this.$el.fadeOut("fast"),this.visible=!1},hideOperation:function(t){this.$nav.find("#"+t).hide()},showOperation:function(t){this.$nav.find("#"+t).show()},setOperation:function(t,e){this.$nav.find("#"+t).off("click").on("click",e)},title:function(t,e){var i=this.$("#tab-title-text-"+t);return e&&i.html(e),i.html()},retitle:function(t){var e=0;for(var i in this.list)this.title(i,++e+": "+t)},_template:function(t){return o("<div/>").addClass("ui-tabs tabbable tabs-left").append(o("<ul/>").addClass("tab-navigation nav nav-tabs").append(o("<div/>").addClass("tab-operations"))).append(o("<div/>").addClass("tab-content"))},_template_tab:function(t){var e=o("<li/>").addClass("tab-element").attr("id","tab-"+t.id).append(o("<a/>").attr("id","tab-title-link-"+t.id)),i=e.find("a");return t.icon&&i.append(o("<i/>").addClass("tab-icon fa").addClass(t.icon)),i.append(o("<span/>").attr("id","tab-title-text-"+t.id).addClass("tab-title-text").append(t.title)),t.ondel&&i.append(o("<i/>").addClass("tab-delete fa fa-minus-circle")),e},_template_tab_new:function(t){return o("<li/>").addClass("tab-new").append(o("<a/>").attr("href","javascript:void(0);").append(o("<i/>").addClass("tab-icon fa fa-plus-circle")).append(t.title_new))}});return{View:e}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1),i(2))},function(t,e,i){var n,s;(function(a,o){n=[i(4),i(79),i(78),i(25),i(7),i(26),i(86)],s=function(t,e,i,n,s,l){return a.View.extend({status_classes:{init:"upload-mode fa fa-exclamation text-primary",ready:"upload-mode fa fa-check text-success",running:"upload-mode fa fa-spinner fa-spin",success:"upload-mode fa fa-check",error:"upload-mode fa fa-exclamation-triangle"},initialize:function(t,e){this.app=t;var i=this;this.model=e.model,this.setElement(this._template(e.model)),this.uploadinput=this.$el.uploadinput({ondragover:function(){i.model.get("enabled")&&i.$el.addClass("warning")},ondragleave:function(){i.$el.removeClass("warning")},onchange:function(t){"running"!=i.model.get("status")&&t&&t.length>0&&(i.model.reset({file_data:t[0],file_name:t[0].name,file_size:t[0].size,file_mode:t[0].mode||"local"}),i._refreshReady())}}),this.button_menu=new s.ButtonMenu({icon:"fa-caret-down",title:"Select",pull:"left"}),this.$("#source").append(this.button_menu.$el),this.button_menu.addMenu({icon:"fa-laptop",title:"Choose local file",onclick:function(){i.uploadinput.dialog()}}),this.app.ftp_upload_site&&this.button_menu.addMenu({icon:"fa-folder-open-o",title:"Choose FTP file",onclick:function(){i._showFtp()}}),this.button_menu.addMenu({icon:"fa-edit",title:"Paste/Fetch data",onclick:function(){i.model.reset({file_mode:"new",file_name:"New File"})}}),this.ftp=new n.View({title:"Choose FTP file:",container:this.$("#source").find(".ui-button-menu"),placement:"right"}),this.settings=new n.View({title:"Upload configuration",container:this.$("#settings"),placement:"bottom"}),this.$("#text-content").on("change input",function(t){i.model.set("url_paste",o(t.target).val()),i.model.set("file_size",o(t.target).val().length),i._refreshReady()}),this.$("#settings").on("click",function(t){i._showSettings()}).on("mousedown",function(t){t.preventDefault()}),this.model.on("change:percentage",function(){i._refreshPercentage()}),this.model.on("change:status",function(){i._refreshStatus()}),this.model.on("change:info",function(){i._refreshInfo()}),this.model.on("change:file_name",function(){i._refreshFileName()}),this.model.on("change:file_mode",function(){i._refreshMode()}),this.model.on("change:file_size",function(){i._refreshFileSize()}),this.model.on("remove",function(){i.remove()}),this.app.collection.on("reset",function(){i.remove()})},render:function(){this.$("#file_name").html(this.model.get("file_name")||"-"),this.$("#file_desc").html(this.model.get("file_desc")||"Unavailable"),this.$("#file_size").html(t.bytesToString(this.model.get("file_size"))),this.$("#status").removeClass().addClass(this.status_classes.init)},remove:function(){a.View.prototype.remove.apply(this)},_refreshReady:function(){this.app.collection.each(function(t){t.set("status",t.get("file_size")>0&&"ready"||"init")})},_refreshMode:function(){var t=this.model.get("file_mode");"new"==t?(this.height=this.$el.height(),this.$("#text").css({width:this.$el.width()-16+"px",top:this.$el.height()-8+"px"}).show(),this.$el.height(this.$el.height()-8+this.$("#text").height()+16),this.$("#text-content").val("").trigger("keyup")):(this.$el.height(this.height),this.$("#text").hide())},_refreshInfo:function(){var t=this.model.get("info");t?this.$("#info-text").html("<strong>Failed: </strong>"+t).show():this.$("#info-text").hide()},_refreshPercentage:function(){var t=parseInt(this.model.get("percentage"));0!=t?this.$(".progress-bar").css({width:t+"%"}):(this.$(".progress-bar").addClass("no-transition"),this.$(".progress-bar").css({width:"0%"}),this.$(".progress-bar")[0].offsetHeight,this.$(".progress-bar").removeClass("no-transition")),100!=t?this.$("#percentage").html(t+"%"):this.$("#percentage").html("Adding to history...")},_refreshStatus:function(){var t=this.model.get("status");this.$("#status").removeClass().addClass(this.status_classes[t]),this.model.set("enabled","running"!=t),this.$("#text-content").attr("disabled",!this.model.get("enabled")),this.$el.removeClass("success danger warning"),"running"!=t&&"ready"!=t||this.model.set("percentage",0),"running"==t?this.$("#source").find(".button").addClass("disabled"):this.$("#source").find(".button").removeClass("disabled"),"success"==t&&(this.$el.addClass("success"),this.model.set("percentage",100),this.$("#percentage").html("100%")),"error"==t?(this.$el.addClass("danger"),this.model.set("percentage",0),this.$("#info-progress").hide(),this.$("#info-text").show()):(this.$("#info-progress").show(),this.$("#info-text").hide())},_refreshFileName:function(){this.$("#file_name").html(this.model.get("file_name")||"-")},_refreshFileSize:function(){this.$("#file_size").html(t.bytesToString(this.model.get("file_size")))},_showFtp:function(){if(this.ftp.visible)this.ftp.hide();else{this.ftp.empty();var t=this;this.ftp.append(new i({ftp_upload_site:this.app.ftp_upload_site,onchange:function(e){t.ftp.hide(),"running"!=t.model.get("status")&&e&&(t.model.reset({file_mode:"ftp",file_name:e.path,file_size:e.size,file_path:e.path}),t._refreshReady())}}).$el),this.ftp.show()}},_showSettings:function(){this.settings.visible?this.settings.hide():(this.settings.empty(),this.settings.append(new e(this).$el),this.settings.show())},_template:function(t){return'<tr id="upload-row-'+t.id+'" class="upload-row"><td><div id="source"/><div class="upload-text-column"><div id="text" class="text"><div class="text-info">You can tell Galaxy to download data from web by entering URL in this box (one per line). You can also directly paste the contents of a file.</div><textarea id="text-content" class="text-content form-control"/></div></div></td><td><div id="status"/></td><td><div id="file_desc" class="upload-title"/></td><td><div id="file_name" class="upload-title"/></td><td><div id="file_size" class="upload-size"/></td><td><div id="settings" class="upload-icon-button fa fa-gear"/></td><td><div id="info" class="upload-info"><div id="info-text"/><div id="info-progress" class="progress"><div class="progress-bar progress-bar-success"/><div id="percentage" class="percentage">0%</div></div></div></td></tr>'}})}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1))},function(t,e,i){var n,s;(function(a,o,l){n=[i(4),i(53),i(110),i(25),i(26),i(7)],s=function(t,e,i,n,s,r){return a.View.extend({select_extension:null,select_genome:null,collection:new e.Collection,initialize:function(t){this.app=t,this.options=t.options,this.list_extensions=t.list_extensions,this.list_genomes=t.list_genomes,this.ftp_upload_site=t.currentFtp();var e=this;this.setElement(this._template()),this.btnStart=new r.Button({title:"Start",onclick:function(){e._eventStart();
}}),this.btnClose=new r.Button({title:"Close",onclick:function(){e.app.modal.hide()}});var i=[this.btnStart,this.btnClose];for(var n in i)this.$("#upload-buttons").prepend(i[n].$el);this.select_extension=new s.View({css:"footer-selection",container:this.$("#footer-extension"),data:o.filter(this.list_extensions,function(t){return t.composite_files}),onchange:function(t){e.collection.reset();var i=o.findWhere(e.list_extensions,{id:t});if(i&&i.composite_files)for(var n in i.composite_files){var s=i.composite_files[n];e.collection.add({id:e.collection.size(),file_desc:s.description||s.name})}}}),this.$("#footer-extension-info").on("click",function(t){e._showExtensionInfo({$el:l(t.target),title:e.select_extension.text(),extension:e.select_extension.value(),placement:"top"})}).on("mousedown",function(t){t.preventDefault()}),this.select_genome=new s.View({css:"footer-selection",container:this.$("#footer-genome"),data:this.list_genomes,value:this.options.default_genome}),this.collection.on("add",function(t){e._eventAnnounce(t)}),this.collection.on("change add",function(){e._updateScreen()}).trigger("change"),this.select_extension.options.onchange(this.select_extension.value())},_eventAnnounce:function(t){var e=new i(this,{model:t});this.$("#upload-table > tbody:first").append(e.$el),e.render(),this.collection.length>0?this.$("#upload-table").show():this.$("#upload-table").hide()},_eventStart:function(){var t=this;this.collection.each(function(e){e.set("genome",t.select_genome.value()),e.set("extension",t.select_extension.value())}),l.uploadpost({url:this.app.options.nginx_upload_path,data:this.app.toData(this.collection.filter()),success:function(e){t._eventSuccess(e)},error:function(e){t._eventError(e)},progress:function(e){t._eventProgress(e)}})},_eventProgress:function(t){this.collection.each(function(e){e.set("percentage",t)})},_eventSuccess:function(t){this.collection.each(function(t){t.set("status","success")}),Galaxy.currHistoryPanel.refreshContents()},_eventError:function(t){this.collection.each(function(e){e.set("status","error"),e.set("info",t)})},_showExtensionInfo:function(t){var e=t.$el,i=t.extension,s=t.title,a=o.findWhere(this.list_extensions,{id:i});this.extension_popup&&this.extension_popup.remove(),this.extension_popup=new n.View({placement:t.placement||"bottom",container:e,destroy:!0}),this.extension_popup.title(s),this.extension_popup.empty(),this.extension_popup.append(this._templateDescription(a)),this.extension_popup.show()},_updateScreen:function(){var t=this.collection.first();t&&"running"==t.get("status")?(this.select_genome.disable(),this.select_extension.disable()):(this.select_genome.enable(),this.select_extension.enable()),this.collection.where({status:"ready"}).length==this.collection.length&&this.collection.length>0?(this.btnStart.enable(),this.btnStart.$el.addClass("btn-primary")):(this.btnStart.disable(),this.btnStart.$el.removeClass("btn-primary")),this.collection.length>0?this.$("#upload-table").show():this.$("#upload-table").hide()},_templateDescription:function(t){if(t.description){var e=t.description;return t.description_url&&(e+='&nbsp;(<a href="'+t.description_url+'" target="_blank">read more</a>)'),e}return"There is no description available for this file extension."},_template:function(){return'<div class="upload-view-composite"><div id="upload-footer" class="upload-footer"><span class="footer-title">Composite Type:</span><span id="footer-extension"/><span id="footer-extension-info" class="upload-icon-button fa fa-search"/> <span class="footer-title">Genome/Build:</span><span id="footer-genome"/></div><div id="upload-box" class="upload-box"><table id="upload-table" class="ui-table-striped" style="display: none;"><thead><tr><th/><th/><th>Description</th><th>Name</th><th>Size</th><th>Settings</th><th>Status</th></tr></thead><tbody></tbody></table></div><div id="upload-buttons" class="upload-buttons"/></div>'}})}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2),i(1))},function(t,e,i){var n,s;(function(a,o){n=[i(4),i(53),i(79),i(25),i(26)],s=function(t,e,i,n,s){return a.View.extend({status_classes:{init:"upload-icon-button fa fa-trash-o",queued:"upload-icon fa fa-spinner fa-spin",running:"upload-icon fa fa-spinner fa-spin",success:"upload-icon-button fa fa-check",error:"upload-icon-button fa fa-exclamation-triangle"},settings:null,select_genome:null,select_extension:null,initialize:function(t,e){this.app=t;var i=this;this.model=e.model,this.setElement(this._template(e.model)),this.settings=new n.View({title:"Upload configuration",container:this.$("#settings"),placement:"bottom"});var a=this.app.select_genome.value();this.select_genome=new s.View({css:"upload-genome",onchange:function(t){i.model.set("genome",t)},data:i.app.list_genomes,container:this.$("#genome"),value:a}),this.model.set("genome",a);var l=this.app.select_extension.value();this.select_extension=new s.View({css:"upload-extension",onchange:function(t){i.model.set("extension",t)},data:i.app.list_extensions,container:this.$("#extension"),value:l}),this.model.set("extension",l),this.$("#symbol").on("click",function(){i._removeRow()}),this.$("#extension-info").on("click",function(t){i.app.showExtensionInfo({$el:o(t.target),title:i.select_extension.text(),extension:i.select_extension.value()})}).on("mousedown",function(t){t.preventDefault()}),this.$("#settings").on("click",function(t){i._showSettings()}).on("mousedown",function(t){t.preventDefault()}),this.$("#text-content").on("change input",function(t){i.model.set("url_paste",o(t.target).val()),i.model.set("file_size",o(t.target).val().length)}),this.model.on("change:percentage",function(){i._refreshPercentage()}),this.model.on("change:status",function(){i._refreshStatus()}),this.model.on("change:info",function(){i._refreshInfo()}),this.model.on("change:genome",function(){i._refreshGenome()}),this.model.on("change:extension",function(){i._refreshExtension()}),this.model.on("change:file_size",function(){i._refreshFileSize()}),this.model.on("remove",function(){i.remove()}),this.app.collection.on("reset",function(){i.remove()})},render:function(){var e=this.model.get("file_name"),i=this.model.get("file_size"),n=this.model.get("file_mode");this.$("#title").html(e),this.$("#size").html(t.bytesToString(i)),this.$("#mode").removeClass().addClass("upload-mode").addClass("text-primary"),"new"==n&&(this.$("#text").css({width:this.$el.width()-16+"px",top:this.$el.height()-8+"px"}).show(),this.$el.height(this.$el.height()-8+this.$("#text").height()+16),this.$("#mode").addClass("fa fa-edit")),"local"==n&&this.$("#mode").addClass("fa fa-laptop"),"ftp"==n&&this.$("#mode").addClass("fa fa-folder-open-o")},remove:function(){this.select_genome.remove(),this.select_extension.remove(),a.View.prototype.remove.apply(this)},_refreshExtension:function(){this.select_extension.value(this.model.get("extension"))},_refreshGenome:function(){this.select_genome.value(this.model.get("genome"))},_refreshInfo:function(){var t=this.model.get("info");t?this.$("#info").html("<strong>Failed: </strong>"+t).show():this.$("#info").hide()},_refreshPercentage:function(){var t=parseInt(this.model.get("percentage"));this.$(".progress-bar").css({width:t+"%"}),100!=t?this.$("#percentage").html(t+"%"):this.$("#percentage").html("Adding to history...")},_refreshStatus:function(){var t=this.model.get("status");this.$("#symbol").removeClass().addClass(this.status_classes[t]),this.model.set("enabled","init"==t);var e=this.model.get("enabled");this.$("#text-content").attr("disabled",!e),e?(this.select_genome.enable(),this.select_extension.enable()):(this.select_genome.disable(),this.select_extension.disable()),"success"==t&&(this.$el.addClass("success"),this.$("#percentage").html("100%")),"error"==t&&(this.$el.addClass("danger"),this.$(".progress").remove())},_refreshFileSize:function(){var e=this.model.get("file_size");this.$("#size").html(t.bytesToString(e))},_removeRow:function(){var t=this.model.get("status");"init"!=t&&"success"!=t&&"error"!=t||this.app.collection.remove(this.model)},_showSettings:function(){this.settings.visible?this.settings.hide():(this.settings.empty(),this.settings.append(new i(this).$el),this.settings.show())},_template:function(t){return'<tr id="upload-row-'+t.id+'" class="upload-row"><td><div class="upload-text-column"><div id="mode"/><div id="title" class="upload-title"/><div id="text" class="text"><div class="text-info">You can tell Galaxy to download data from web by entering URL in this box (one per line). You can also directly paste the contents of a file.</div><textarea id="text-content" class="text-content form-control"/></div></div></td><td><div id="size" class="upload-size"/></td><td><div id="extension" class="upload-extension" style="float: left;"/>&nbsp;&nbsp<div id="extension-info" class="upload-icon-button fa fa-search"/></td><td><div id="genome" class="upload-genome"/></td><td><div id="settings" class="upload-settings upload-icon-button fa fa-gear"/></td><td><div id="info" class="upload-info"><div class="progress"><div class="progress-bar progress-bar-success"/><div id="percentage" class="percentage">0%</div></div></div></td><td><div id="symbol" class="'+this.status_classes.init+'"/></td></tr>'}})}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1))},function(t,e,i){var n,s;(function(a,o,l){n=[i(4),i(53),i(112),i(78),i(25),i(26),i(7),i(86)],s=function(t,e,i,n,s,r,c){return a.View.extend({select_extension:null,select_genome:null,uploadbox:null,upload_size:0,collection:new e.Collection,ftp:null,counter:{announce:0,success:0,error:0,running:0,reset:function(){this.announce=this.success=this.error=this.running=0}},initialize:function(t){this.app=t,this.options=t.options,this.list_extensions=t.list_extensions,this.list_genomes=t.list_genomes,this.ui_button=t.ui_button,this.ftp_upload_site=t.currentFtp();var e=this;this.setElement(this._template()),this.btnLocal=new c.Button({id:"btn-local",title:"Choose local file",onclick:function(){e.uploadbox.select()},icon:"fa fa-laptop"}),this.btnFtp=new c.Button({id:"btn-ftp",title:"Choose FTP file",onclick:function(){e._eventFtp()},icon:"fa fa-folder-open-o"}),this.btnCreate=new c.Button({id:"btn-new",title:"Paste/Fetch data",onclick:function(){e._eventCreate()},icon:"fa fa-edit"}),this.btnStart=new c.Button({id:"btn-start",title:"Start",onclick:function(){e._eventStart()}}),this.btnStop=new c.Button({id:"btn-stop",title:"Pause",onclick:function(){e._eventStop()}}),this.btnReset=new c.Button({id:"btn-reset",title:"Reset",onclick:function(){e._eventReset()}}),this.btnClose=new c.Button({id:"btn-close",title:"Close",onclick:function(){e.app.modal.hide()}});var i=[this.btnLocal,this.btnFtp,this.btnCreate,this.btnStop,this.btnReset,this.btnStart,this.btnClose];for(var n in i)this.$("#upload-buttons").prepend(i[n].$el);var e=this;this.uploadbox=this.$("#upload-box").uploadbox({url:this.app.options.nginx_upload_path,announce:function(t,i){e._eventAnnounce(t,i)},initialize:function(t){return e.app.toData([e.collection.get(t)],e.history_id)},progress:function(t,i){e._eventProgress(t,i)},success:function(t,i){e._eventSuccess(t,i)},error:function(t,i){e._eventError(t,i)},complete:function(){e._eventComplete()},ondragover:function(){e.$(".upload-box").addClass("highlight")},ondragleave:function(){e.$(".upload-box").removeClass("highlight")}}),this.ftp=new s.View({title:"FTP files",container:this.btnFtp.$el}),this.select_extension=new r.View({css:"footer-selection",container:this.$("#footer-extension"),data:o.filter(this.list_extensions,function(t){return!t.composite_files}),value:this.options.default_extension,onchange:function(t){e.updateExtension(t)}}),e.$("#footer-extension-info").on("click",function(t){e.showExtensionInfo({$el:l(t.target),title:e.select_extension.text(),extension:e.select_extension.value(),placement:"top"})}).on("mousedown",function(t){t.preventDefault()}),this.select_genome=new r.View({css:"footer-selection",container:this.$("#footer-genome"),data:this.list_genomes,value:this.options.default_genome,onchange:function(t){e.updateGenome(t)}}),this.collection.on("remove",function(t){e._eventRemove(t)}),this._updateScreen()},_eventAnnounce:function(t,n){this.counter.announce++;var s=new e.Model({id:t,file_name:n.name,file_size:n.size,file_mode:n.mode||"local",file_path:n.path,file_data:n});this.collection.add(s);var a=new i(this,{model:s});this.$("#upload-table > tbody:first").append(a.$el),this._updateScreen(),a.render()},_eventProgress:function(t,e){var i=this.collection.get(t);i.set("percentage",e),this.ui_button.model.set("percentage",this._uploadPercentage(e,i.get("file_size")))},_eventSuccess:function(t,e){var i=this.collection.get(t);i.set("percentage",100),i.set("status","success"),this.ui_button.model.set("percentage",this._uploadPercentage(100,i.get("file_size"))),this.upload_completed+=100*i.get("file_size"),this.counter.announce--,this.counter.success++,this._updateScreen(),Galaxy.currHistoryPanel.refreshContents()},_eventError:function(t,e){var i=this.collection.get(t);i.set("percentage",100),i.set("status","error"),i.set("info",e),this.ui_button.model.set({percentage:this._uploadPercentage(100,i.get("file_size")),status:"danger"}),this.upload_completed+=100*i.get("file_size"),this.counter.announce--,this.counter.error++,this._updateScreen()},_eventComplete:function(){this.collection.each(function(t){"queued"==t.get("status")&&t.set("status","init")}),this.counter.running=0,this._updateScreen()},_eventRemove:function(t){var e=t.get("status");"success"==e?this.counter.success--:"error"==e?this.counter.error--:this.counter.announce--,this.uploadbox.remove(t.id),this._updateScreen()},showExtensionInfo:function(t){var e=this,i=t.$el,n=t.extension,a=t.title,l=o.findWhere(e.list_extensions,{id:n});this.extension_popup&&this.extension_popup.remove(),this.extension_popup=new s.View({placement:t.placement||"bottom",container:i}),this.extension_popup.title(a),this.extension_popup.empty(),this.extension_popup.append(this._templateDescription(l)),this.extension_popup.show()},_eventFtp:function(){if(this.ftp.visible)this.ftp.hide();else{this.ftp.empty();var t=this;this.ftp.append(new n({collection:this.collection,ftp_upload_site:this.ftp_upload_site,onadd:function(e){t.uploadbox.add([{mode:"ftp",name:e.path,size:e.size,path:e.path}])},onremove:function(e){t.collection.remove(e)}}).$el),this.ftp.show()}},_eventCreate:function(){this.uploadbox.add([{name:"New File",size:0,mode:"new"}])},_eventStart:function(){if(!(0==this.counter.announce||this.counter.running>0)){var t=this;this.upload_size=0,this.upload_completed=0,this.collection.each(function(e){"init"==e.get("status")&&(e.set("status","queued"),t.upload_size+=e.get("file_size"))}),this.ui_button.model.set({percentage:0,status:"success"}),this.counter.running=this.counter.announce,this.history_id=this.app.currentHistory(),this.uploadbox.start(),this._updateScreen()}},_eventStop:function(){this.counter.running>0&&(this.ui_button.model.set("status","info"),l("#upload-info").html("Queue will pause after completing the current file..."),this.uploadbox.stop())},_eventReset:function(){0==this.counter.running&&(this.collection.reset(),this.counter.reset(),this.uploadbox.reset(),this.select_extension.value(this.options.default_extension),this.select_genome.value(this.options.default_genome),this.ui_button.model.set("percentage",0),this._updateScreen())},updateExtension:function(t,e){var i=this;this.collection.each(function(n){"init"!=n.get("status")||n.get("extension")!=i.options.default_extension&&e||n.set("extension",t)})},updateGenome:function(t,e){var i=this;this.collection.each(function(n){"init"!=n.get("status")||n.get("genome")!=i.options.default_genome&&e||n.set("genome",t)})},_updateScreen:function(){0==this.counter.announce?this.uploadbox.compatible()?message="&nbsp;":message="Browser does not support Drag & Drop. Try Firefox 4+, Chrome 7+, IE 10+, Opera 12+ or Safari 6+.":0==this.counter.running?message="You added "+this.counter.announce+" file(s) to the queue. Add more files or click 'Start' to proceed.":message="Please wait..."+this.counter.announce+" out of "+this.counter.running+" remaining.",this.$("#upload-info").html(message),0==this.counter.running&&this.counter.announce+this.counter.success+this.counter.error>0?this.btnReset.enable():this.btnReset.disable(),0==this.counter.running&&this.counter.announce>0?(this.btnStart.enable(),this.btnStart.$el.addClass("btn-primary")):(this.btnStart.disable(),this.btnStart.$el.removeClass("btn-primary")),this.counter.running>0?this.btnStop.enable():this.btnStop.disable(),0==this.counter.running?(this.btnLocal.enable(),this.btnFtp.enable(),this.btnCreate.enable()):(this.btnLocal.disable(),this.btnFtp.disable(),this.btnCreate.disable()),this.ftp_upload_site?this.btnFtp.$el.show():this.btnFtp.$el.hide(),this.counter.announce+this.counter.success+this.counter.error>0?(this.$("#upload-table").show(),this.$(".upload-helper").hide()):(this.$("#upload-table").hide(),this.$(".upload-helper").show())},_uploadPercentage:function(t,e){return(this.upload_completed+t*e)/this.upload_size},_templateDescription:function(t){if(t.description){var e=t.description;return t.description_url&&(e+='&nbsp;(<a href="'+t.description_url+'" target="_blank">read more</a>)'),e}return"There is no description available for this file extension."},_template:function(){return'<div class="upload-view-default"><div class="upload-top"><h6 id="upload-info" class="upload-info"/></div><div id="upload-box" class="upload-box"><div class="upload-helper"><i class="fa fa-files-o"/>Drop files here</div><table id="upload-table" class="ui-table-striped" style="display: none;"><thead><tr><th>Name</th><th>Size</th><th>Type</th><th>Genome</th><th>Settings</th><th>Status</th><th/></tr></thead><tbody/></table></div><div id="upload-footer" class="upload-footer"><span class="footer-title">Type (set all):</span><span id="footer-extension"/><span id="footer-extension-info" class="upload-icon-button fa fa-search"/> <span class="footer-title">Genome (set all):</span><span id="footer-genome"/></div><div id="upload-buttons" class="upload-buttons"/></div>'}})}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(2),i(1))},function(t,e,i){var n,s;(function(i,a){n=[],s=function(){var t=i.View.extend({initialize:function(t){var e=this;this.model=t&&t.model||new i.Model({icon:"fa-upload",tooltip:"Download from URL or upload files from disk",label:"Load Data",percentage:0,status:"",onunload:function(){},onclick:function(){}}).set(t),this.setElement(this._template()),this.$progress=this.$(".progress-bar"),this.listenTo(this.model,"change",this.render,this),this.render(),a(window).on("beforeunload",function(){return e.model.get("onunload")()})},render:function(){var t=this.model.attributes;this.$el.off("click").on("click",function(e){t.onclick(e)}).tooltip({title:this.model.get("tooltip"),placement:"bottom"}),this.$progress.removeClass().addClass("progress-bar").addClass("progress-bar-notransition").addClass(""!=t.status&&"progress-bar-"+t.status).css({width:t.percentage+"%"})},_template:function(){return'<div class="upload-button"><div class="progress"><div class="progress-bar"/><a class="panel-header-button" href="javascript:void(0)" id="tool-panel-upload-button"><span class="fa fa-upload"/></a></div></div>'}});return{View:t}}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3),i(1))},function(t,e,i){var n,s;(function(a){n=[i(4),i(8),i(109),i(114),i(113),i(111)],s=function(t,e,i,n,s,o){return a.View.extend({options:{nginx_upload_path:"",ftp_upload_site:"n/a",default_genome:"?",default_extension:"auto",height:500,width:900,auto:{id:"auto",text:"Auto-detect",description:"This system will try to detect the file type automatically. If your file is not detected properly as one of the known formats, it most likely means that it has some format problems (e.g., different number of columns on different rows). You can still coerce the system to set your data to the format you think it should be.  You can also upload compressed files, which will automatically be decompressed."}},modal:null,ui_button:null,current_history:null,list_extensions:[],list_genomes:[],initialize:function(e){var i=this;this.options=t.merge(e,this.options),this.ui_button=new n.View({onclick:function(t){t.preventDefault(),i.show()},onunload:function(){var t=i.ui_button.model.get("percentage",0);if(t>0&&t<100)return"Several uploads are queued."}}),this.setElement(this.ui_button.$el);var i=this;t.get({url:Galaxy.root+"api/datatypes?extension_only=False",success:function(t){for(key in t)i.list_extensions.push({id:t[key].extension,text:t[key].extension,description:t[key].description,description_url:t[key].description_url,composite_files:t[key].composite_files});i.list_extensions.sort(function(t,e){var i=t.text&&t.text.toLowerCase(),n=e.text&&e.text.toLowerCase();return i>n?1:i<n?-1:0}),i.options.datatypes_disable_auto||i.list_extensions.unshift(i.options.auto)}}),t.get({url:Galaxy.root+"api/genomes",success:function(t){for(key in t)i.list_genomes.push({id:t[key][1],text:t[key][0]});i.list_genomes.sort(function(t,e){return t.id==i.options.default_genome?-1:e.id==i.options.default_genome?1:t.text>e.text?1:t.text<e.text?-1:0})}})},show:function(){var t=this;return Galaxy.currHistoryPanel&&Galaxy.currHistoryPanel.model?(this.current_user=Galaxy.user.id,this.modal||(this.tabs=new i.View,this.default_view=new s(this),this.tabs.add({id:"regular",title:"Regular",$el:this.default_view.$el}),this.composite_view=new o(this),this.tabs.add({id:"composite",title:"Composite",$el:this.composite_view.$el}),this.modal=new e.View({title:"Download from web or upload from disk",body:this.tabs.$el,height:this.options.height,width:this.options.width,closing_events:!0,title_separator:!1})),void this.modal.show()):void window.setTimeout(function(){t.show()},500)},currentHistory:function(){return this.current_user&&Galaxy.currHistoryPanel.model.get("id")},currentFtp:function(){return this.current_user&&this.options.ftp_upload_site},toData:function(t,e){var i={payload:{tool_id:"upload1",history_id:e||this.currentHistory(),inputs:{}},files:[],error_message:null};if(t&&t.length>0){var n={};n.dbkey=t[0].get("genome",null),n.file_type=t[0].get("extension",null);for(var s in t){var a=t[s];if(a.set("status","running"),!(a.get("file_size")>0)){i.error_message="Upload content incomplete.",a.set("status","error"),a.set("info",i.error_message);break}var o="files_"+s+"|";switch(n[o+"type"]="upload_dataset",n[o+"space_to_tab"]=a.get("space_to_tab")&&"Yes"||null,n[o+"to_posix_lines"]=a.get("to_posix_lines")&&"Yes"||null,a.get("file_mode")){case"new":n[o+"url_paste"]=a.get("url_paste");break;case"ftp":n[o+"ftp_files"]=a.get("file_path");break;case"local":i.files.push({name:o+"file_data",file:a.get("file_data")})}}i.payload.inputs=JSON.stringify(n)}return i}})}.apply(e,n),!(void 0!==s&&(t.exports=s))}).call(e,i(3))},,,,function(t,e,i){var n,s,a;(function(i,o){!function(i,o){s=[],n=o,a="function"==typeof n?n.apply(e,s):n,!(void 0!==a&&(t.exports=a))}(this,function(){function t(t,e){function n(){var i=['<div class="loading-indicator">','<div class="loading-indicator-text">','<span class="fa fa-spinner fa-spin fa-lg"></span>','<span class="loading-indicator-message">loading...</span>',"</div>","</div>"].join("\n"),n=o(i).hide().css(e.css||{position:"fixed"}),s=n.children(".loading-indicator-text");return e.cover?(n.css({"z-index":2,top:t.css("top"),bottom:t.css("bottom"),left:t.css("left"),right:t.css("right"),opacity:.5,"background-color":"white","text-align":"center"}),s=n.children(".loading-indicator-text").css({"margin-top":"20px"})):(s=n.children(".loading-indicator-text").css({margin:"12px 0px 0px 10px",opacity:"0.85",color:"grey"}),s.children(".loading-indicator-message").css({margin:"0px 8px 0px 0px","font-style":"italic"})),n}var s=this;return e=i.extend({cover:!1},e||{}),s.show=function(e,i,a){return e=e||"loading...",i=i||"fast",t.parent().find(".loading-indicator").remove(),s.$indicator=n().insertBefore(t),s.message(e),s.$indicator.fadeIn(i,a),s},s.message=function(t){s.$indicator.find("i").text(t)},s.hide=function(t,e){return t=t||"fast",s.$indicator&&s.$indicator.length?s.$indicator.fadeOut(t,function(){s.$indicator.remove(),e&&e()}):e&&e(),s},s}return t})}).call(e,i(1),i(1))},,,function(t,e,i){var n,s;n=[],s=function(){function t(t,e){if(0===t.length)return e.length;if(0===e.length)return t.length;var i,n=[];for(i=0;i<=e.length;i++)n[i]=[i];var s;for(s=0;s<=t.length;s++)n[0][s]=s;for(i=1;i<=e.length;i++)for(s=1;s<=t.length;s++)e.charAt(i-1)===t.charAt(s-1)?n[i][s]=n[i-1][s-1]:n[i][s]=Math.min(n[i-1][s-1]+1,Math.min(n[i][s-1]+1,n[i-1][s]+1));return n[e.length][t.length]}return t}.apply(e,n),!(void 0!==s&&(t.exports=s))}]);
//# sourceMappingURL=analysis.bundled.js.map