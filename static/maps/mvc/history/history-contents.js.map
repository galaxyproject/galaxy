{"version":3,"file":"history-contents.js","sources":["../../../src/mvc/history/history-contents.js"],"names":["define","CONTROLLED_FETCH_COLLECTION","HDA_MODEL","HDCA_MODEL","HISTORY_PREFS","BASE_MVC","AJAX_QUEUE","_super","PaginatedCollection","HistoryContents","extend","LoggableMixin","_logNamespace","model","attrs","options","history_content_type","HistoryDatasetAssociation","collection_type","HistoryListDatasetCollection","HistoryPairDatasetCollection","HistoryListPairedDatasetCollection","HistoryListOfListsDatasetCollection","msg","console","warn","validationError","limitPerPage","limitPerProgressiveFetch","order","urlRoot","Galaxy","root","url","this","historyId","initialize","models","prototype","call","history","setHistoryId","includeDeleted","includeHidden","idAttribute","newId","_setUpWebStorage","storage","HistoryPrefs","id","historyStorageKey","trigger","on","include-deleted","newVal","include-hidden","comparators","_","clone","name","buildComparator","ascending","name-dsc","hid","hid-asc","running","filter","c","inReadyState","runningAndActive","get","getByHid","findWhere","haveDetails","all","hasDetails","hidden","deleted","visibleAndUndeleted","setIncludeDeleted","setting","isBoolean","result","setIncludeHidden","fetch","details","prefs","toJSON","isEmpty","expandedIds","values","join","_buildFetchData","v","_fetchParams","concat","_buildFetchFilters","superFilters","filters","purged","visible","defaults","getTotalItemCount","contentsShown","fetchUpdated","since","remove","update_time-ge","toISOString","fetchDeleted","self","undefined","always","fetchHidden","fetchAllDetails","detailsFlag","data","fetchCollectionCounts","keys","_filterAndUpdate","filterParams","updateWhat","updateArgs","then","fetched","reduce","modelArray","currJson","ajaxQueue","ajaxFn","args","collection","AjaxQueue","slice","reverse","map","content","fn","isString","apply","deferred","progressivelyFetchDetails","_recursivelyFetch","offset","_options","view","detailKeys","limit","reset","defer","fail","reject","done","response","notify","length","allFetched","resolve","jQuery","Deferred","limitPerCall","searchAttributes","isCopyable","contentsJSON","copyableModelClasses","isObject","contains","model_class","copy","json","type","contentType","LibraryDatasetDatasetAssociation","HistoryDatasetCollectionAssociation","xhr","ajax","method","JSON","stringify","source","add","parse","createHDCA","elementIdentifiers","collectionType","hdca","history_id","element_identifiers","save","haveSearchDetails","has","attributes","matches","matchesWhat","Backbone","Collection","toString"],"mappings":"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"}